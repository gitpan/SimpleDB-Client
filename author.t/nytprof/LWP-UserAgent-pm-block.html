    <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
    <html xmlns="http://www.w3.org/1999/xhtml">
<!--
This file was generated by Devel::NYTProf version 3.11
-->
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta http-equiv="Content-Language" content="en-us" />
    <title>Profile of /usr/local/lib/perl5/site_perl/5.10.1/LWP/UserAgent.pm</title>
<link rel="stylesheet" type="text/css" href="style.css" />
    <script type="text/javascript" src="js/jquery-min.js"></script> 

    <script type="text/javascript" src="js/jquery-tablesorter-min.js"></script> 
    <link rel="stylesheet" type="text/css" href="js/style-tablesorter.css" />
    <script type="text/javascript">
    // when a column is first clicked on to sort it, use descending order
    // XXX doesn't seem to work (and not just because the tablesorter formatSortingOrder() is broken)
    $.tablesorter.defaults.sortInitialOrder = "desc";
    // add parser through the tablesorter addParser method 
    $.tablesorter.addParser({
        id: 'fmt_time',   // name of this parser
        is: function(s) { 
            return false; // return false so this parser is not auto detected 
        }, 
        format: function(orig) { // format data for normalization 
            // console.log(orig);
            val = orig.replace(/ns/,'');
            if (val != orig) { return val / (1000*1000*1000); } 
            val = orig.replace(/Âµs/,''); /* XXX use &micro; ? */
            if (val != orig) { return val / (1000*1000); } 
            var val = orig.replace(/ms/,'');
            if (val != orig) { return val / (1000); }
            var val = orig.replace(/s/,'');
            if (val != orig) { return val; }
            if (orig == '0') { return orig; } 
            console.log('no match for fmt_time of '.concat(orig));
            return orig;
        },
        type: 'numeric' // set type, either numeric or text 
    }); 
    </script> 
</head>
<body > 
<div class="header" style="position: relative; overflow-x: hidden; overflow-y: hidden; z-index: 0; ">
<div class="header_back">
            <a href="index.html">&larr; Index</a>
        </div>
<div class="headerForeground" style="float: left">
    <span class="siteTitle">NYTProf Performance Profile</span>
    <span class="siteSubtitle">&emsp;&emsp;<span>&laquo;&emsp;<span class="mode_btn mode_btn_selected">block view</span>&emsp;&bull;&emsp;<span class="mode_btn"><a href="LWP-UserAgent-pm-line.html">line view</a></span>&emsp;&bull;&emsp;<span class="mode_btn"><a href="LWP-UserAgent-pm-sub.html">sub view</a></span>&emsp;&raquo;</span><br />
            For 01.HTTP.t
        </span>
</div>
<div class="headerForeground" style="float: right; text-align: right">
    <span class="siteTitle">&nbsp;</span>
    <span class="siteSubtitle">Run on Tue May  4 15:25:55 2010<br />Reported on Tue May  4 15:26:13 2010</span>
</div>
<div style="position: absolute; left: 0px; top: 0%; width: 100%; height: 101%; z-index: -1; background-color: rgb(17, 136, 255); "></div>
<div style="position: absolute; left: 0px; top: 2%; width: 100%; height: 99%; z-index: -1; background-color: rgb(16, 134, 253); "></div>
<div style="position: absolute; left: 0px; top: 4%; width: 100%; height: 97%; z-index: -1; background-color: rgb(16, 133, 252); "></div>
<div style="position: absolute; left: 0px; top: 6%; width: 100%; height: 95%; z-index: -1; background-color: rgb(15, 131, 250); "></div>
<div style="position: absolute; left: 0px; top: 8%; width: 100%; height: 93%; z-index: -1; background-color: rgb(15, 130, 249); "></div>
<div style="position: absolute; left: 0px; top: 10%; width: 100%; height: 91%; z-index: -1; background-color: rgb(15, 129, 248); "></div>
<div style="position: absolute; left: 0px; top: 12%; width: 100%; height: 89%; z-index: -1; background-color: rgb(14, 127, 246); "></div>
<div style="position: absolute; left: 0px; top: 14%; width: 100%; height: 87%; z-index: -1; background-color: rgb(14, 126, 245); "></div>
<div style="position: absolute; left: 0px; top: 16%; width: 100%; height: 85%; z-index: -1; background-color: rgb(14, 125, 244); "></div>
<div style="position: absolute; left: 0px; top: 18%; width: 100%; height: 83%; z-index: -1; background-color: rgb(13, 123, 242); "></div>
<div style="position: absolute; left: 0px; top: 20%; width: 100%; height: 81%; z-index: -1; background-color: rgb(13, 122, 241); "></div>
<div style="position: absolute; left: 0px; top: 22%; width: 100%; height: 79%; z-index: -1; background-color: rgb(13, 121, 240); "></div>
<div style="position: absolute; left: 0px; top: 24%; width: 100%; height: 77%; z-index: -1; background-color: rgb(12, 119, 238); "></div>
<div style="position: absolute; left: 0px; top: 26%; width: 100%; height: 75%; z-index: -1; background-color: rgb(12, 118, 237); "></div>
<div style="position: absolute; left: 0px; top: 28%; width: 100%; height: 73%; z-index: -1; background-color: rgb(12, 116, 235); "></div>
<div style="position: absolute; left: 0px; top: 30%; width: 100%; height: 71%; z-index: -1; background-color: rgb(11, 115, 234); "></div>
<div style="position: absolute; left: 0px; top: 32%; width: 100%; height: 69%; z-index: -1; background-color: rgb(11, 114, 233); "></div>
<div style="position: absolute; left: 0px; top: 34%; width: 100%; height: 67%; z-index: -1; background-color: rgb(11, 112, 231); "></div>
<div style="position: absolute; left: 0px; top: 36%; width: 100%; height: 65%; z-index: -1; background-color: rgb(10, 111, 230); "></div>
<div style="position: absolute; left: 0px; top: 38%; width: 100%; height: 63%; z-index: -1; background-color: rgb(10, 110, 229); "></div>
<div style="position: absolute; left: 0px; top: 40%; width: 100%; height: 61%; z-index: -1; background-color: rgb(10, 108, 227); "></div>
<div style="position: absolute; left: 0px; top: 42%; width: 100%; height: 59%; z-index: -1; background-color: rgb(9, 107, 226); "></div>
<div style="position: absolute; left: 0px; top: 44%; width: 100%; height: 57%; z-index: -1; background-color: rgb(9, 106, 225); "></div>
<div style="position: absolute; left: 0px; top: 46%; width: 100%; height: 55%; z-index: -1; background-color: rgb(9, 104, 223); "></div>
<div style="position: absolute; left: 0px; top: 48%; width: 100%; height: 53%; z-index: -1; background-color: rgb(8, 103, 222); "></div>
<div style="position: absolute; left: 0px; top: 50%; width: 100%; height: 51%; z-index: -1; background-color: rgb(8, 102, 221); "></div>
<div style="position: absolute; left: 0px; top: 52%; width: 100%; height: 49%; z-index: -1; background-color: rgb(8, 100, 219); "></div>
<div style="position: absolute; left: 0px; top: 54%; width: 100%; height: 47%; z-index: -1; background-color: rgb(7, 99, 218); "></div>
<div style="position: absolute; left: 0px; top: 56%; width: 100%; height: 45%; z-index: -1; background-color: rgb(7, 97, 216); "></div>
<div style="position: absolute; left: 0px; top: 58%; width: 100%; height: 43%; z-index: -1; background-color: rgb(7, 96, 215); "></div>
<div style="position: absolute; left: 0px; top: 60%; width: 100%; height: 41%; z-index: -1; background-color: rgb(6, 95, 214); "></div>
<div style="position: absolute; left: 0px; top: 62%; width: 100%; height: 39%; z-index: -1; background-color: rgb(6, 93, 212); "></div>
<div style="position: absolute; left: 0px; top: 64%; width: 100%; height: 37%; z-index: -1; background-color: rgb(6, 92, 211); "></div>
<div style="position: absolute; left: 0px; top: 66%; width: 100%; height: 35%; z-index: -1; background-color: rgb(5, 91, 210); "></div>
<div style="position: absolute; left: 0px; top: 68%; width: 100%; height: 33%; z-index: -1; background-color: rgb(5, 89, 208); "></div>
<div style="position: absolute; left: 0px; top: 70%; width: 100%; height: 31%; z-index: -1; background-color: rgb(5, 88, 207); "></div>
<div style="position: absolute; left: 0px; top: 72%; width: 100%; height: 29%; z-index: -1; background-color: rgb(4, 87, 206); "></div>
<div style="position: absolute; left: 0px; top: 74%; width: 100%; height: 27%; z-index: -1; background-color: rgb(4, 85, 204); "></div>
<div style="position: absolute; left: 0px; top: 76%; width: 100%; height: 25%; z-index: -1; background-color: rgb(4, 84, 203); "></div>
<div style="position: absolute; left: 0px; top: 78%; width: 100%; height: 23%; z-index: -1; background-color: rgb(3, 82, 201); "></div>
<div style="position: absolute; left: 0px; top: 80%; width: 100%; height: 21%; z-index: -1; background-color: rgb(3, 81, 200); "></div>
<div style="position: absolute; left: 0px; top: 82%; width: 100%; height: 19%; z-index: -1; background-color: rgb(3, 80, 199); "></div>
<div style="position: absolute; left: 0px; top: 84%; width: 100%; height: 17%; z-index: -1; background-color: rgb(2, 78, 197); "></div>
<div style="position: absolute; left: 0px; top: 86%; width: 100%; height: 15%; z-index: -1; background-color: rgb(2, 77, 196); "></div>
<div style="position: absolute; left: 0px; top: 88%; width: 100%; height: 13%; z-index: -1; background-color: rgb(2, 76, 195); "></div>
<div style="position: absolute; left: 0px; top: 90%; width: 100%; height: 11%; z-index: -1; background-color: rgb(1, 74, 193); "></div>
<div style="position: absolute; left: 0px; top: 92%; width: 100%; height: 9%; z-index: -1; background-color: rgb(1, 73, 192); "></div>
<div style="position: absolute; left: 0px; top: 94%; width: 100%; height: 7%; z-index: -1; background-color: rgb(1, 72, 191); "></div>
<div style="position: absolute; left: 0px; top: 96%; width: 100%; height: 5%; z-index: -1; background-color: rgb(0, 70, 189); "></div>
<div style="position: absolute; left: 0px; top: 98%; width: 100%; height: 3%; z-index: -1; background-color: rgb(0, 69, 188); "></div>
<div style="position: absolute; left: 0px; top: 100%; width: 100%; height: 1%; z-index: -1; background-color: rgb(0, 68, 187); "></div>
</div>

<div class="body_content">
<br />
<table>
<tr>
<td class="h" align="right">File</td>
<td align="left">/usr/local/lib/perl5/site_perl/5.10.1/LWP/UserAgent.pm</td>
</tr>
<tr>
<td class="h" align="right">Statements Executed</td>
<td align="left">462</td>
</tr>
<tr>
<td class="h" align="right">Statement Execution Time</td>
<td align="left">12.0ms</td>
</tr>
</table>

        
        <table id="subs_table" border="1" cellpadding="0" class="tablesorter">
        <caption>Subroutines &mdash; ordered by exclusive time</caption>
        <thead>
        <tr>
        <th>Calls</th>
        <th><span title="Number of Places sub is called from">P</span></th>
        <th><span title="Number of Files sub is called from">F</span></th>
        <th>Exclusive<br />Time</th>
        <th>Inclusive<br />Time</th>
        <th>Subroutine</th>
        </tr>
        </thead>
    <tbody>
<tr><td class="c3">1</td><td class="c3">1</td><td class="c3">1</td><td class="c0"><span title="3.2%">35.2ms</span></td><td class="c0"><span title="4.6%">49.9ms</span></td><td class="sub_name"><span style="display: none;">LWP::UserAgent::::BEGIN@10</span>LWP::UserAgent::<a href="LWP-UserAgent-pm-block.html#10">BEGIN@10</a></span></td></tr>
<tr><td class="c3">1</td><td class="c3">1</td><td class="c3">1</td><td class="c0"><span title="2.0%">22.2ms</span></td><td class="c0"><span title="2.1%">22.6ms</span></td><td class="sub_name"><span style="display: none;">LWP::UserAgent::::BEGIN@12</span>LWP::UserAgent::<a href="LWP-UserAgent-pm-block.html#12">BEGIN@12</a></span></td></tr>
<tr><td class="c3">1</td><td class="c3">1</td><td class="c3">1</td><td class="c0"><span title="0.6%">7.10ms</span></td><td class="c0"><span title="0.7%">7.32ms</span></td><td class="sub_name"><span style="display: none;">LWP::UserAgent::::conn_cache</span>LWP::UserAgent::<a href="LWP-UserAgent-pm-block.html#680">conn_cache</a></span></td></tr>
<tr><td class="c3">1</td><td class="c3">1</td><td class="c3">1</td><td class="c0"><span title="0.2%">2.13ms</span></td><td class="c0"><span title="0.2%">2.22ms</span></td><td class="sub_name"><span style="display: none;">LWP::UserAgent::::BEGIN@15</span>LWP::UserAgent::<a href="LWP-UserAgent-pm-block.html#15">BEGIN@15</a></span></td></tr>
<tr><td class="c3">1</td><td class="c3">1</td><td class="c3">1</td><td class="c0"><span title="0.1%">1.38ms</span></td><td class="c1"><span title="0.1%">1.46ms</span></td><td class="sub_name"><span style="display: none;">LWP::UserAgent::::add_handler</span>LWP::UserAgent::<a href="LWP-UserAgent-pm-block.html#695">add_handler</a></span></td></tr>
<tr><td class="c3">1</td><td class="c3">1</td><td class="c3">1</td><td class="c0"><span title="0.1%">1.26ms</span></td><td class="c0"><span title="0.3%">3.80ms</span></td><td class="sub_name"><span style="display: none;">LWP::UserAgent::::BEGIN@11</span>LWP::UserAgent::<a href="LWP-UserAgent-pm-block.html#11">BEGIN@11</a></span></td></tr>
<tr><td class="c0">3</td><td class="c3">1</td><td class="c3">1</td><td class="c0"><span title="0.0%">279&micro;s</span></td><td class="c0"><span title="33.2%">363ms</span></td><td class="sub_name"><span style="display: none;">LWP::UserAgent::::send_request</span>LWP::UserAgent::<a href="LWP-UserAgent-pm-block.html#117">send_request</a></span></td></tr>
<tr><td class="c3">1</td><td class="c3">1</td><td class="c3">1</td><td class="c0"><span title="0.0%">209&micro;s</span></td><td class="c3"><span title="0.0%">209&micro;s</span></td><td class="sub_name"><span style="display: none;">LWP::UserAgent::::BEGIN@14</span>LWP::UserAgent::<a href="LWP-UserAgent-pm-block.html#14">BEGIN@14</a></span></td></tr>
<tr><td class="c0">3</td><td class="c3">1</td><td class="c3">1</td><td class="c0"><span title="0.0%">169&micro;s</span></td><td class="c3"><span title="0.1%">584&micro;s</span></td><td class="sub_name"><span style="display: none;">LWP::UserAgent::::prepare_request</span>LWP::UserAgent::<a href="LWP-UserAgent-pm-block.html#206">prepare_request</a></span></td></tr>
<tr><td class="c0">3</td><td class="c3">1</td><td class="c3">1</td><td class="c0"><span title="0.0%">169&micro;s</span></td><td class="c0"><span title="33.3%">364ms</span></td><td class="sub_name"><span style="display: none;">LWP::UserAgent::::request</span>LWP::UserAgent::<a href="LWP-UserAgent-pm-block.html#258">request</a></span></td></tr>
<tr><td class="c0">18</td><td class="c0">6</td><td class="c1">2</td><td class="c0"><span title="0.0%">141&micro;s</span></td><td class="c1"><span title="0.2%">1.67ms</span></td><td class="sub_name"><span style="display: none;">LWP::UserAgent::::run_handlers</span>LWP::UserAgent::<a href="LWP-UserAgent-pm-block.html#768">run_handlers</a></span></td></tr>
<tr><td class="c0">22</td><td class="c0">3</td><td class="c1">2</td><td class="c0"><span title="0.0%">126&micro;s</span></td><td class="c1"><span title="0.1%">1.55ms</span></td><td class="sub_name"><span style="display: none;">LWP::UserAgent::::handlers</span>LWP::UserAgent::<a href="LWP-UserAgent-pm-block.html#756">handlers</a></span></td></tr>
<tr><td class="c0">3</td><td class="c3">1</td><td class="c3">1</td><td class="c1"><span title="0.0%">81&micro;s</span></td><td class="c0"><span title="33.3%">364ms</span></td><td class="sub_name"><span style="display: none;">LWP::UserAgent::::simple_request</span>LWP::UserAgent::<a href="LWP-UserAgent-pm-block.html#228">simple_request</a></span></td></tr>
<tr><td class="c3">1</td><td class="c3">1</td><td class="c3">1</td><td class="c2"><span title="0.0%">61&micro;s</span></td><td class="c0"><span title="0.8%">8.98ms</span></td><td class="sub_name"><span style="display: none;">LWP::UserAgent::::new</span>LWP::UserAgent::<a href="LWP-UserAgent-pm-block.html#31">new</a></span></td></tr>
<tr><td class="c0">10</td><td class="c0">3</td><td class="c1">2</td><td class="c3"><span title="0.0%">35&micro;s</span></td><td class="c3"><span title="0.0%">35&micro;s</span></td><td class="sub_name"><span style="display: none;">LWP::UserAgent::::progress</span>LWP::UserAgent::<a href="LWP-UserAgent-pm-block.html#460">progress</a></span></td></tr>
<tr><td class="c0">3</td><td class="c3">1</td><td class="c3">1</td><td class="c3"><span title="0.0%">26&micro;s</span></td><td class="c3"><span title="0.0%">41&micro;s</span></td><td class="sub_name"><span style="display: none;">LWP::UserAgent::::protocols_allowed</span>LWP::UserAgent::<a href="LWP-UserAgent-pm-block.html#524">protocols_allowed</a></span></td></tr>
<tr><td class="c3">1</td><td class="c3">1</td><td class="c3">1</td><td class="c3"><span title="0.0%">24&micro;s</span></td><td class="c1"><span title="0.1%">1.49ms</span></td><td class="sub_name"><span style="display: none;">LWP::UserAgent::::set_my_handler</span>LWP::UserAgent::<a href="LWP-UserAgent-pm-block.html#705">set_my_handler</a></span></td></tr>
<tr><td class="c3">1</td><td class="c3">1</td><td class="c3">1</td><td class="c3"><span title="0.0%">20&micro;s</span></td><td class="c3"><span title="0.0%">26&micro;s</span></td><td class="sub_name"><span style="display: none;">LWP::UserAgent::::BEGIN@3</span>LWP::UserAgent::<a href="LWP-UserAgent-pm-block.html#3">BEGIN@3</a></span></td></tr>
<tr><td class="c3">1</td><td class="c3">1</td><td class="c3">1</td><td class="c3"><span title="0.0%">19&micro;s</span></td><td class="c3"><span title="0.0%">92&micro;s</span></td><td class="sub_name"><span style="display: none;">LWP::UserAgent::::agent</span>LWP::UserAgent::<a href="LWP-UserAgent-pm-block.html#659">agent</a></span></td></tr>
<tr><td class="c0">3</td><td class="c3">1</td><td class="c3">1</td><td class="c3"><span title="0.0%">15&micro;s</span></td><td class="c3"><span title="0.0%">22&micro;s</span></td><td class="sub_name"><span style="display: none;">LWP::UserAgent::::protocols_forbidden</span>LWP::UserAgent::<a href="LWP-UserAgent-pm-block.html#525">protocols_forbidden</a></span></td></tr>
<tr><td class="c3">1</td><td class="c3">1</td><td class="c3">1</td><td class="c3"><span title="0.0%">13&micro;s</span></td><td class="c1"><span title="0.1%">1.50ms</span></td><td class="sub_name"><span style="display: none;">LWP::UserAgent::::parse_head</span>LWP::UserAgent::<a href="LWP-UserAgent-pm-block.html#585">parse_head</a></span></td></tr>
<tr><td class="c3">1</td><td class="c3">1</td><td class="c3">1</td><td class="c3"><span title="0.0%">12&micro;s</span></td><td class="c3"><span title="0.0%">22&micro;s</span></td><td class="sub_name"><span style="display: none;">LWP::UserAgent::::default_headers</span>LWP::UserAgent::<a href="LWP-UserAgent-pm-block.html#641">default_headers</a></span></td></tr>
<tr><td class="c3">1</td><td class="c3">1</td><td class="c3">1</td><td class="c3"><span title="0.0%">9&micro;s</span></td><td class="c3"><span title="0.0%">57&micro;s</span></td><td class="sub_name"><span style="display: none;">LWP::UserAgent::::BEGIN@4</span>LWP::UserAgent::<a href="LWP-UserAgent-pm-block.html#4">BEGIN@4</a></span></td></tr>
<tr><td class="c3">1</td><td class="c3">1</td><td class="c3">1</td><td class="c3"><span title="0.0%">9&micro;s</span></td><td class="c3"><span title="0.0%">72&micro;s</span></td><td class="sub_name"><span style="display: none;">LWP::UserAgent::::default_header</span>LWP::UserAgent::<a href="LWP-UserAgent-pm-block.html#652">default_header</a></span></td></tr>
<tr><td class="c3">1</td><td class="c3">1</td><td class="c3">1</td><td class="c3"><span title="0.0%">8&micro;s</span></td><td class="c3"><span title="0.0%">19&micro;s</span></td><td class="sub_name"><span style="display: none;">LWP::UserAgent::::BEGIN@353</span>LWP::UserAgent::<a href="LWP-UserAgent-pm-block.html#353">BEGIN@353</a></span></td></tr>
<tr><td class="c3">1</td><td class="c3">1</td><td class="c3">1</td><td class="c3"><span title="0.0%">7&micro;s</span></td><td class="c3"><span title="0.0%">7&micro;s</span></td><td class="sub_name"><span style="display: none;">LWP::UserAgent::::remove_handler</span>LWP::UserAgent::<a href="LWP-UserAgent-pm-block.html#743">remove_handler</a></span></td></tr>
<tr><td class="c3">1</td><td class="c3">1</td><td class="c3">1</td><td class="c3"><span title="0.0%">5&micro;s</span></td><td class="c3"><span title="0.0%">5&micro;s</span></td><td class="sub_name"><span style="display: none;">LWP::UserAgent::::BEGIN@17</span>LWP::UserAgent::<a href="LWP-UserAgent-pm-block.html#17">BEGIN@17</a></span></td></tr>
<tr><td class="c3">1</td><td class="c3">1</td><td class="c3">1</td><td class="c3"><span title="0.0%">3&micro;s</span></td><td class="c3"><span title="0.0%">3&micro;s</span></td><td class="sub_name"><span style="display: none;">LWP::UserAgent::::_agent</span>LWP::UserAgent::<a href="LWP-UserAgent-pm-block.html#657">_agent</a></span></td></tr>
<tr><td class="c3">1</td><td class="c3">1</td><td class="c1">2</td><td class="c3"><span title="0.0%">900ns</span></td><td class="c3"><span title="0.0%">900ns</span></td><td class="sub_name"><span style="display: none;">LWP::UserAgent::::CORE:match</span>LWP::UserAgent::<a href="LWP-UserAgent-pm-block.html#LWP__UserAgent__CORE_match">CORE:match</a>&nbsp;(opcode)</span></td></tr>
<tr><td class="c3">0</td><td class="c3">0</td><td class="c3">0</td><td class="c3"><span title="0.0%">0s</span></td><td class="c3"><span title="0.0%">0s</span></td><td class="sub_name"><span style="display: none;">LWP::UserAgent::::__ANON__[:608]</span>LWP::UserAgent::<a href="LWP-UserAgent-pm-block.html#598">__ANON__[:608]</a></span></td></tr>
<tr><td class="c3">0</td><td class="c3">0</td><td class="c3">0</td><td class="c3"><span title="0.0%">0s</span></td><td class="c3"><span title="0.0%">0s</span></td><td class="sub_name"><span style="display: none;">LWP::UserAgent::::__ANON__[:611]</span>LWP::UserAgent::<a href="LWP-UserAgent-pm-block.html#590">__ANON__[:611]</a></span></td></tr>
<tr><td class="c3">0</td><td class="c3">0</td><td class="c3">0</td><td class="c3"><span title="0.0%">0s</span></td><td class="c3"><span title="0.0%">0s</span></td><td class="sub_name"><span style="display: none;">LWP::UserAgent::::__ANON__[:632]</span>LWP::UserAgent::<a href="LWP-UserAgent-pm-block.html#632">__ANON__[:632]</a></span></td></tr>
<tr><td class="c3">0</td><td class="c3">0</td><td class="c3">0</td><td class="c3"><span title="0.0%">0s</span></td><td class="c3"><span title="0.0%">0s</span></td><td class="sub_name"><span style="display: none;">LWP::UserAgent::::__ANON__[:635]</span>LWP::UserAgent::<a href="LWP-UserAgent-pm-block.html#635">__ANON__[:635]</a></span></td></tr>
<tr><td class="c3">0</td><td class="c3">0</td><td class="c3">0</td><td class="c3"><span title="0.0%">0s</span></td><td class="c3"><span title="0.0%">0s</span></td><td class="sub_name"><span style="display: none;">LWP::UserAgent::::__ANON__[:735]</span>LWP::UserAgent::<a href="LWP-UserAgent-pm-block.html#735">__ANON__[:735]</a></span></td></tr>
<tr><td class="c3">0</td><td class="c3">0</td><td class="c3">0</td><td class="c3"><span title="0.0%">0s</span></td><td class="c3"><span title="0.0%">0s</span></td><td class="sub_name"><span style="display: none;">LWP::UserAgent::::_need_proxy</span>LWP::UserAgent::<a href="LWP-UserAgent-pm-block.html#888">_need_proxy</a></span></td></tr>
<tr><td class="c3">0</td><td class="c3">0</td><td class="c3">0</td><td class="c3"><span title="0.0%">0s</span></td><td class="c3"><span title="0.0%">0s</span></td><td class="sub_name"><span style="display: none;">LWP::UserAgent::::_new_response</span>LWP::UserAgent::<a href="LWP-UserAgent-pm-block.html#964">_new_response</a></span></td></tr>
<tr><td class="c3">0</td><td class="c3">0</td><td class="c3">0</td><td class="c3"><span title="0.0%">0s</span></td><td class="c3"><span title="0.0%">0s</span></td><td class="sub_name"><span style="display: none;">LWP::UserAgent::::_process_colonic_headers</span>LWP::UserAgent::<a href="LWP-UserAgent-pm-block.html#409">_process_colonic_headers</a></span></td></tr>
<tr><td class="c3">0</td><td class="c3">0</td><td class="c3">0</td><td class="c3"><span title="0.0%">0s</span></td><td class="c3"><span title="0.0%">0s</span></td><td class="sub_name"><span style="display: none;">LWP::UserAgent::::clone</span>LWP::UserAgent::<a href="LWP-UserAgent-pm-block.html#795">clone</a></span></td></tr>
<tr><td class="c3">0</td><td class="c3">0</td><td class="c3">0</td><td class="c3"><span title="0.0%">0s</span></td><td class="c3"><span title="0.0%">0s</span></td><td class="sub_name"><span style="display: none;">LWP::UserAgent::::cookie_jar</span>LWP::UserAgent::<a href="LWP-UserAgent-pm-block.html#621">cookie_jar</a></span></td></tr>
<tr><td class="c3">0</td><td class="c3">0</td><td class="c3">0</td><td class="c3"><span title="0.0%">0s</span></td><td class="c3"><span title="0.0%">0s</span></td><td class="sub_name"><span style="display: none;">LWP::UserAgent::::credentials</span>LWP::UserAgent::<a href="LWP-UserAgent-pm-block.html#557">credentials</a></span></td></tr>
<tr><td class="c3">0</td><td class="c3">0</td><td class="c3">0</td><td class="c3"><span title="0.0%">0s</span></td><td class="c3"><span title="0.0%">0s</span></td><td class="sub_name"><span style="display: none;">LWP::UserAgent::::env_proxy</span>LWP::UserAgent::<a href="LWP-UserAgent-pm-block.html#926">env_proxy</a></span></td></tr>
<tr><td class="c3">0</td><td class="c3">0</td><td class="c3">0</td><td class="c3"><span title="0.0%">0s</span></td><td class="c3"><span title="0.0%">0s</span></td><td class="sub_name"><span style="display: none;">LWP::UserAgent::::from</span>LWP::UserAgent::<a href="LWP-UserAgent-pm-block.html#674">from</a></span></td></tr>
<tr><td class="c3">0</td><td class="c3">0</td><td class="c3">0</td><td class="c3"><span title="0.0%">0s</span></td><td class="c3"><span title="0.0%">0s</span></td><td class="sub_name"><span style="display: none;">LWP::UserAgent::::get</span>LWP::UserAgent::<a href="LWP-UserAgent-pm-block.html#385">get</a></span></td></tr>
<tr><td class="c3">0</td><td class="c3">0</td><td class="c3">0</td><td class="c3"><span title="0.0%">0s</span></td><td class="c3"><span title="0.0%">0s</span></td><td class="sub_name"><span style="display: none;">LWP::UserAgent::::get_basic_credentials</span>LWP::UserAgent::<a href="LWP-UserAgent-pm-block.html#572">get_basic_credentials</a></span></td></tr>
<tr><td class="c3">0</td><td class="c3">0</td><td class="c3">0</td><td class="c3"><span title="0.0%">0s</span></td><td class="c3"><span title="0.0%">0s</span></td><td class="sub_name"><span style="display: none;">LWP::UserAgent::::get_my_handler</span>LWP::UserAgent::<a href="LWP-UserAgent-pm-block.html#713">get_my_handler</a></span></td></tr>
<tr><td class="c3">0</td><td class="c3">0</td><td class="c3">0</td><td class="c3"><span title="0.0%">0s</span></td><td class="c3"><span title="0.0%">0s</span></td><td class="sub_name"><span style="display: none;">LWP::UserAgent::::head</span>LWP::UserAgent::<a href="LWP-UserAgent-pm-block.html#401">head</a></span></td></tr>
<tr><td class="c3">0</td><td class="c3">0</td><td class="c3">0</td><td class="c3"><span title="0.0%">0s</span></td><td class="c3"><span title="0.0%">0s</span></td><td class="sub_name"><span style="display: none;">LWP::UserAgent::::is_protocol_supported</span>LWP::UserAgent::<a href="LWP-UserAgent-pm-block.html#497">is_protocol_supported</a></span></td></tr>
<tr><td class="c3">0</td><td class="c3">0</td><td class="c3">0</td><td class="c3"><span title="0.0%">0s</span></td><td class="c3"><span title="0.0%">0s</span></td><td class="sub_name"><span style="display: none;">LWP::UserAgent::::local_address</span>LWP::UserAgent::<a href="LWP-UserAgent-pm-block.html#580">local_address</a></span></td></tr>
<tr><td class="c3">0</td><td class="c3">0</td><td class="c3">0</td><td class="c3"><span title="0.0%">0s</span></td><td class="c3"><span title="0.0%">0s</span></td><td class="sub_name"><span style="display: none;">LWP::UserAgent::::max_redirect</span>LWP::UserAgent::<a href="LWP-UserAgent-pm-block.html#582">max_redirect</a></span></td></tr>
<tr><td class="c3">0</td><td class="c3">0</td><td class="c3">0</td><td class="c3"><span title="0.0%">0s</span></td><td class="c3"><span title="0.0%">0s</span></td><td class="sub_name"><span style="display: none;">LWP::UserAgent::::max_size</span>LWP::UserAgent::<a href="LWP-UserAgent-pm-block.html#581">max_size</a></span></td></tr>
<tr><td class="c3">0</td><td class="c3">0</td><td class="c3">0</td><td class="c3"><span title="0.0%">0s</span></td><td class="c3"><span title="0.0%">0s</span></td><td class="sub_name"><span style="display: none;">LWP::UserAgent::::mirror</span>LWP::UserAgent::<a href="LWP-UserAgent-pm-block.html#828">mirror</a></span></td></tr>
<tr><td class="c3">0</td><td class="c3">0</td><td class="c3">0</td><td class="c3"><span title="0.0%">0s</span></td><td class="c3"><span title="0.0%">0s</span></td><td class="sub_name"><span style="display: none;">LWP::UserAgent::::no_proxy</span>LWP::UserAgent::<a href="LWP-UserAgent-pm-block.html#953">no_proxy</a></span></td></tr>
<tr><td class="c3">0</td><td class="c3">0</td><td class="c3">0</td><td class="c3"><span title="0.0%">0s</span></td><td class="c3"><span title="0.0%">0s</span></td><td class="sub_name"><span style="display: none;">LWP::UserAgent::::post</span>LWP::UserAgent::<a href="LWP-UserAgent-pm-block.html#393">post</a></span></td></tr>
<tr><td class="c3">0</td><td class="c3">0</td><td class="c3">0</td><td class="c3"><span title="0.0%">0s</span></td><td class="c3"><span title="0.0%">0s</span></td><td class="sub_name"><span style="display: none;">LWP::UserAgent::::proxy</span>LWP::UserAgent::<a href="LWP-UserAgent-pm-block.html#906">proxy</a></span></td></tr>
<tr><td class="c3">0</td><td class="c3">0</td><td class="c3">0</td><td class="c3"><span title="0.0%">0s</span></td><td class="c3"><span title="0.0%">0s</span></td><td class="sub_name"><span style="display: none;">LWP::UserAgent::::redirect_ok</span>LWP::UserAgent::<a href="LWP-UserAgent-pm-block.html#530">redirect_ok</a></span></td></tr>
<tr><td class="c3">0</td><td class="c3">0</td><td class="c3">0</td><td class="c3"><span title="0.0%">0s</span></td><td class="c3"><span title="0.0%">0s</span></td><td class="sub_name"><span style="display: none;">LWP::UserAgent::::requests_redirectable</span>LWP::UserAgent::<a href="LWP-UserAgent-pm-block.html#526">requests_redirectable</a></span></td></tr>
<tr><td class="c3">0</td><td class="c3">0</td><td class="c3">0</td><td class="c3"><span title="0.0%">0s</span></td><td class="c3"><span title="0.0%">0s</span></td><td class="sub_name"><span style="display: none;">LWP::UserAgent::::show_progress</span>LWP::UserAgent::<a href="LWP-UserAgent-pm-block.html#583">show_progress</a></span></td></tr>
<tr><td class="c3">0</td><td class="c3">0</td><td class="c3">0</td><td class="c3"><span title="0.0%">0s</span></td><td class="c3"><span title="0.0%">0s</span></td><td class="sub_name"><span style="display: none;">LWP::UserAgent::::timeout</span>LWP::UserAgent::<a href="LWP-UserAgent-pm-block.html#579">timeout</a></span></td></tr>
<tr><td class="c3">0</td><td class="c3">0</td><td class="c3">0</td><td class="c3"><span title="0.0%">0s</span></td><td class="c3"><span title="0.0%">0s</span></td><td class="sub_name"><span style="display: none;">LWP::UserAgent::::use_alarm</span>LWP::UserAgent::<a href="LWP-UserAgent-pm-block.html#787">use_alarm</a></span></td></tr>
<tr><td class="c3">0</td><td class="c3">0</td><td class="c3">0</td><td class="c3"><span title="0.0%">0s</span></td><td class="c3"><span title="0.0%">0s</span></td><td class="sub_name"><span style="display: none;">LWP::UserAgent::::use_eval</span>LWP::UserAgent::<a href="LWP-UserAgent-pm-block.html#785">use_eval</a></span></td></tr>

        </tbody>
        </table>
    
        Call graph for these subroutines as a <a href="http://en.wikipedia.org/wiki/Graphviz">Graphviz</a> <a href="usr-local-lib-perl5-site_perl-5-10-1-LWP-UserAgent-pm.dot">dot language file</a>.
      <table border="1" cellpadding="0">
      <thead>
      <tr><th>Line</th>
      <th><span title="Number of statements executed">State<br />ments</span></th>
      <th><span title="Time spend executing statements on the line,
        excluding time spent executing statements in any called subroutines">Time<br />on line</span></th>
      <th><span title="Number of subroutines calls">Calls</span></th>
      <th><span title="Time spent in subroutines called">Time<br />in subs</span></th>
      <th class="left_indent_header">Code</th>
      </tr>

      </thead>
      <tbody>
    <tr><td class="h"><a name="1"></a>1</td><td></td><td></td><td></td><td></td><td class="s">package LWP::UserAgent;</td></tr>
<tr><td class="h"><a name="2"></a>2</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="3"></a>3</td><td class="c3">3</td><td class="c3"><span title="Avg 10&micro;s">30&micro;s</span></td><td class="c3">2</td><td class="c3">33&micro;s</td><td class="s"><div class="calls"><div class="calls_in"># spent 26&micro;s (20+7) within LWP::UserAgent::BEGIN@3 which was called
#    once (20&micro;s+7&micro;s) by SimpleDB::Client::BEGIN@49 at <a href="LWP-UserAgent-pm-block.html#3">line 3</a></div></div>use strict;<div class="calls"><div class="calls_out"># spent    26&micro;s making 1 call to <a href="LWP-UserAgent-pm-block.html#3">LWP::UserAgent::BEGIN@3</a>
# spent     7&micro;s making 1 call to <a href="strict-pm-block.html#34">strict::import</a></div></div></td></tr>
<tr><td class="h"><a name="4"></a>4</td><td class="c3">3</td><td class="c1"><span title="Avg 15&micro;s">44&micro;s</span></td><td class="c3">2</td><td class="c3">104&micro;s</td><td class="s"><div class="calls"><div class="calls_in"># spent 57&micro;s (9+48) within LWP::UserAgent::BEGIN@4 which was called
#    once (9&micro;s+48&micro;s) by SimpleDB::Client::BEGIN@49 at <a href="LWP-UserAgent-pm-block.html#4">line 4</a></div></div>use vars qw(@ISA $VERSION);<div class="calls"><div class="calls_out"># spent    57&micro;s making 1 call to <a href="LWP-UserAgent-pm-block.html#4">LWP::UserAgent::BEGIN@4</a>
# spent    48&micro;s making 1 call to <a href="vars-pm-block.html#10">vars::import</a></div></div></td></tr>
<tr><td class="h"><a name="5"></a>5</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="6"></a>6</td><td class="c3">1</td><td class="c3"><span title="Avg 2&micro;s">2&micro;s</span></td><td></td><td></td><td class="s">require LWP::MemberMixin;</td></tr>
<tr><td class="h"><a name="7"></a>7</td><td class="c3">1</td><td class="c3"><span title="Avg 23&micro;s">23&micro;s</span></td><td></td><td></td><td class="s">@ISA = qw(LWP::MemberMixin);</td></tr>
<tr><td class="h"><a name="8"></a>8</td><td class="c3">1</td><td class="c3"><span title="Avg 2&micro;s">2&micro;s</span></td><td></td><td></td><td class="s">$VERSION = &quot;5.834&quot;;</td></tr>
<tr><td class="h"><a name="9"></a>9</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="10"></a>10</td><td class="c3">3</td><td class="c0"><span title="Avg 50&micro;s">150&micro;s</span></td><td class="c3">1</td><td class="c0">49.9ms</td><td class="s"><div class="calls"><div class="calls_in"># spent 49.9ms (35.2+14.7) within LWP::UserAgent::BEGIN@10 which was called
#    once (35.2ms+14.7ms) by SimpleDB::Client::BEGIN@49 at <a href="LWP-UserAgent-pm-block.html#10">line 10</a></div></div>use HTTP::Request ();<div class="calls"><div class="calls_out"># spent  49.9ms making 1 call to <a href="LWP-UserAgent-pm-block.html#10">LWP::UserAgent::BEGIN@10</a></div></div></td></tr>
<tr><td class="h"><a name="11"></a>11</td><td class="c3">3</td><td class="c0"><span title="Avg 49&micro;s">147&micro;s</span></td><td class="c3">1</td><td class="c0">3.80ms</td><td class="s"><div class="calls"><div class="calls_in"># spent 3.80ms (1.26+2.54) within LWP::UserAgent::BEGIN@11 which was called
#    once (1.26ms+2.54ms) by SimpleDB::Client::BEGIN@49 at <a href="LWP-UserAgent-pm-block.html#11">line 11</a></div></div>use HTTP::Response ();<div class="calls"><div class="calls_out"># spent  3.80ms making 1 call to <a href="LWP-UserAgent-pm-block.html#11">LWP::UserAgent::BEGIN@11</a></div></div></td></tr>
<tr><td class="h"><a name="12"></a>12</td><td class="c3">3</td><td class="c0"><span title="Avg 50&micro;s">151&micro;s</span></td><td class="c3">1</td><td class="c0">22.6ms</td><td class="s"><div class="calls"><div class="calls_in"># spent 22.6ms (22.2+431&micro;s) within LWP::UserAgent::BEGIN@12 which was called
#    once (22.2ms+431&micro;s) by SimpleDB::Client::BEGIN@49 at <a href="LWP-UserAgent-pm-block.html#12">line 12</a></div></div>use HTTP::Date ();<div class="calls"><div class="calls_out"># spent  22.6ms making 1 call to <a href="LWP-UserAgent-pm-block.html#12">LWP::UserAgent::BEGIN@12</a></div></div></td></tr>
<tr><td class="h"><a name="13"></a>13</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="14"></a>14</td><td class="c3">3</td><td class="c0"><span title="Avg 65&micro;s">196&micro;s</span></td><td class="c3">1</td><td class="c2">209&micro;s</td><td class="s"><div class="calls"><div class="calls_in"># spent 209&micro;s within LWP::UserAgent::BEGIN@14 which was called
#    once (209&micro;s+0s) by SimpleDB::Client::BEGIN@49 at <a href="LWP-UserAgent-pm-block.html#14">line 14</a></div></div>use LWP ();<div class="calls"><div class="calls_out"># spent   209&micro;s making 1 call to <a href="LWP-UserAgent-pm-block.html#14">LWP::UserAgent::BEGIN@14</a></div></div></td></tr>
<tr><td class="h"><a name="15"></a>15</td><td class="c3">3</td><td class="c0"><span title="Avg 49&micro;s">148&micro;s</span></td><td class="c3">1</td><td class="c0">2.22ms</td><td class="s"><div class="calls"><div class="calls_in"># spent 2.22ms (2.13+89&micro;s) within LWP::UserAgent::BEGIN@15 which was called
#    once (2.13ms+89&micro;s) by SimpleDB::Client::BEGIN@49 at <a href="LWP-UserAgent-pm-block.html#15">line 15</a></div></div>use LWP::Protocol ();<div class="calls"><div class="calls_out"># spent  2.22ms making 1 call to <a href="LWP-UserAgent-pm-block.html#15">LWP::UserAgent::BEGIN@15</a></div></div></td></tr>
<tr><td class="h"><a name="16"></a>16</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="17"></a>17</td><td class="c3">3</td><td class="c0"><span title="Avg 374&micro;s">1.12ms</span></td><td class="c3">1</td><td class="c3">5&micro;s</td><td class="s"><div class="calls"><div class="calls_in"># spent 5&micro;s within LWP::UserAgent::BEGIN@17 which was called
#    once (5&micro;s+0s) by SimpleDB::Client::BEGIN@49 at <a href="LWP-UserAgent-pm-block.html#17">line 17</a></div></div>use Carp ();<div class="calls"><div class="calls_out"># spent     5&micro;s making 1 call to <a href="LWP-UserAgent-pm-block.html#17">LWP::UserAgent::BEGIN@17</a></div></div></td></tr>
<tr><td class="h"><a name="18"></a>18</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="19"></a>19</td><td class="c3">1</td><td class="c3"><span title="Avg 2&micro;s">2&micro;s</span></td><td></td><td></td><td class="s">if ($ENV{PERL_LWP_USE_HTTP_10}) {</td></tr>
<tr><td class="h"><a name="20"></a>20</td><td></td><td></td><td></td><td></td><td class="s">    require LWP::Protocol::http10;</td></tr>
<tr><td class="h"><a name="21"></a>21</td><td></td><td></td><td></td><td></td><td class="s">    LWP::Protocol::implementor('http', 'LWP::Protocol::http10');</td></tr>
<tr><td class="h"><a name="22"></a>22</td><td></td><td></td><td></td><td></td><td class="s">    eval {</td></tr>
<tr><td class="h"><a name="23"></a>23</td><td></td><td></td><td></td><td></td><td class="s">        require LWP::Protocol::https10;</td></tr>
<tr><td class="h"><a name="24"></a>24</td><td></td><td></td><td></td><td></td><td class="s">        LWP::Protocol::implementor('https', 'LWP::Protocol::https10');</td></tr>
<tr><td class="h"><a name="25"></a>25</td><td></td><td></td><td></td><td></td><td class="s">    };</td></tr>
<tr><td class="h"><a name="26"></a>26</td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h"><a name="27"></a>27</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="28"></a>28</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="29"></a>29</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="30"></a>30</td><td></td><td></td><td></td><td></td><td class="s">sub new</td></tr>
<tr><td class="h"><a name="31"></a>31</td><td></td><td></td><td></td><td></td><td class="s"><div class="calls"><div class="calls_in"># spent 8.98ms (61&micro;s+8.92) within LWP::UserAgent::new which was called
#    once (61&micro;s+8.92ms) by SimpleDB::Client::__ANON__[../lib/SimpleDB/Client.pm:133] at <a href="lib-SimpleDB-Client-pm-block.html#133">line 133 of ../lib/SimpleDB/Client.pm</a></div></div>{</td></tr>
<tr><td class="h"><a name="32"></a>32</td><td></td><td></td><td></td><td></td><td class="s">    # Check for common user mistake</td></tr>
<tr><td class="h"><a name="33"></a>33</td><td class="c0">40</td><td class="c1"><span title="Avg 1&micro;s">53&micro;s</span></td><td></td><td></td><td class="s">    Carp::croak(&quot;Options to LWP::UserAgent should be key/value pairs, not hash reference&quot;) </td></tr>
<tr><td class="h"><a name="34"></a>34</td><td></td><td></td><td></td><td></td><td class="s">        if ref($_[1]) eq 'HASH'; </td></tr>
<tr><td class="h"><a name="35"></a>35</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="36"></a>36</td><td></td><td></td><td></td><td></td><td class="s">    my($class, %cnf) = @_;</td></tr>
<tr><td class="h"><a name="37"></a>37</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="38"></a>38</td><td></td><td></td><td></td><td></td><td class="s">    my $agent = delete $cnf{agent};</td></tr>
<tr><td class="h"><a name="39"></a>39</td><td></td><td></td><td></td><td></td><td class="s">    my $from  = delete $cnf{from};</td></tr>
<tr><td class="h"><a name="40"></a>40</td><td></td><td></td><td></td><td></td><td class="s">    my $def_headers = delete $cnf{default_headers};</td></tr>
<tr><td class="h"><a name="41"></a>41</td><td></td><td></td><td></td><td></td><td class="s">    my $timeout = delete $cnf{timeout};</td></tr>
<tr><td class="h"><a name="42"></a>42</td><td></td><td></td><td></td><td></td><td class="s">    $timeout = 3*60 unless defined $timeout;</td></tr>
<tr><td class="h"><a name="43"></a>43</td><td></td><td></td><td></td><td></td><td class="s">    my $local_address = delete $cnf{local_address};</td></tr>
<tr><td class="h"><a name="44"></a>44</td><td></td><td></td><td></td><td></td><td class="s">    my $use_eval = delete $cnf{use_eval};</td></tr>
<tr><td class="h"><a name="45"></a>45</td><td></td><td></td><td></td><td></td><td class="s">    $use_eval = 1 unless defined $use_eval;</td></tr>
<tr><td class="h"><a name="46"></a>46</td><td></td><td></td><td></td><td></td><td class="s">    my $parse_head = delete $cnf{parse_head};</td></tr>
<tr><td class="h"><a name="47"></a>47</td><td></td><td></td><td></td><td></td><td class="s">    $parse_head = 1 unless defined $parse_head;</td></tr>
<tr><td class="h"><a name="48"></a>48</td><td></td><td></td><td></td><td></td><td class="s">    my $show_progress = delete $cnf{show_progress};</td></tr>
<tr><td class="h"><a name="49"></a>49</td><td></td><td></td><td></td><td></td><td class="s">    my $max_size = delete $cnf{max_size};</td></tr>
<tr><td class="h"><a name="50"></a>50</td><td></td><td></td><td></td><td></td><td class="s">    my $max_redirect = delete $cnf{max_redirect};</td></tr>
<tr><td class="h"><a name="51"></a>51</td><td></td><td></td><td></td><td></td><td class="s">    $max_redirect = 7 unless defined $max_redirect;</td></tr>
<tr><td class="h"><a name="52"></a>52</td><td></td><td></td><td></td><td></td><td class="s">    my $env_proxy = delete $cnf{env_proxy};</td></tr>
<tr><td class="h"><a name="53"></a>53</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="54"></a>54</td><td></td><td></td><td></td><td></td><td class="s">    my $cookie_jar = delete $cnf{cookie_jar};</td></tr>
<tr><td class="h"><a name="55"></a>55</td><td></td><td></td><td></td><td></td><td class="s">    my $conn_cache = delete $cnf{conn_cache};</td></tr>
<tr><td class="h"><a name="56"></a>56</td><td></td><td></td><td></td><td></td><td class="s">    my $keep_alive = delete $cnf{keep_alive};</td></tr>
<tr><td class="h"><a name="57"></a>57</td><td></td><td></td><td></td><td></td><td class="s">    </td></tr>
<tr><td class="h"><a name="58"></a>58</td><td></td><td></td><td></td><td></td><td class="s">    Carp::croak(&quot;Can't mix conn_cache and keep_alive&quot;)</td></tr>
<tr><td class="h"><a name="59"></a>59</td><td></td><td></td><td></td><td></td><td class="s">          if $conn_cache &amp;&amp; $keep_alive;</td></tr>
<tr><td class="h"><a name="60"></a>60</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="61"></a>61</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="62"></a>62</td><td></td><td></td><td></td><td></td><td class="s">    my $protocols_allowed   = delete $cnf{protocols_allowed};</td></tr>
<tr><td class="h"><a name="63"></a>63</td><td></td><td></td><td></td><td></td><td class="s">    my $protocols_forbidden = delete $cnf{protocols_forbidden};</td></tr>
<tr><td class="h"><a name="64"></a>64</td><td></td><td></td><td></td><td></td><td class="s">    </td></tr>
<tr><td class="h"><a name="65"></a>65</td><td></td><td></td><td></td><td></td><td class="s">    my $requests_redirectable = delete $cnf{requests_redirectable};</td></tr>
<tr><td class="h"><a name="66"></a>66</td><td></td><td></td><td></td><td></td><td class="s">    $requests_redirectable = ['GET', 'HEAD']</td></tr>
<tr><td class="h"><a name="67"></a>67</td><td></td><td></td><td></td><td></td><td class="s">      unless defined $requests_redirectable;</td></tr>
<tr><td class="h"><a name="68"></a>68</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="69"></a>69</td><td></td><td></td><td></td><td></td><td class="s">    # Actually &quot;&quot;s are just as good as 0's, but for concision we'll just say:</td></tr>
<tr><td class="h"><a name="70"></a>70</td><td></td><td></td><td></td><td></td><td class="s">    Carp::croak(&quot;protocols_allowed has to be an arrayref or 0, not \&quot;$protocols_allowed\&quot;!&quot;)</td></tr>
<tr><td class="h"><a name="71"></a>71</td><td></td><td></td><td></td><td></td><td class="s">      if $protocols_allowed and ref($protocols_allowed) ne 'ARRAY';</td></tr>
<tr><td class="h"><a name="72"></a>72</td><td></td><td></td><td></td><td></td><td class="s">    Carp::croak(&quot;protocols_forbidden has to be an arrayref or 0, not \&quot;$protocols_forbidden\&quot;!&quot;)</td></tr>
<tr><td class="h"><a name="73"></a>73</td><td></td><td></td><td></td><td></td><td class="s">      if $protocols_forbidden and ref($protocols_forbidden) ne 'ARRAY';</td></tr>
<tr><td class="h"><a name="74"></a>74</td><td></td><td></td><td></td><td></td><td class="s">    Carp::croak(&quot;requests_redirectable has to be an arrayref or 0, not \&quot;$requests_redirectable\&quot;!&quot;)</td></tr>
<tr><td class="h"><a name="75"></a>75</td><td></td><td></td><td></td><td></td><td class="s">      if $requests_redirectable and ref($requests_redirectable) ne 'ARRAY';</td></tr>
<tr><td class="h"><a name="76"></a>76</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="77"></a>77</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="78"></a>78</td><td></td><td></td><td></td><td></td><td class="s">    if (%cnf &amp;&amp; $^W) {</td></tr>
<tr><td class="h"><a name="79"></a>79</td><td></td><td></td><td></td><td></td><td class="s">        Carp::carp(&quot;Unrecognized LWP::UserAgent options: @{[sort keys %cnf]}&quot;);</td></tr>
<tr><td class="h"><a name="80"></a>80</td><td></td><td></td><td></td><td></td><td class="s">    }</td></tr>
<tr><td class="h"><a name="81"></a>81</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="82"></a>82</td><td></td><td></td><td></td><td></td><td class="s">    my $self = bless {</td></tr>
<tr><td class="h"><a name="83"></a>83</td><td></td><td></td><td></td><td></td><td class="s">                      def_headers  =&gt; $def_headers,</td></tr>
<tr><td class="h"><a name="84"></a>84</td><td></td><td></td><td></td><td></td><td class="s">                      timeout      =&gt; $timeout,</td></tr>
<tr><td class="h"><a name="85"></a>85</td><td></td><td></td><td></td><td></td><td class="s">                      local_address =&gt; $local_address,</td></tr>
<tr><td class="h"><a name="86"></a>86</td><td></td><td></td><td></td><td></td><td class="s">                      use_eval     =&gt; $use_eval,</td></tr>
<tr><td class="h"><a name="87"></a>87</td><td></td><td></td><td></td><td></td><td class="s">                      show_progress=&gt; $show_progress,</td></tr>
<tr><td class="h"><a name="88"></a>88</td><td></td><td></td><td></td><td></td><td class="s">                      max_size     =&gt; $max_size,</td></tr>
<tr><td class="h"><a name="89"></a>89</td><td></td><td></td><td></td><td></td><td class="s">                      max_redirect =&gt; $max_redirect,</td></tr>
<tr><td class="h"><a name="90"></a>90</td><td></td><td></td><td></td><td></td><td class="s">                      proxy        =&gt; {},</td></tr>
<tr><td class="h"><a name="91"></a>91</td><td></td><td></td><td></td><td></td><td class="s">                      no_proxy     =&gt; [],</td></tr>
<tr><td class="h"><a name="92"></a>92</td><td></td><td></td><td></td><td></td><td class="s">                      protocols_allowed     =&gt; $protocols_allowed,</td></tr>
<tr><td class="h"><a name="93"></a>93</td><td></td><td></td><td></td><td></td><td class="s">                      protocols_forbidden   =&gt; $protocols_forbidden,</td></tr>
<tr><td class="h"><a name="94"></a>94</td><td></td><td></td><td></td><td></td><td class="s">                      requests_redirectable =&gt; $requests_redirectable,</td></tr>
<tr><td class="h"><a name="95"></a>95</td><td></td><td></td><td></td><td></td><td class="s">                     }, $class;</td></tr>
<tr><td class="h"><a name="96"></a>96</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="97"></a>97</td><td></td><td></td><td></td><td></td><td class="s">    $self-&gt;agent(defined($agent) ? $agent : $class-&gt;_agent)<div class="calls"><div class="calls_out">    # spent    92&micro;s making 1 call to <a href="LWP-UserAgent-pm-block.html#659">LWP::UserAgent::agent</a>
    # spent     3&micro;s making 1 call to <a href="LWP-UserAgent-pm-block.html#657">LWP::UserAgent::_agent</a></div></div></td></tr>
<tr><td class="h"><a name="98"></a>98</td><td></td><td></td><td></td><td></td><td class="s">        if defined($agent) || !$def_headers || !$def_headers-&gt;header(&quot;User-Agent&quot;);</td></tr>
<tr><td class="h"><a name="99"></a>99</td><td></td><td></td><td></td><td></td><td class="s">    $self-&gt;from($from) if $from;</td></tr>
<tr><td class="h"><a name="100"></a>100</td><td></td><td></td><td></td><td></td><td class="s">    $self-&gt;cookie_jar($cookie_jar) if $cookie_jar;</td></tr>
<tr><td class="h"><a name="101"></a>101</td><td></td><td></td><td></td><td></td><td class="s">    $self-&gt;parse_head($parse_head);<div class="calls"><div class="calls_out">    # spent  1.50ms making 1 call to <a href="LWP-UserAgent-pm-block.html#585">LWP::UserAgent::parse_head</a></div></div></td></tr>
<tr><td class="h"><a name="102"></a>102</td><td></td><td></td><td></td><td></td><td class="s">    $self-&gt;env_proxy if $env_proxy;</td></tr>
<tr><td class="h"><a name="103"></a>103</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="104"></a>104</td><td></td><td></td><td></td><td></td><td class="s">    $self-&gt;protocols_allowed(  $protocols_allowed  ) if $protocols_allowed;</td></tr>
<tr><td class="h"><a name="105"></a>105</td><td></td><td></td><td></td><td></td><td class="s">    $self-&gt;protocols_forbidden($protocols_forbidden) if $protocols_forbidden;</td></tr>
<tr><td class="h"><a name="106"></a>106</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="107"></a>107</td><td></td><td></td><td></td><td></td><td class="s">    if ($keep_alive) {</td></tr>
<tr><td class="h"><a name="108"></a>108</td><td></td><td></td><td></td><td></td><td class="s">        $conn_cache ||= { total_capacity =&gt; $keep_alive };</td></tr>
<tr><td class="h"><a name="109"></a>109</td><td></td><td></td><td></td><td></td><td class="s">    }</td></tr>
<tr><td class="h"><a name="110"></a>110</td><td></td><td></td><td></td><td></td><td class="s">    $self-&gt;conn_cache($conn_cache) if $conn_cache;<div class="calls"><div class="calls_out">    # spent  7.32ms making 1 call to <a href="LWP-UserAgent-pm-block.html#680">LWP::UserAgent::conn_cache</a></div></div></td></tr>
<tr><td class="h"><a name="111"></a>111</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="112"></a>112</td><td></td><td></td><td></td><td></td><td class="s">    return $self;</td></tr>
<tr><td class="h"><a name="113"></a>113</td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h"><a name="114"></a>114</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="115"></a>115</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="116"></a>116</td><td></td><td></td><td></td><td></td><td class="s">sub send_request</td></tr>
<tr><td class="h"><a name="117"></a>117</td><td></td><td></td><td></td><td></td><td class="s"><div class="calls"><div class="calls_in"># spent 363ms (279&micro;s+363) within LWP::UserAgent::send_request which was called 3 times, avg 121ms/call:
# 3 times (279&micro;s+363ms) by LWP::UserAgent::simple_request at <a href="LWP-UserAgent-pm-block.html#253">line 253</a>, avg 121ms/call</div></div>{</td></tr>
<tr><td class="h"><a name="118"></a>118</td><td class="c0">36</td><td class="c0"><span title="Avg 4&micro;s">130&micro;s</span></td><td></td><td></td><td class="s">    my($self, $request, $arg, $size) = @_;</td></tr>
<tr><td class="h"><a name="119"></a>119</td><td></td><td></td><td></td><td></td><td class="s">    my($method, $url) = ($request-&gt;method, $request-&gt;uri);<div class="calls"><div class="calls_out">    # spent    20&micro;s making 3 calls to <a href="HTTP-Request-pm-block.html#53">HTTP::Request::method</a>, avg 7&micro;s/call
    # spent    16&micro;s making 3 calls to <a href="HTTP-Request-pm-block.html#59">HTTP::Request::uri</a>, avg 5&micro;s/call</div></div></td></tr>
<tr><td class="h"><a name="120"></a>120</td><td></td><td></td><td></td><td></td><td class="s">    my $scheme = $url-&gt;scheme;<div class="calls"><div class="calls_out">    # spent    40&micro;s making 3 calls to <a href="URI-pm-block.html#193">URI::scheme</a>, avg 13&micro;s/call</div></div></td></tr>
<tr><td class="h"><a name="121"></a>121</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="122"></a>122</td><td></td><td></td><td></td><td></td><td class="s">    local($SIG{__DIE__});  # protect against user defined die handlers</td></tr>
<tr><td class="h"><a name="123"></a>123</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="124"></a>124</td><td></td><td></td><td></td><td></td><td class="s">    $self-&gt;progress(&quot;begin&quot;, $request);<div class="calls"><div class="calls_out">    # spent     9&micro;s making 3 calls to <a href="LWP-UserAgent-pm-block.html#460">LWP::UserAgent::progress</a>, avg 3&micro;s/call</div></div></td></tr>
<tr><td class="h"><a name="125"></a>125</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="126"></a>126</td><td></td><td></td><td></td><td></td><td class="s">    my $response = $self-&gt;run_handlers(&quot;request_send&quot;, $request);<div class="calls"><div class="calls_out">    # spent    28&micro;s making 3 calls to <a href="LWP-UserAgent-pm-block.html#768">LWP::UserAgent::run_handlers</a>, avg 9&micro;s/call</div></div></td></tr>
<tr><td class="h"><a name="127"></a>127</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="128"></a>128</td><td class="c0">18</td><td class="c3"><span title="Avg 1&micro;s">22&micro;s</span></td><td></td><td></td><td class="s">    unless ($response) {</td></tr>
<tr><td class="h"><a name="129"></a>129</td><td></td><td></td><td></td><td></td><td class="s">        my $protocol;</td></tr>
<tr><td class="h"><a name="130"></a>130</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="131"></a>131</td><td></td><td></td><td></td><td></td><td class="s">        {</td></tr>
<tr><td class="h"><a name="132"></a>132</td><td></td><td></td><td></td><td></td><td class="s">            # Honor object-specific restrictions by forcing protocol objects</td></tr>
<tr><td class="h"><a name="133"></a>133</td><td></td><td></td><td></td><td></td><td class="s">            #  into class LWP::Protocol::nogo.</td></tr>
<tr><td class="h"><a name="134"></a>134</td><td class="c0">6</td><td class="c3"><span title="Avg 3&micro;s">20&micro;s</span></td><td></td><td></td><td class="s">            my $x;</td></tr>
<tr><td class="h"><a name="135"></a>135</td><td></td><td></td><td></td><td></td><td class="s">            if($x = $self-&gt;protocols_allowed) {<div class="calls"><div class="calls_out">            # spent    41&micro;s making 3 calls to <a href="LWP-UserAgent-pm-block.html#524">LWP::UserAgent::protocols_allowed</a>, avg 14&micro;s/call
            # spent    22&micro;s making 3 calls to <a href="LWP-UserAgent-pm-block.html#525">LWP::UserAgent::protocols_forbidden</a>, avg 8&micro;s/call</div></div></td></tr>
<tr><td class="h"><a name="136"></a>136</td><td></td><td></td><td></td><td></td><td class="s">                if (grep lc($_) eq $scheme, @$x) {</td></tr>
<tr><td class="h"><a name="137"></a>137</td><td></td><td></td><td></td><td></td><td class="s">                }</td></tr>
<tr><td class="h"><a name="138"></a>138</td><td></td><td></td><td></td><td></td><td class="s">                else {</td></tr>
<tr><td class="h"><a name="139"></a>139</td><td></td><td></td><td></td><td></td><td class="s">                    require LWP::Protocol::nogo;</td></tr>
<tr><td class="h"><a name="140"></a>140</td><td></td><td></td><td></td><td></td><td class="s">                    $protocol = LWP::Protocol::nogo-&gt;new;</td></tr>
<tr><td class="h"><a name="141"></a>141</td><td></td><td></td><td></td><td></td><td class="s">                }</td></tr>
<tr><td class="h"><a name="142"></a>142</td><td></td><td></td><td></td><td></td><td class="s">            }</td></tr>
<tr><td class="h"><a name="143"></a>143</td><td></td><td></td><td></td><td></td><td class="s">            elsif ($x = $self-&gt;protocols_forbidden) {</td></tr>
<tr><td class="h"><a name="144"></a>144</td><td></td><td></td><td></td><td></td><td class="s">                if(grep lc($_) eq $scheme, @$x) {</td></tr>
<tr><td class="h"><a name="145"></a>145</td><td></td><td></td><td></td><td></td><td class="s">                    require LWP::Protocol::nogo;</td></tr>
<tr><td class="h"><a name="146"></a>146</td><td></td><td></td><td></td><td></td><td class="s">                    $protocol = LWP::Protocol::nogo-&gt;new;</td></tr>
<tr><td class="h"><a name="147"></a>147</td><td></td><td></td><td></td><td></td><td class="s">                }</td></tr>
<tr><td class="h"><a name="148"></a>148</td><td></td><td></td><td></td><td></td><td class="s">            }</td></tr>
<tr><td class="h"><a name="149"></a>149</td><td></td><td></td><td></td><td></td><td class="s">            # else fall thru and create the protocol object normally</td></tr>
<tr><td class="h"><a name="150"></a>150</td><td></td><td></td><td></td><td></td><td class="s">        }</td></tr>
<tr><td class="h"><a name="151"></a>151</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="152"></a>152</td><td></td><td></td><td></td><td></td><td class="s">        # Locate protocol to use</td></tr>
<tr><td class="h"><a name="153"></a>153</td><td></td><td></td><td></td><td></td><td class="s">        my $proxy = $request-&gt;{proxy};</td></tr>
<tr><td class="h"><a name="154"></a>154</td><td></td><td></td><td></td><td></td><td class="s">        if ($proxy) {</td></tr>
<tr><td class="h"><a name="155"></a>155</td><td></td><td></td><td></td><td></td><td class="s">            $scheme = $proxy-&gt;scheme;</td></tr>
<tr><td class="h"><a name="156"></a>156</td><td></td><td></td><td></td><td></td><td class="s">        }</td></tr>
<tr><td class="h"><a name="157"></a>157</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="158"></a>158</td><td class="c0">6</td><td class="c3"><span title="Avg 717ns">4&micro;s</span></td><td></td><td></td><td class="s">        unless ($protocol) {</td></tr>
<tr><td class="h"><a name="159"></a>159</td><td class="c3">3</td><td class="c3"><span title="Avg 3&micro;s">9&micro;s</span></td><td class="c1">3</td><td class="c0">17.2ms</td><td class="s">            $protocol = eval { LWP::Protocol::create($scheme, $self) };<div class="calls"><div class="calls_out">            # spent  17.2ms making 3 calls to <a href="LWP-Protocol-pm-block.html#33">LWP::Protocol::create</a>, avg 5.73ms/call</div></div></td></tr>
<tr><td class="h"><a name="160"></a>160</td><td></td><td></td><td></td><td></td><td class="s">            if ($@) {</td></tr>
<tr><td class="h"><a name="161"></a>161</td><td></td><td></td><td></td><td></td><td class="s">                $@ =~ s/ at .* line \d+.*//s;  # remove file/line number</td></tr>
<tr><td class="h"><a name="162"></a>162</td><td></td><td></td><td></td><td></td><td class="s">                $response =  _new_response($request, &amp;HTTP::Status::RC_NOT_IMPLEMENTED, $@);</td></tr>
<tr><td class="h"><a name="163"></a>163</td><td></td><td></td><td></td><td></td><td class="s">                if ($scheme eq &quot;https&quot;) {</td></tr>
<tr><td class="h"><a name="164"></a>164</td><td></td><td></td><td></td><td></td><td class="s">                    $response-&gt;message($response-&gt;message . &quot; (Crypt::SSLeay or IO::Socket::SSL not installed)&quot;);</td></tr>
<tr><td class="h"><a name="165"></a>165</td><td></td><td></td><td></td><td></td><td class="s">                    $response-&gt;content_type(&quot;text/plain&quot;);</td></tr>
<tr><td class="h"><a name="166"></a>166</td><td></td><td></td><td></td><td></td><td class="s">                    $response-&gt;content(&lt;&lt;EOT);</td></tr>
<tr><td class="h"><a name="167"></a>167</td><td></td><td></td><td></td><td></td><td class="s">LWP will support https URLs if either Crypt::SSLeay or IO::Socket::SSL</td></tr>
<tr><td class="h"><a name="168"></a>168</td><td></td><td></td><td></td><td></td><td class="s">is installed. More information at</td></tr>
<tr><td class="h"><a name="169"></a>169</td><td></td><td></td><td></td><td></td><td class="s">&lt;http://search.cpan.org/dist/libwww-perl/README.SSL&gt;.</td></tr>
<tr><td class="h"><a name="170"></a>170</td><td></td><td></td><td></td><td></td><td class="s">EOT</td></tr>
<tr><td class="h"><a name="171"></a>171</td><td></td><td></td><td></td><td></td><td class="s">                }</td></tr>
<tr><td class="h"><a name="172"></a>172</td><td></td><td></td><td></td><td></td><td class="s">            }</td></tr>
<tr><td class="h"><a name="173"></a>173</td><td></td><td></td><td></td><td></td><td class="s">        }</td></tr>
<tr><td class="h"><a name="174"></a>174</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="175"></a>175</td><td class="c0">6</td><td class="c3"><span title="Avg 833ns">5&micro;s</span></td><td></td><td></td><td class="s">        if (!$response &amp;&amp; $self-&gt;{use_eval}) {</td></tr>
<tr><td class="h"><a name="176"></a>176</td><td></td><td></td><td></td><td></td><td class="s">            # we eval, and turn dies into responses below</td></tr>
<tr><td class="h"><a name="177"></a>177</td><td class="c3">3</td><td class="c3"><span title="Avg 5&micro;s">14&micro;s</span></td><td></td><td></td><td class="s">            eval {</td></tr>
<tr><td class="h"><a name="178"></a>178</td><td></td><td></td><td></td><td></td><td class="s">                $response = $protocol-&gt;request($request, $proxy,<div class="calls"><div class="calls_out">                # spent   345ms making 3 calls to <a href="LWP-Protocol-http-pm-block.html#122">LWP::Protocol::http::request</a>, avg 115ms/call</div></div></td></tr>
<tr><td class="h"><a name="179"></a>179</td><td></td><td></td><td></td><td></td><td class="s">                                               $arg, $size, $self-&gt;{timeout});</td></tr>
<tr><td class="h"><a name="180"></a>180</td><td></td><td></td><td></td><td></td><td class="s">            };</td></tr>
<tr><td class="h"><a name="181"></a>181</td><td></td><td></td><td></td><td></td><td class="s">            if ($@) {</td></tr>
<tr><td class="h"><a name="182"></a>182</td><td></td><td></td><td></td><td></td><td class="s">                $@ =~ s/ at .* line \d+.*//s;  # remove file/line number</td></tr>
<tr><td class="h"><a name="183"></a>183</td><td></td><td></td><td></td><td></td><td class="s">                    $response = _new_response($request,</td></tr>
<tr><td class="h"><a name="184"></a>184</td><td></td><td></td><td></td><td></td><td class="s">                                              &amp;HTTP::Status::RC_INTERNAL_SERVER_ERROR,</td></tr>
<tr><td class="h"><a name="185"></a>185</td><td></td><td></td><td></td><td></td><td class="s">                                              $@);</td></tr>
<tr><td class="h"><a name="186"></a>186</td><td></td><td></td><td></td><td></td><td class="s">            }</td></tr>
<tr><td class="h"><a name="187"></a>187</td><td></td><td></td><td></td><td></td><td class="s">        }</td></tr>
<tr><td class="h"><a name="188"></a>188</td><td></td><td></td><td></td><td></td><td class="s">        elsif (!$response) {</td></tr>
<tr><td class="h"><a name="189"></a>189</td><td></td><td></td><td></td><td></td><td class="s">            $response = $protocol-&gt;request($request, $proxy,</td></tr>
<tr><td class="h"><a name="190"></a>190</td><td></td><td></td><td></td><td></td><td class="s">                                           $arg, $size, $self-&gt;{timeout});</td></tr>
<tr><td class="h"><a name="191"></a>191</td><td></td><td></td><td></td><td></td><td class="s">            # XXX: Should we die unless $response-&gt;is_success ???</td></tr>
<tr><td class="h"><a name="192"></a>192</td><td></td><td></td><td></td><td></td><td class="s">        }</td></tr>
<tr><td class="h"><a name="193"></a>193</td><td></td><td></td><td></td><td></td><td class="s">    }</td></tr>
<tr><td class="h"><a name="194"></a>194</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="195"></a>195</td><td></td><td></td><td></td><td></td><td class="s">    $response-&gt;request($request);  # record request for reference<div class="calls"><div class="calls_out">    # spent    39&micro;s making 3 calls to <a href="HTTP-Response-pm-block.html#64">HTTP::Response::request</a>, avg 13&micro;s/call</div></div></td></tr>
<tr><td class="h"><a name="196"></a>196</td><td></td><td></td><td></td><td></td><td class="s">    $response-&gt;header(&quot;Client-Date&quot; =&gt; HTTP::Date::time2str(time));<div class="calls"><div class="calls_out">    # spent   162&micro;s making 3 calls to <a href="HTTP-Message-pm-block.html#622">HTTP::Message::__ANON__[HTTP/Message.pm:622]</a>, avg 54&micro;s/call
    # spent    63&micro;s making 3 calls to <a href="HTTP-Date-pm-block.html#23">HTTP::Date::time2str</a>, avg 21&micro;s/call</div></div></td></tr>
<tr><td class="h"><a name="197"></a>197</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="198"></a>198</td><td></td><td></td><td></td><td></td><td class="s">    $self-&gt;run_handlers(&quot;response_done&quot;, $response);<div class="calls"><div class="calls_out">    # spent    34&micro;s making 3 calls to <a href="LWP-UserAgent-pm-block.html#768">LWP::UserAgent::run_handlers</a>, avg 11&micro;s/call</div></div></td></tr>
<tr><td class="h"><a name="199"></a>199</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="200"></a>200</td><td></td><td></td><td></td><td></td><td class="s">    $self-&gt;progress(&quot;end&quot;, $response);<div class="calls"><div class="calls_out">    # spent     7&micro;s making 3 calls to <a href="LWP-UserAgent-pm-block.html#460">LWP::UserAgent::progress</a>, avg 2&micro;s/call</div></div></td></tr>
<tr><td class="h"><a name="201"></a>201</td><td></td><td></td><td></td><td></td><td class="s">    return $response;</td></tr>
<tr><td class="h"><a name="202"></a>202</td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h"><a name="203"></a>203</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="204"></a>204</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="205"></a>205</td><td></td><td></td><td></td><td></td><td class="s">sub prepare_request</td></tr>
<tr><td class="h"><a name="206"></a>206</td><td></td><td></td><td></td><td></td><td class="s"><div class="calls"><div class="calls_in"># spent 584&micro;s (169+415) within LWP::UserAgent::prepare_request which was called 3 times, avg 195&micro;s/call:
# 3 times (169&micro;s+415&micro;s) by LWP::UserAgent::simple_request at <a href="LWP-UserAgent-pm-block.html#247">line 247</a>, avg 195&micro;s/call</div></div>{</td></tr>
<tr><td class="h"><a name="207"></a>207</td><td class="c0">27</td><td class="c0"><span title="Avg 3&micro;s">81&micro;s</span></td><td></td><td></td><td class="s">    my($self, $request) = @_;</td></tr>
<tr><td class="h"><a name="208"></a>208</td><td></td><td></td><td></td><td></td><td class="s">    die &quot;Method missing&quot; unless $request-&gt;method;<div class="calls"><div class="calls_out">    # spent    21&micro;s making 3 calls to <a href="HTTP-Request-pm-block.html#53">HTTP::Request::method</a>, avg 7&micro;s/call</div></div></td></tr>
<tr><td class="h"><a name="209"></a>209</td><td></td><td></td><td></td><td></td><td class="s">    my $url = $request-&gt;uri;<div class="calls"><div class="calls_out">    # spent    16&micro;s making 3 calls to <a href="HTTP-Request-pm-block.html#59">HTTP::Request::uri</a>, avg 5&micro;s/call</div></div></td></tr>
<tr><td class="h"><a name="210"></a>210</td><td class="c3">1</td><td class="c3"><span title="Avg 2&micro;s">2&micro;s</span></td><td class="c1">3</td><td class="c3">9&micro;s</td><td class="s">    die &quot;URL missing&quot; unless $url;<div class="calls"><div class="calls_out">    # spent     9&micro;s making 3 calls to <a href="URI-pm-block.html#24">URI::__ANON__[URI.pm:24]</a>, avg 3&micro;s/call</div></div></td></tr>
<tr><td class="h"><a name="211"></a>211</td><td></td><td></td><td></td><td></td><td class="s">    die &quot;URL must be absolute&quot; unless $url-&gt;scheme;<div class="calls"><div class="calls_out">    # spent    76&micro;s making 3 calls to <a href="URI-pm-block.html#193">URI::scheme</a>, avg 25&micro;s/call</div></div></td></tr>
<tr><td class="h"><a name="212"></a>212</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="213"></a>213</td><td></td><td></td><td></td><td></td><td class="s">    $self-&gt;run_handlers(&quot;request_preprepare&quot;, $request);<div class="calls"><div class="calls_out">    # spent    39&micro;s making 3 calls to <a href="LWP-UserAgent-pm-block.html#768">LWP::UserAgent::run_handlers</a>, avg 13&micro;s/call</div></div></td></tr>
<tr><td class="h"><a name="214"></a>214</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="215"></a>215</td><td></td><td></td><td></td><td></td><td class="s">    if (my $def_headers = $self-&gt;{def_headers}) {<div class="calls"><div class="calls_out">    # spent    53&micro;s making 3 calls to <a href="HTTP-Headers-pm-block.html#209">HTTP::Headers::header_field_names</a>, avg 18&micro;s/call</div></div></td></tr>
<tr><td class="h"><a name="216"></a>216</td><td></td><td></td><td></td><td></td><td class="s">        for my $h ($def_headers-&gt;header_field_names) {</td></tr>
<tr><td class="h"><a name="217"></a>217</td><td class="c3">3</td><td class="c3"><span title="Avg 9&micro;s">26&micro;s</span></td><td class="c0">6</td><td class="c3">134&micro;s</td><td class="s">            $request-&gt;init_header($h =&gt; [$def_headers-&gt;header($h)]);<div class="calls"><div class="calls_out">            # spent    64&micro;s making 3 calls to <a href="HTTP-Headers-pm-block.html#76">HTTP::Headers::header</a>, avg 21&micro;s/call
            # spent    58&micro;s making 2 calls to <a href="HTTP-Message-pm-block.html#622">HTTP::Message::__ANON__[HTTP/Message.pm:622]</a>, avg 29&micro;s/call
            # spent    13&micro;s making 1 call to <a href="HTTP-Message-pm-block.html#616">HTTP::Message::AUTOLOAD</a></div></div></td></tr>
<tr><td class="h"><a name="218"></a>218</td><td></td><td></td><td></td><td></td><td class="s">        }</td></tr>
<tr><td class="h"><a name="219"></a>219</td><td></td><td></td><td></td><td></td><td class="s">    }</td></tr>
<tr><td class="h"><a name="220"></a>220</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="221"></a>221</td><td></td><td></td><td></td><td></td><td class="s">    $self-&gt;run_handlers(&quot;request_prepare&quot;, $request);<div class="calls"><div class="calls_out">    # spent    28&micro;s making 3 calls to <a href="LWP-UserAgent-pm-block.html#768">LWP::UserAgent::run_handlers</a>, avg 9&micro;s/call</div></div></td></tr>
<tr><td class="h"><a name="222"></a>222</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="223"></a>223</td><td></td><td></td><td></td><td></td><td class="s">    return $request;</td></tr>
<tr><td class="h"><a name="224"></a>224</td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h"><a name="225"></a>225</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="226"></a>226</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="227"></a>227</td><td></td><td></td><td></td><td></td><td class="s">sub simple_request</td></tr>
<tr><td class="h"><a name="228"></a>228</td><td></td><td></td><td></td><td></td><td class="s"><div class="calls"><div class="calls_in"># spent 364ms (81&micro;s+364) within LWP::UserAgent::simple_request which was called 3 times, avg 121ms/call:
# 3 times (81&micro;s+364ms) by LWP::UserAgent::request at <a href="LWP-UserAgent-pm-block.html#261">line 261</a>, avg 121ms/call</div></div>{</td></tr>
<tr><td class="h"><a name="229"></a>229</td><td class="c0">15</td><td class="c0"><span title="Avg 4&micro;s">64&micro;s</span></td><td></td><td></td><td class="s">    my($self, $request, $arg, $size) = @_;</td></tr>
<tr><td class="h"><a name="230"></a>230</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="231"></a>231</td><td></td><td></td><td></td><td></td><td class="s">    # sanity check the request passed in</td></tr>
<tr><td class="h"><a name="232"></a>232</td><td></td><td></td><td></td><td></td><td class="s">    if (defined $request) {<div class="calls"><div class="calls_out">    # spent     6&micro;s making 6 calls to <a >UNIVERSAL::can</a>, avg 1&micro;s/call</div></div></td></tr>
<tr><td class="h"><a name="233"></a>233</td><td></td><td></td><td></td><td></td><td class="s">        if (ref $request) {</td></tr>
<tr><td class="h"><a name="234"></a>234</td><td></td><td></td><td></td><td></td><td class="s">            Carp::croak(&quot;You need a request object, not a &quot; . ref($request) . &quot; object&quot;)</td></tr>
<tr><td class="h"><a name="235"></a>235</td><td></td><td></td><td></td><td></td><td class="s">              if ref($request) eq 'ARRAY' or ref($request) eq 'HASH' or</td></tr>
<tr><td class="h"><a name="236"></a>236</td><td></td><td></td><td></td><td></td><td class="s">                 !$request-&gt;can('method') or !$request-&gt;can('uri');</td></tr>
<tr><td class="h"><a name="237"></a>237</td><td></td><td></td><td></td><td></td><td class="s">        }</td></tr>
<tr><td class="h"><a name="238"></a>238</td><td></td><td></td><td></td><td></td><td class="s">        else {</td></tr>
<tr><td class="h"><a name="239"></a>239</td><td></td><td></td><td></td><td></td><td class="s">            Carp::croak(&quot;You need a request object, not '$request'&quot;);</td></tr>
<tr><td class="h"><a name="240"></a>240</td><td></td><td></td><td></td><td></td><td class="s">        }</td></tr>
<tr><td class="h"><a name="241"></a>241</td><td></td><td></td><td></td><td></td><td class="s">    }</td></tr>
<tr><td class="h"><a name="242"></a>242</td><td></td><td></td><td></td><td></td><td class="s">    else {</td></tr>
<tr><td class="h"><a name="243"></a>243</td><td></td><td></td><td></td><td></td><td class="s">        Carp::croak(&quot;No request object passed in&quot;);</td></tr>
<tr><td class="h"><a name="244"></a>244</td><td></td><td></td><td></td><td></td><td class="s">    }</td></tr>
<tr><td class="h"><a name="245"></a>245</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="246"></a>246</td><td class="c3">3</td><td class="c3"><span title="Avg 4&micro;s">11&micro;s</span></td><td></td><td></td><td class="s">    eval {</td></tr>
<tr><td class="h"><a name="247"></a>247</td><td></td><td></td><td></td><td></td><td class="s">        $request = $self-&gt;prepare_request($request);<div class="calls"><div class="calls_out">        # spent   584&micro;s making 3 calls to <a href="LWP-UserAgent-pm-block.html#206">LWP::UserAgent::prepare_request</a>, avg 195&micro;s/call</div></div></td></tr>
<tr><td class="h"><a name="248"></a>248</td><td></td><td></td><td></td><td></td><td class="s">    };</td></tr>
<tr><td class="h"><a name="249"></a>249</td><td></td><td></td><td></td><td></td><td class="s">    if ($@) {</td></tr>
<tr><td class="h"><a name="250"></a>250</td><td></td><td></td><td></td><td></td><td class="s">        $@ =~ s/ at .* line \d+.*//s;  # remove file/line number</td></tr>
<tr><td class="h"><a name="251"></a>251</td><td></td><td></td><td></td><td></td><td class="s">        return _new_response($request, &amp;HTTP::Status::RC_BAD_REQUEST, $@);</td></tr>
<tr><td class="h"><a name="252"></a>252</td><td></td><td></td><td></td><td></td><td class="s">    }</td></tr>
<tr><td class="h"><a name="253"></a>253</td><td></td><td></td><td></td><td></td><td class="s">    return $self-&gt;send_request($request, $arg, $size);<div class="calls"><div class="calls_out">    # spent   363ms making 3 calls to <a href="LWP-UserAgent-pm-block.html#117">LWP::UserAgent::send_request</a>, avg 121ms/call</div></div></td></tr>
<tr><td class="h"><a name="254"></a>254</td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h"><a name="255"></a>255</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="256"></a>256</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="257"></a>257</td><td></td><td></td><td></td><td></td><td class="s">sub request</td></tr>
<tr><td class="h"><a name="258"></a>258</td><td></td><td></td><td></td><td></td><td class="s"><div class="calls"><div class="calls_in"># spent 364ms (169&micro;s+364) within LWP::UserAgent::request which was called 3 times, avg 121ms/call:
# 3 times (169&micro;s+364ms) by SimpleDB::Client::send_request at <a href="lib-SimpleDB-Client-pm-block.html#209">line 209 of ../lib/SimpleDB/Client.pm</a>, avg 121ms/call</div></div>{</td></tr>
<tr><td class="h"><a name="259"></a>259</td><td class="c0">24</td><td class="c0"><span title="Avg 8&micro;s">183&micro;s</span></td><td></td><td></td><td class="s">    my($self, $request, $arg, $size, $previous) = @_;</td></tr>
<tr><td class="h"><a name="260"></a>260</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="261"></a>261</td><td></td><td></td><td></td><td></td><td class="s">    my $response = $self-&gt;simple_request($request, $arg, $size);<div class="calls"><div class="calls_out">    # spent   364ms making 3 calls to <a href="LWP-UserAgent-pm-block.html#228">LWP::UserAgent::simple_request</a>, avg 121ms/call</div></div></td></tr>
<tr><td class="h"><a name="262"></a>262</td><td></td><td></td><td></td><td></td><td class="s">    $response-&gt;previous($previous) if $previous;</td></tr>
<tr><td class="h"><a name="263"></a>263</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="264"></a>264</td><td></td><td></td><td></td><td></td><td class="s">    if ($response-&gt;redirects &gt;= $self-&gt;{max_redirect}) {<div class="calls"><div class="calls_out">    # spent    60&micro;s making 3 calls to <a href="HTTP-Response-pm-block.html#99">HTTP::Response::redirects</a>, avg 20&micro;s/call</div></div></td></tr>
<tr><td class="h"><a name="265"></a>265</td><td></td><td></td><td></td><td></td><td class="s">        $response-&gt;header(&quot;Client-Warning&quot; =&gt;</td></tr>
<tr><td class="h"><a name="266"></a>266</td><td></td><td></td><td></td><td></td><td class="s">                          &quot;Redirect loop detected (max_redirect = $self-&gt;{max_redirect})&quot;);</td></tr>
<tr><td class="h"><a name="267"></a>267</td><td></td><td></td><td></td><td></td><td class="s">        return $response;</td></tr>
<tr><td class="h"><a name="268"></a>268</td><td></td><td></td><td></td><td></td><td class="s">    }</td></tr>
<tr><td class="h"><a name="269"></a>269</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="270"></a>270</td><td></td><td></td><td></td><td></td><td class="s">    if (my $req = $self-&gt;run_handlers(&quot;response_redirect&quot;, $response)) {<div class="calls"><div class="calls_out">    # spent    34&micro;s making 3 calls to <a href="LWP-UserAgent-pm-block.html#768">LWP::UserAgent::run_handlers</a>, avg 11&micro;s/call</div></div></td></tr>
<tr><td class="h"><a name="271"></a>271</td><td></td><td></td><td></td><td></td><td class="s">        return $self-&gt;request($req, $arg, $size, $response);</td></tr>
<tr><td class="h"><a name="272"></a>272</td><td></td><td></td><td></td><td></td><td class="s">    }</td></tr>
<tr><td class="h"><a name="273"></a>273</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="274"></a>274</td><td></td><td></td><td></td><td></td><td class="s">    my $code = $response-&gt;code;<div class="calls"><div class="calls_out">    # spent    21&micro;s making 3 calls to <a href="HTTP-Response-pm-block.html#61">HTTP::Response::code</a>, avg 7&micro;s/call</div></div></td></tr>
<tr><td class="h"><a name="275"></a>275</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="276"></a>276</td><td></td><td></td><td></td><td></td><td class="s">    if ($code == &amp;HTTP::Status::RC_MOVED_PERMANENTLY or<div class="calls"><div class="calls_out">    # spent     8&micro;s making 3 calls to <a href="HTTP-Status-pm-block.html#HTTP__Status__HTTP_MOVED_PERMANENTLY">HTTP::Status::HTTP_MOVED_PERMANENTLY</a>, avg 3&micro;s/call
    # spent     5&micro;s making 3 calls to <a href="HTTP-Status-pm-block.html#HTTP__Status__HTTP_PROXY_AUTHENTICATION_REQUIRED">HTTP::Status::HTTP_PROXY_AUTHENTICATION_REQUIRED</a>, avg 2&micro;s/call
    # spent     5&micro;s making 3 calls to <a href="HTTP-Status-pm-block.html#HTTP__Status__HTTP_FOUND">HTTP::Status::HTTP_FOUND</a>, avg 2&micro;s/call
    # spent     4&micro;s making 3 calls to <a href="HTTP-Status-pm-block.html#HTTP__Status__HTTP_UNAUTHORIZED">HTTP::Status::HTTP_UNAUTHORIZED</a>, avg 2&micro;s/call
    # spent     4&micro;s making 3 calls to <a href="HTTP-Status-pm-block.html#HTTP__Status__HTTP_TEMPORARY_REDIRECT">HTTP::Status::HTTP_TEMPORARY_REDIRECT</a>, avg 1&micro;s/call
    # spent     4&micro;s making 3 calls to <a href="HTTP-Status-pm-block.html#HTTP__Status__HTTP_SEE_OTHER">HTTP::Status::HTTP_SEE_OTHER</a>, avg 1&micro;s/call</div></div></td></tr>
<tr><td class="h"><a name="277"></a>277</td><td></td><td></td><td></td><td></td><td class="s">        $code == &amp;HTTP::Status::RC_FOUND or</td></tr>
<tr><td class="h"><a name="278"></a>278</td><td></td><td></td><td></td><td></td><td class="s">        $code == &amp;HTTP::Status::RC_SEE_OTHER or</td></tr>
<tr><td class="h"><a name="279"></a>279</td><td></td><td></td><td></td><td></td><td class="s">        $code == &amp;HTTP::Status::RC_TEMPORARY_REDIRECT)</td></tr>
<tr><td class="h"><a name="280"></a>280</td><td></td><td></td><td></td><td></td><td class="s">    {</td></tr>
<tr><td class="h"><a name="281"></a>281</td><td></td><td></td><td></td><td></td><td class="s">        my $referral = $request-&gt;clone;</td></tr>
<tr><td class="h"><a name="282"></a>282</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="283"></a>283</td><td></td><td></td><td></td><td></td><td class="s">        # These headers should never be forwarded</td></tr>
<tr><td class="h"><a name="284"></a>284</td><td></td><td></td><td></td><td></td><td class="s">        $referral-&gt;remove_header('Host', 'Cookie');</td></tr>
<tr><td class="h"><a name="285"></a>285</td><td></td><td></td><td></td><td></td><td class="s">        </td></tr>
<tr><td class="h"><a name="286"></a>286</td><td></td><td></td><td></td><td></td><td class="s">        if ($referral-&gt;header('Referer') &amp;&amp;</td></tr>
<tr><td class="h"><a name="287"></a>287</td><td></td><td></td><td></td><td></td><td class="s">            $request-&gt;uri-&gt;scheme eq 'https' &amp;&amp;</td></tr>
<tr><td class="h"><a name="288"></a>288</td><td></td><td></td><td></td><td></td><td class="s">            $referral-&gt;uri-&gt;scheme eq 'http')</td></tr>
<tr><td class="h"><a name="289"></a>289</td><td></td><td></td><td></td><td></td><td class="s">        {</td></tr>
<tr><td class="h"><a name="290"></a>290</td><td></td><td></td><td></td><td></td><td class="s">            # RFC 2616, section 15.1.3.</td></tr>
<tr><td class="h"><a name="291"></a>291</td><td></td><td></td><td></td><td></td><td class="s">            # https -&gt; http redirect, suppressing Referer</td></tr>
<tr><td class="h"><a name="292"></a>292</td><td></td><td></td><td></td><td></td><td class="s">            $referral-&gt;remove_header('Referer');</td></tr>
<tr><td class="h"><a name="293"></a>293</td><td></td><td></td><td></td><td></td><td class="s">        }</td></tr>
<tr><td class="h"><a name="294"></a>294</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="295"></a>295</td><td></td><td></td><td></td><td></td><td class="s">        if ($code == &amp;HTTP::Status::RC_SEE_OTHER ||</td></tr>
<tr><td class="h"><a name="296"></a>296</td><td></td><td></td><td></td><td></td><td class="s">            $code == &amp;HTTP::Status::RC_FOUND) </td></tr>
<tr><td class="h"><a name="297"></a>297</td><td></td><td></td><td></td><td></td><td class="s">        {</td></tr>
<tr><td class="h"><a name="298"></a>298</td><td></td><td></td><td></td><td></td><td class="s">            my $method = uc($referral-&gt;method);</td></tr>
<tr><td class="h"><a name="299"></a>299</td><td></td><td></td><td></td><td></td><td class="s">            unless ($method eq &quot;GET&quot; || $method eq &quot;HEAD&quot;) {</td></tr>
<tr><td class="h"><a name="300"></a>300</td><td></td><td></td><td></td><td></td><td class="s">                $referral-&gt;method(&quot;GET&quot;);</td></tr>
<tr><td class="h"><a name="301"></a>301</td><td></td><td></td><td></td><td></td><td class="s">                $referral-&gt;content(&quot;&quot;);</td></tr>
<tr><td class="h"><a name="302"></a>302</td><td></td><td></td><td></td><td></td><td class="s">                $referral-&gt;remove_content_headers;</td></tr>
<tr><td class="h"><a name="303"></a>303</td><td></td><td></td><td></td><td></td><td class="s">            }</td></tr>
<tr><td class="h"><a name="304"></a>304</td><td></td><td></td><td></td><td></td><td class="s">        }</td></tr>
<tr><td class="h"><a name="305"></a>305</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="306"></a>306</td><td></td><td></td><td></td><td></td><td class="s">        # And then we update the URL based on the Location:-header.</td></tr>
<tr><td class="h"><a name="307"></a>307</td><td></td><td></td><td></td><td></td><td class="s">        my $referral_uri = $response-&gt;header('Location');</td></tr>
<tr><td class="h"><a name="308"></a>308</td><td></td><td></td><td></td><td></td><td class="s">        {</td></tr>
<tr><td class="h"><a name="309"></a>309</td><td></td><td></td><td></td><td></td><td class="s">            # Some servers erroneously return a relative URL for redirects,</td></tr>
<tr><td class="h"><a name="310"></a>310</td><td></td><td></td><td></td><td></td><td class="s">            # so make it absolute if it not already is.</td></tr>
<tr><td class="h"><a name="311"></a>311</td><td></td><td></td><td></td><td></td><td class="s">            local $URI::ABS_ALLOW_RELATIVE_SCHEME = 1;</td></tr>
<tr><td class="h"><a name="312"></a>312</td><td></td><td></td><td></td><td></td><td class="s">            my $base = $response-&gt;base;</td></tr>
<tr><td class="h"><a name="313"></a>313</td><td></td><td></td><td></td><td></td><td class="s">            $referral_uri = &quot;&quot; unless defined $referral_uri;</td></tr>
<tr><td class="h"><a name="314"></a>314</td><td></td><td></td><td></td><td></td><td class="s">            $referral_uri = $HTTP::URI_CLASS-&gt;new($referral_uri, $base)</td></tr>
<tr><td class="h"><a name="315"></a>315</td><td></td><td></td><td></td><td></td><td class="s">                            -&gt;abs($base);</td></tr>
<tr><td class="h"><a name="316"></a>316</td><td></td><td></td><td></td><td></td><td class="s">        }</td></tr>
<tr><td class="h"><a name="317"></a>317</td><td></td><td></td><td></td><td></td><td class="s">        $referral-&gt;uri($referral_uri);</td></tr>
<tr><td class="h"><a name="318"></a>318</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="319"></a>319</td><td></td><td></td><td></td><td></td><td class="s">        return $response unless $self-&gt;redirect_ok($referral, $response);</td></tr>
<tr><td class="h"><a name="320"></a>320</td><td></td><td></td><td></td><td></td><td class="s">        return $self-&gt;request($referral, $arg, $size, $response);</td></tr>
<tr><td class="h"><a name="321"></a>321</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="322"></a>322</td><td></td><td></td><td></td><td></td><td class="s">    }</td></tr>
<tr><td class="h"><a name="323"></a>323</td><td></td><td></td><td></td><td></td><td class="s">    elsif ($code == &amp;HTTP::Status::RC_UNAUTHORIZED ||</td></tr>
<tr><td class="h"><a name="324"></a>324</td><td></td><td></td><td></td><td></td><td class="s">             $code == &amp;HTTP::Status::RC_PROXY_AUTHENTICATION_REQUIRED</td></tr>
<tr><td class="h"><a name="325"></a>325</td><td></td><td></td><td></td><td></td><td class="s">            )</td></tr>
<tr><td class="h"><a name="326"></a>326</td><td></td><td></td><td></td><td></td><td class="s">    {</td></tr>
<tr><td class="h"><a name="327"></a>327</td><td></td><td></td><td></td><td></td><td class="s">        my $proxy = ($code == &amp;HTTP::Status::RC_PROXY_AUTHENTICATION_REQUIRED);</td></tr>
<tr><td class="h"><a name="328"></a>328</td><td></td><td></td><td></td><td></td><td class="s">        my $ch_header = $proxy ?  &quot;Proxy-Authenticate&quot; : &quot;WWW-Authenticate&quot;;</td></tr>
<tr><td class="h"><a name="329"></a>329</td><td></td><td></td><td></td><td></td><td class="s">        my @challenge = $response-&gt;header($ch_header);</td></tr>
<tr><td class="h"><a name="330"></a>330</td><td></td><td></td><td></td><td></td><td class="s">        unless (@challenge) {</td></tr>
<tr><td class="h"><a name="331"></a>331</td><td></td><td></td><td></td><td></td><td class="s">            $response-&gt;header(&quot;Client-Warning&quot; =&gt; </td></tr>
<tr><td class="h"><a name="332"></a>332</td><td></td><td></td><td></td><td></td><td class="s">                              &quot;Missing Authenticate header&quot;);</td></tr>
<tr><td class="h"><a name="333"></a>333</td><td></td><td></td><td></td><td></td><td class="s">            return $response;</td></tr>
<tr><td class="h"><a name="334"></a>334</td><td></td><td></td><td></td><td></td><td class="s">        }</td></tr>
<tr><td class="h"><a name="335"></a>335</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="336"></a>336</td><td></td><td></td><td></td><td></td><td class="s">        require HTTP::Headers::Util;</td></tr>
<tr><td class="h"><a name="337"></a>337</td><td></td><td></td><td></td><td></td><td class="s">        CHALLENGE: for my $challenge (@challenge) {</td></tr>
<tr><td class="h"><a name="338"></a>338</td><td></td><td></td><td></td><td></td><td class="s">            $challenge =~ tr/,/;/;  # &quot;,&quot; is used to separate auth-params!!</td></tr>
<tr><td class="h"><a name="339"></a>339</td><td></td><td></td><td></td><td></td><td class="s">            ($challenge) = HTTP::Headers::Util::split_header_words($challenge);</td></tr>
<tr><td class="h"><a name="340"></a>340</td><td></td><td></td><td></td><td></td><td class="s">            my $scheme = shift(@$challenge);</td></tr>
<tr><td class="h"><a name="341"></a>341</td><td></td><td></td><td></td><td></td><td class="s">            shift(@$challenge); # no value</td></tr>
<tr><td class="h"><a name="342"></a>342</td><td></td><td></td><td></td><td></td><td class="s">            $challenge = { @$challenge };  # make rest into a hash</td></tr>
<tr><td class="h"><a name="343"></a>343</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="344"></a>344</td><td></td><td></td><td></td><td></td><td class="s">            unless ($scheme =~ /^([a-z]+(?:-[a-z]+)*)$/) {</td></tr>
<tr><td class="h"><a name="345"></a>345</td><td></td><td></td><td></td><td></td><td class="s">                $response-&gt;header(&quot;Client-Warning&quot; =&gt; </td></tr>
<tr><td class="h"><a name="346"></a>346</td><td></td><td></td><td></td><td></td><td class="s">                                  &quot;Bad authentication scheme '$scheme'&quot;);</td></tr>
<tr><td class="h"><a name="347"></a>347</td><td></td><td></td><td></td><td></td><td class="s">                return $response;</td></tr>
<tr><td class="h"><a name="348"></a>348</td><td></td><td></td><td></td><td></td><td class="s">            }</td></tr>
<tr><td class="h"><a name="349"></a>349</td><td></td><td></td><td></td><td></td><td class="s">            $scheme = $1;  # untainted now</td></tr>
<tr><td class="h"><a name="350"></a>350</td><td></td><td></td><td></td><td></td><td class="s">            my $class = &quot;LWP::Authen::\u$scheme&quot;;</td></tr>
<tr><td class="h"><a name="351"></a>351</td><td></td><td></td><td></td><td></td><td class="s">            $class =~ s/-/_/g;</td></tr>
<tr><td class="h"><a name="352"></a>352</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="353"></a>353</td><td class="c3">3</td><td class="c0"><span title="Avg 1.07ms">3.20ms</span></td><td class="c3">2</td><td class="c3">31&micro;s</td><td class="s"><div class="calls"><div class="calls_in"># spent 19&micro;s (8+12) within LWP::UserAgent::BEGIN@353 which was called
#    once (8&micro;s+12&micro;s) by SimpleDB::Client::BEGIN@49 at <a href="LWP-UserAgent-pm-block.html#353">line 353</a></div></div>            no strict 'refs';<div class="calls"><div class="calls_out">            # spent    19&micro;s making 1 call to <a href="LWP-UserAgent-pm-block.html#353">LWP::UserAgent::BEGIN@353</a>
            # spent    12&micro;s making 1 call to <a href="strict-pm-block.html#39">strict::unimport</a></div></div></td></tr>
<tr><td class="h"><a name="354"></a>354</td><td></td><td></td><td></td><td></td><td class="s">            unless (%{&quot;$class\::&quot;}) {</td></tr>
<tr><td class="h"><a name="355"></a>355</td><td></td><td></td><td></td><td></td><td class="s">                # try to load it</td></tr>
<tr><td class="h"><a name="356"></a>356</td><td></td><td></td><td></td><td></td><td class="s">                eval &quot;require $class&quot;;</td></tr>
<tr><td class="h"><a name="357"></a>357</td><td></td><td></td><td></td><td></td><td class="s">                if ($@) {</td></tr>
<tr><td class="h"><a name="358"></a>358</td><td></td><td></td><td></td><td></td><td class="s">                    if ($@ =~ /^Can\'t locate/) {</td></tr>
<tr><td class="h"><a name="359"></a>359</td><td></td><td></td><td></td><td></td><td class="s">                        $response-&gt;header(&quot;Client-Warning&quot; =&gt;</td></tr>
<tr><td class="h"><a name="360"></a>360</td><td></td><td></td><td></td><td></td><td class="s">                                          &quot;Unsupported authentication scheme '$scheme'&quot;);</td></tr>
<tr><td class="h"><a name="361"></a>361</td><td></td><td></td><td></td><td></td><td class="s">                    }</td></tr>
<tr><td class="h"><a name="362"></a>362</td><td></td><td></td><td></td><td></td><td class="s">                    else {</td></tr>
<tr><td class="h"><a name="363"></a>363</td><td></td><td></td><td></td><td></td><td class="s">                        $response-&gt;header(&quot;Client-Warning&quot; =&gt; $@);</td></tr>
<tr><td class="h"><a name="364"></a>364</td><td></td><td></td><td></td><td></td><td class="s">                    }</td></tr>
<tr><td class="h"><a name="365"></a>365</td><td></td><td></td><td></td><td></td><td class="s">                    next CHALLENGE;</td></tr>
<tr><td class="h"><a name="366"></a>366</td><td></td><td></td><td></td><td></td><td class="s">                }</td></tr>
<tr><td class="h"><a name="367"></a>367</td><td></td><td></td><td></td><td></td><td class="s">            }</td></tr>
<tr><td class="h"><a name="368"></a>368</td><td></td><td></td><td></td><td></td><td class="s">            unless ($class-&gt;can(&quot;authenticate&quot;)) {</td></tr>
<tr><td class="h"><a name="369"></a>369</td><td></td><td></td><td></td><td></td><td class="s">                $response-&gt;header(&quot;Client-Warning&quot; =&gt;</td></tr>
<tr><td class="h"><a name="370"></a>370</td><td></td><td></td><td></td><td></td><td class="s">                                  &quot;Unsupported authentication scheme '$scheme'&quot;);</td></tr>
<tr><td class="h"><a name="371"></a>371</td><td></td><td></td><td></td><td></td><td class="s">                next CHALLENGE;</td></tr>
<tr><td class="h"><a name="372"></a>372</td><td></td><td></td><td></td><td></td><td class="s">            }</td></tr>
<tr><td class="h"><a name="373"></a>373</td><td></td><td></td><td></td><td></td><td class="s">            return $class-&gt;authenticate($self, $proxy, $challenge, $response,</td></tr>
<tr><td class="h"><a name="374"></a>374</td><td></td><td></td><td></td><td></td><td class="s">                                        $request, $arg, $size);</td></tr>
<tr><td class="h"><a name="375"></a>375</td><td></td><td></td><td></td><td></td><td class="s">        }</td></tr>
<tr><td class="h"><a name="376"></a>376</td><td></td><td></td><td></td><td></td><td class="s">        return $response;</td></tr>
<tr><td class="h"><a name="377"></a>377</td><td></td><td></td><td></td><td></td><td class="s">    }</td></tr>
<tr><td class="h"><a name="378"></a>378</td><td></td><td></td><td></td><td></td><td class="s">    return $response;</td></tr>
<tr><td class="h"><a name="379"></a>379</td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h"><a name="380"></a>380</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="381"></a>381</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="382"></a>382</td><td></td><td></td><td></td><td></td><td class="s">#</td></tr>
<tr><td class="h"><a name="383"></a>383</td><td></td><td></td><td></td><td></td><td class="s"># Now the shortcuts...</td></tr>
<tr><td class="h"><a name="384"></a>384</td><td></td><td></td><td></td><td></td><td class="s">#</td></tr>
<tr><td class="h"><a name="385"></a>385</td><td></td><td></td><td></td><td></td><td class="s">sub get {</td></tr>
<tr><td class="h"><a name="386"></a>386</td><td></td><td></td><td></td><td></td><td class="s">    require HTTP::Request::Common;</td></tr>
<tr><td class="h"><a name="387"></a>387</td><td></td><td></td><td></td><td></td><td class="s">    my($self, @parameters) = @_;</td></tr>
<tr><td class="h"><a name="388"></a>388</td><td></td><td></td><td></td><td></td><td class="s">    my @suff = $self-&gt;_process_colonic_headers(\@parameters,1);</td></tr>
<tr><td class="h"><a name="389"></a>389</td><td></td><td></td><td></td><td></td><td class="s">    return $self-&gt;request( HTTP::Request::Common::GET( @parameters ), @suff );</td></tr>
<tr><td class="h"><a name="390"></a>390</td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h"><a name="391"></a>391</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="392"></a>392</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="393"></a>393</td><td></td><td></td><td></td><td></td><td class="s">sub post {</td></tr>
<tr><td class="h"><a name="394"></a>394</td><td></td><td></td><td></td><td></td><td class="s">    require HTTP::Request::Common;</td></tr>
<tr><td class="h"><a name="395"></a>395</td><td></td><td></td><td></td><td></td><td class="s">    my($self, @parameters) = @_;</td></tr>
<tr><td class="h"><a name="396"></a>396</td><td></td><td></td><td></td><td></td><td class="s">    my @suff = $self-&gt;_process_colonic_headers(\@parameters, (ref($parameters[1]) ? 2 : 1));</td></tr>
<tr><td class="h"><a name="397"></a>397</td><td></td><td></td><td></td><td></td><td class="s">    return $self-&gt;request( HTTP::Request::Common::POST( @parameters ), @suff );</td></tr>
<tr><td class="h"><a name="398"></a>398</td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h"><a name="399"></a>399</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="400"></a>400</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="401"></a>401</td><td></td><td></td><td></td><td></td><td class="s">sub head {</td></tr>
<tr><td class="h"><a name="402"></a>402</td><td></td><td></td><td></td><td></td><td class="s">    require HTTP::Request::Common;</td></tr>
<tr><td class="h"><a name="403"></a>403</td><td></td><td></td><td></td><td></td><td class="s">    my($self, @parameters) = @_;</td></tr>
<tr><td class="h"><a name="404"></a>404</td><td></td><td></td><td></td><td></td><td class="s">    my @suff = $self-&gt;_process_colonic_headers(\@parameters,1);</td></tr>
<tr><td class="h"><a name="405"></a>405</td><td></td><td></td><td></td><td></td><td class="s">    return $self-&gt;request( HTTP::Request::Common::HEAD( @parameters ), @suff );</td></tr>
<tr><td class="h"><a name="406"></a>406</td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h"><a name="407"></a>407</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="408"></a>408</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="409"></a>409</td><td></td><td></td><td></td><td></td><td class="s">sub _process_colonic_headers {</td></tr>
<tr><td class="h"><a name="410"></a>410</td><td></td><td></td><td></td><td></td><td class="s">    # Process :content_cb / :content_file / :read_size_hint headers.</td></tr>
<tr><td class="h"><a name="411"></a>411</td><td></td><td></td><td></td><td></td><td class="s">    my($self, $args, $start_index) = @_;</td></tr>
<tr><td class="h"><a name="412"></a>412</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="413"></a>413</td><td></td><td></td><td></td><td></td><td class="s">    my($arg, $size);</td></tr>
<tr><td class="h"><a name="414"></a>414</td><td></td><td></td><td></td><td></td><td class="s">    for(my $i = $start_index; $i &lt; @$args; $i += 2) {</td></tr>
<tr><td class="h"><a name="415"></a>415</td><td></td><td></td><td></td><td></td><td class="s">        next unless defined $args-&gt;[$i];</td></tr>
<tr><td class="h"><a name="416"></a>416</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="417"></a>417</td><td></td><td></td><td></td><td></td><td class="s">        #printf &quot;Considering %s =&gt; %s\n&quot;, $args-&gt;[$i], $args-&gt;[$i + 1];</td></tr>
<tr><td class="h"><a name="418"></a>418</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="419"></a>419</td><td></td><td></td><td></td><td></td><td class="s">        if($args-&gt;[$i] eq ':content_cb') {</td></tr>
<tr><td class="h"><a name="420"></a>420</td><td></td><td></td><td></td><td></td><td class="s">            # Some sanity-checking...</td></tr>
<tr><td class="h"><a name="421"></a>421</td><td></td><td></td><td></td><td></td><td class="s">            $arg = $args-&gt;[$i + 1];</td></tr>
<tr><td class="h"><a name="422"></a>422</td><td></td><td></td><td></td><td></td><td class="s">            Carp::croak(&quot;A :content_cb value can't be undef&quot;) unless defined $arg;</td></tr>
<tr><td class="h"><a name="423"></a>423</td><td></td><td></td><td></td><td></td><td class="s">            Carp::croak(&quot;A :content_cb value must be a coderef&quot;)</td></tr>
<tr><td class="h"><a name="424"></a>424</td><td></td><td></td><td></td><td></td><td class="s">                unless ref $arg and UNIVERSAL::isa($arg, 'CODE');</td></tr>
<tr><td class="h"><a name="425"></a>425</td><td></td><td></td><td></td><td></td><td class="s">            </td></tr>
<tr><td class="h"><a name="426"></a>426</td><td></td><td></td><td></td><td></td><td class="s">        }</td></tr>
<tr><td class="h"><a name="427"></a>427</td><td></td><td></td><td></td><td></td><td class="s">        elsif ($args-&gt;[$i] eq ':content_file') {</td></tr>
<tr><td class="h"><a name="428"></a>428</td><td></td><td></td><td></td><td></td><td class="s">            $arg = $args-&gt;[$i + 1];</td></tr>
<tr><td class="h"><a name="429"></a>429</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="430"></a>430</td><td></td><td></td><td></td><td></td><td class="s">            # Some sanity-checking...</td></tr>
<tr><td class="h"><a name="431"></a>431</td><td></td><td></td><td></td><td></td><td class="s">            Carp::croak(&quot;A :content_file value can't be undef&quot;)</td></tr>
<tr><td class="h"><a name="432"></a>432</td><td></td><td></td><td></td><td></td><td class="s">                unless defined $arg;</td></tr>
<tr><td class="h"><a name="433"></a>433</td><td></td><td></td><td></td><td></td><td class="s">            Carp::croak(&quot;A :content_file value can't be a reference&quot;)</td></tr>
<tr><td class="h"><a name="434"></a>434</td><td></td><td></td><td></td><td></td><td class="s">                if ref $arg;</td></tr>
<tr><td class="h"><a name="435"></a>435</td><td></td><td></td><td></td><td></td><td class="s">            Carp::croak(&quot;A :content_file value can't be \&quot;\&quot;&quot;)</td></tr>
<tr><td class="h"><a name="436"></a>436</td><td></td><td></td><td></td><td></td><td class="s">                unless length $arg;</td></tr>
<tr><td class="h"><a name="437"></a>437</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="438"></a>438</td><td></td><td></td><td></td><td></td><td class="s">        }</td></tr>
<tr><td class="h"><a name="439"></a>439</td><td></td><td></td><td></td><td></td><td class="s">        elsif ($args-&gt;[$i] eq ':read_size_hint') {</td></tr>
<tr><td class="h"><a name="440"></a>440</td><td></td><td></td><td></td><td></td><td class="s">            $size = $args-&gt;[$i + 1];</td></tr>
<tr><td class="h"><a name="441"></a>441</td><td></td><td></td><td></td><td></td><td class="s">            # Bother checking it?</td></tr>
<tr><td class="h"><a name="442"></a>442</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="443"></a>443</td><td></td><td></td><td></td><td></td><td class="s">        }</td></tr>
<tr><td class="h"><a name="444"></a>444</td><td></td><td></td><td></td><td></td><td class="s">        else {</td></tr>
<tr><td class="h"><a name="445"></a>445</td><td></td><td></td><td></td><td></td><td class="s">            next;</td></tr>
<tr><td class="h"><a name="446"></a>446</td><td></td><td></td><td></td><td></td><td class="s">        }</td></tr>
<tr><td class="h"><a name="447"></a>447</td><td></td><td></td><td></td><td></td><td class="s">        splice @$args, $i, 2;</td></tr>
<tr><td class="h"><a name="448"></a>448</td><td></td><td></td><td></td><td></td><td class="s">        $i -= 2;</td></tr>
<tr><td class="h"><a name="449"></a>449</td><td></td><td></td><td></td><td></td><td class="s">    }</td></tr>
<tr><td class="h"><a name="450"></a>450</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="451"></a>451</td><td></td><td></td><td></td><td></td><td class="s">    # And return a suitable suffix-list for request(REQ,...)</td></tr>
<tr><td class="h"><a name="452"></a>452</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="453"></a>453</td><td></td><td></td><td></td><td></td><td class="s">    return             unless defined $arg;</td></tr>
<tr><td class="h"><a name="454"></a>454</td><td></td><td></td><td></td><td></td><td class="s">    return $arg, $size if     defined $size;</td></tr>
<tr><td class="h"><a name="455"></a>455</td><td></td><td></td><td></td><td></td><td class="s">    return $arg;</td></tr>
<tr><td class="h"><a name="456"></a>456</td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h"><a name="457"></a>457</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="458"></a>458</td><td class="c3">1</td><td class="c3"><span title="Avg 3&micro;s">3&micro;s</span></td><td></td><td></td><td class="s">my @ANI = qw(- \ | /);</td></tr>
<tr><td class="h"><a name="459"></a>459</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="460"></a>460</td><td></td><td></td><td></td><td></td><td class="s"><div class="calls"><div class="calls_in"># spent 35&micro;s within LWP::UserAgent::progress which was called 10 times, avg 3&micro;s/call:
# 4 times (18&micro;s+0s) by LWP::Protocol::collect at <a href="LWP-Protocol-pm-block.html#157">line 157 of LWP/Protocol.pm</a>, avg 5&micro;s/call
# 3 times (9&micro;s+0s) by LWP::UserAgent::send_request at <a href="LWP-UserAgent-pm-block.html#124">line 124</a>, avg 3&micro;s/call
# 3 times (7&micro;s+0s) by LWP::UserAgent::send_request at <a href="LWP-UserAgent-pm-block.html#200">line 200</a>, avg 2&micro;s/call</div></div>sub progress {</td></tr>
<tr><td class="h"><a name="461"></a>461</td><td class="c0">20</td><td class="c1"><span title="Avg 3&micro;s">60&micro;s</span></td><td></td><td></td><td class="s">    my($self, $status, $m) = @_;</td></tr>
<tr><td class="h"><a name="462"></a>462</td><td></td><td></td><td></td><td></td><td class="s">    return unless $self-&gt;{show_progress};</td></tr>
<tr><td class="h"><a name="463"></a>463</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="464"></a>464</td><td></td><td></td><td></td><td></td><td class="s">    local($,, $\);</td></tr>
<tr><td class="h"><a name="465"></a>465</td><td></td><td></td><td></td><td></td><td class="s">    if ($status eq &quot;begin&quot;) {</td></tr>
<tr><td class="h"><a name="466"></a>466</td><td></td><td></td><td></td><td></td><td class="s">        print STDERR &quot;** &quot;, $m-&gt;method, &quot; &quot;, $m-&gt;uri, &quot; ==&gt; &quot;;</td></tr>
<tr><td class="h"><a name="467"></a>467</td><td></td><td></td><td></td><td></td><td class="s">        $self-&gt;{progress_start} = time;</td></tr>
<tr><td class="h"><a name="468"></a>468</td><td></td><td></td><td></td><td></td><td class="s">        $self-&gt;{progress_lastp} = &quot;&quot;;</td></tr>
<tr><td class="h"><a name="469"></a>469</td><td></td><td></td><td></td><td></td><td class="s">        $self-&gt;{progress_ani} = 0;</td></tr>
<tr><td class="h"><a name="470"></a>470</td><td></td><td></td><td></td><td></td><td class="s">    }</td></tr>
<tr><td class="h"><a name="471"></a>471</td><td></td><td></td><td></td><td></td><td class="s">    elsif ($status eq &quot;end&quot;) {</td></tr>
<tr><td class="h"><a name="472"></a>472</td><td></td><td></td><td></td><td></td><td class="s">        delete $self-&gt;{progress_lastp};</td></tr>
<tr><td class="h"><a name="473"></a>473</td><td></td><td></td><td></td><td></td><td class="s">        delete $self-&gt;{progress_ani};</td></tr>
<tr><td class="h"><a name="474"></a>474</td><td></td><td></td><td></td><td></td><td class="s">        print STDERR $m-&gt;status_line;</td></tr>
<tr><td class="h"><a name="475"></a>475</td><td></td><td></td><td></td><td></td><td class="s">        my $t = time - delete $self-&gt;{progress_start};</td></tr>
<tr><td class="h"><a name="476"></a>476</td><td></td><td></td><td></td><td></td><td class="s">        print STDERR &quot; (${t}s)&quot; if $t;</td></tr>
<tr><td class="h"><a name="477"></a>477</td><td></td><td></td><td></td><td></td><td class="s">        print STDERR &quot;\n&quot;;</td></tr>
<tr><td class="h"><a name="478"></a>478</td><td></td><td></td><td></td><td></td><td class="s">    }</td></tr>
<tr><td class="h"><a name="479"></a>479</td><td></td><td></td><td></td><td></td><td class="s">    elsif ($status eq &quot;tick&quot;) {</td></tr>
<tr><td class="h"><a name="480"></a>480</td><td></td><td></td><td></td><td></td><td class="s">        print STDERR &quot;$ANI[$self-&gt;{progress_ani}++]\b&quot;;</td></tr>
<tr><td class="h"><a name="481"></a>481</td><td></td><td></td><td></td><td></td><td class="s">        $self-&gt;{progress_ani} %= @ANI;</td></tr>
<tr><td class="h"><a name="482"></a>482</td><td></td><td></td><td></td><td></td><td class="s">    }</td></tr>
<tr><td class="h"><a name="483"></a>483</td><td></td><td></td><td></td><td></td><td class="s">    else {</td></tr>
<tr><td class="h"><a name="484"></a>484</td><td></td><td></td><td></td><td></td><td class="s">        my $p = sprintf &quot;%3.0f%%&quot;, $status * 100;</td></tr>
<tr><td class="h"><a name="485"></a>485</td><td></td><td></td><td></td><td></td><td class="s">        return if $p eq $self-&gt;{progress_lastp};</td></tr>
<tr><td class="h"><a name="486"></a>486</td><td></td><td></td><td></td><td></td><td class="s">        print STDERR &quot;$p\b\b\b\b&quot;;</td></tr>
<tr><td class="h"><a name="487"></a>487</td><td></td><td></td><td></td><td></td><td class="s">        $self-&gt;{progress_lastp} = $p;</td></tr>
<tr><td class="h"><a name="488"></a>488</td><td></td><td></td><td></td><td></td><td class="s">    }</td></tr>
<tr><td class="h"><a name="489"></a>489</td><td></td><td></td><td></td><td></td><td class="s">    STDERR-&gt;flush;</td></tr>
<tr><td class="h"><a name="490"></a>490</td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h"><a name="491"></a>491</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="492"></a>492</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="493"></a>493</td><td></td><td></td><td></td><td></td><td class="s">#</td></tr>
<tr><td class="h"><a name="494"></a>494</td><td></td><td></td><td></td><td></td><td class="s"># This whole allow/forbid thing is based on man 1 at's way of doing things.</td></tr>
<tr><td class="h"><a name="495"></a>495</td><td></td><td></td><td></td><td></td><td class="s">#</td></tr>
<tr><td class="h"><a name="496"></a>496</td><td></td><td></td><td></td><td></td><td class="s">sub is_protocol_supported</td></tr>
<tr><td class="h"><a name="497"></a>497</td><td></td><td></td><td></td><td></td><td class="s">{</td></tr>
<tr><td class="h"><a name="498"></a>498</td><td></td><td></td><td></td><td></td><td class="s">    my($self, $scheme) = @_;</td></tr>
<tr><td class="h"><a name="499"></a>499</td><td></td><td></td><td></td><td></td><td class="s">    if (ref $scheme) {</td></tr>
<tr><td class="h"><a name="500"></a>500</td><td></td><td></td><td></td><td></td><td class="s">        # assume we got a reference to an URI object</td></tr>
<tr><td class="h"><a name="501"></a>501</td><td></td><td></td><td></td><td></td><td class="s">        $scheme = $scheme-&gt;scheme;</td></tr>
<tr><td class="h"><a name="502"></a>502</td><td></td><td></td><td></td><td></td><td class="s">    }</td></tr>
<tr><td class="h"><a name="503"></a>503</td><td></td><td></td><td></td><td></td><td class="s">    else {</td></tr>
<tr><td class="h"><a name="504"></a>504</td><td></td><td></td><td></td><td></td><td class="s">        Carp::croak(&quot;Illegal scheme '$scheme' passed to is_protocol_supported&quot;)</td></tr>
<tr><td class="h"><a name="505"></a>505</td><td></td><td></td><td></td><td></td><td class="s">            if $scheme =~ /\W/;</td></tr>
<tr><td class="h"><a name="506"></a>506</td><td></td><td></td><td></td><td></td><td class="s">        $scheme = lc $scheme;</td></tr>
<tr><td class="h"><a name="507"></a>507</td><td></td><td></td><td></td><td></td><td class="s">    }</td></tr>
<tr><td class="h"><a name="508"></a>508</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="509"></a>509</td><td></td><td></td><td></td><td></td><td class="s">    my $x;</td></tr>
<tr><td class="h"><a name="510"></a>510</td><td></td><td></td><td></td><td></td><td class="s">    if(ref($self) and $x       = $self-&gt;protocols_allowed) {</td></tr>
<tr><td class="h"><a name="511"></a>511</td><td></td><td></td><td></td><td></td><td class="s">      return 0 unless grep lc($_) eq $scheme, @$x;</td></tr>
<tr><td class="h"><a name="512"></a>512</td><td></td><td></td><td></td><td></td><td class="s">    }</td></tr>
<tr><td class="h"><a name="513"></a>513</td><td></td><td></td><td></td><td></td><td class="s">    elsif (ref($self) and $x = $self-&gt;protocols_forbidden) {</td></tr>
<tr><td class="h"><a name="514"></a>514</td><td></td><td></td><td></td><td></td><td class="s">      return 0 if grep lc($_) eq $scheme, @$x;</td></tr>
<tr><td class="h"><a name="515"></a>515</td><td></td><td></td><td></td><td></td><td class="s">    }</td></tr>
<tr><td class="h"><a name="516"></a>516</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="517"></a>517</td><td></td><td></td><td></td><td></td><td class="s">    local($SIG{__DIE__});  # protect against user defined die handlers</td></tr>
<tr><td class="h"><a name="518"></a>518</td><td></td><td></td><td></td><td></td><td class="s">    $x = LWP::Protocol::implementor($scheme);</td></tr>
<tr><td class="h"><a name="519"></a>519</td><td></td><td></td><td></td><td></td><td class="s">    return 1 if $x and $x ne 'LWP::Protocol::nogo';</td></tr>
<tr><td class="h"><a name="520"></a>520</td><td></td><td></td><td></td><td></td><td class="s">    return 0;</td></tr>
<tr><td class="h"><a name="521"></a>521</td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h"><a name="522"></a>522</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="523"></a>523</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="524"></a>524</td><td class="c3">3</td><td class="c3"><span title="Avg 8&micro;s">23&micro;s</span></td><td class="c1">3</td><td class="c3">14&micro;s</td><td class="s"><div class="calls"><div class="calls_in"># spent 41&micro;s (26+15) within LWP::UserAgent::protocols_allowed which was called 3 times, avg 14&micro;s/call:
# 3 times (26&micro;s+15&micro;s) by LWP::UserAgent::send_request at <a href="LWP-UserAgent-pm-block.html#135">line 135</a>, avg 14&micro;s/call</div></div>sub protocols_allowed      { shift-&gt;_elem('protocols_allowed'    , @_) }<div class="calls"><div class="calls_out"># spent    14&micro;s making 3 calls to <a href="LWP-MemberMixin-pm-block.html#4">LWP::MemberMixin::_elem</a>, avg 5&micro;s/call</div></div></td></tr>
<tr><td class="h"><a name="525"></a>525</td><td class="c3">3</td><td class="c3"><span title="Avg 4&micro;s">14&micro;s</span></td><td class="c1">3</td><td class="c3">7&micro;s</td><td class="s"><div class="calls"><div class="calls_in"># spent 22&micro;s (15+7) within LWP::UserAgent::protocols_forbidden which was called 3 times, avg 8&micro;s/call:
# 3 times (15&micro;s+7&micro;s) by LWP::UserAgent::send_request at <a href="LWP-UserAgent-pm-block.html#135">line 135</a>, avg 8&micro;s/call</div></div>sub protocols_forbidden    { shift-&gt;_elem('protocols_forbidden'  , @_) }<div class="calls"><div class="calls_out"># spent     7&micro;s making 3 calls to <a href="LWP-MemberMixin-pm-block.html#4">LWP::MemberMixin::_elem</a>, avg 2&micro;s/call</div></div></td></tr>
<tr><td class="h"><a name="526"></a>526</td><td></td><td></td><td></td><td></td><td class="s">sub requests_redirectable  { shift-&gt;_elem('requests_redirectable', @_) }</td></tr>
<tr><td class="h"><a name="527"></a>527</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="528"></a>528</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="529"></a>529</td><td></td><td></td><td></td><td></td><td class="s">sub redirect_ok</td></tr>
<tr><td class="h"><a name="530"></a>530</td><td></td><td></td><td></td><td></td><td class="s">{</td></tr>
<tr><td class="h"><a name="531"></a>531</td><td></td><td></td><td></td><td></td><td class="s">    # RFC 2616, section 10.3.2 and 10.3.3 say:</td></tr>
<tr><td class="h"><a name="532"></a>532</td><td></td><td></td><td></td><td></td><td class="s">    #  If the 30[12] status code is received in response to a request other</td></tr>
<tr><td class="h"><a name="533"></a>533</td><td></td><td></td><td></td><td></td><td class="s">    #  than GET or HEAD, the user agent MUST NOT automatically redirect the</td></tr>
<tr><td class="h"><a name="534"></a>534</td><td></td><td></td><td></td><td></td><td class="s">    #  request unless it can be confirmed by the user, since this might</td></tr>
<tr><td class="h"><a name="535"></a>535</td><td></td><td></td><td></td><td></td><td class="s">    #  change the conditions under which the request was issued.</td></tr>
<tr><td class="h"><a name="536"></a>536</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="537"></a>537</td><td></td><td></td><td></td><td></td><td class="s">    # Note that this routine used to be just:</td></tr>
<tr><td class="h"><a name="538"></a>538</td><td></td><td></td><td></td><td></td><td class="s">    #  return 0 if $_[1]-&gt;method eq &quot;POST&quot;;  return 1;</td></tr>
<tr><td class="h"><a name="539"></a>539</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="540"></a>540</td><td></td><td></td><td></td><td></td><td class="s">    my($self, $new_request, $response) = @_;</td></tr>
<tr><td class="h"><a name="541"></a>541</td><td></td><td></td><td></td><td></td><td class="s">    my $method = $response-&gt;request-&gt;method;</td></tr>
<tr><td class="h"><a name="542"></a>542</td><td></td><td></td><td></td><td></td><td class="s">    return 0 unless grep $_ eq $method,</td></tr>
<tr><td class="h"><a name="543"></a>543</td><td></td><td></td><td></td><td></td><td class="s">      @{ $self-&gt;requests_redirectable || [] };</td></tr>
<tr><td class="h"><a name="544"></a>544</td><td></td><td></td><td></td><td></td><td class="s">    </td></tr>
<tr><td class="h"><a name="545"></a>545</td><td></td><td></td><td></td><td></td><td class="s">    if ($new_request-&gt;uri-&gt;scheme eq 'file') {</td></tr>
<tr><td class="h"><a name="546"></a>546</td><td></td><td></td><td></td><td></td><td class="s">      $response-&gt;header(&quot;Client-Warning&quot; =&gt;</td></tr>
<tr><td class="h"><a name="547"></a>547</td><td></td><td></td><td></td><td></td><td class="s">                        &quot;Can't redirect to a file:// URL!&quot;);</td></tr>
<tr><td class="h"><a name="548"></a>548</td><td></td><td></td><td></td><td></td><td class="s">      return 0;</td></tr>
<tr><td class="h"><a name="549"></a>549</td><td></td><td></td><td></td><td></td><td class="s">    }</td></tr>
<tr><td class="h"><a name="550"></a>550</td><td></td><td></td><td></td><td></td><td class="s">    </td></tr>
<tr><td class="h"><a name="551"></a>551</td><td></td><td></td><td></td><td></td><td class="s">    # Otherwise it's apparently okay...</td></tr>
<tr><td class="h"><a name="552"></a>552</td><td></td><td></td><td></td><td></td><td class="s">    return 1;</td></tr>
<tr><td class="h"><a name="553"></a>553</td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h"><a name="554"></a>554</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="555"></a>555</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="556"></a>556</td><td></td><td></td><td></td><td></td><td class="s">sub credentials</td></tr>
<tr><td class="h"><a name="557"></a>557</td><td></td><td></td><td></td><td></td><td class="s">{</td></tr>
<tr><td class="h"><a name="558"></a>558</td><td></td><td></td><td></td><td></td><td class="s">    my $self = shift;</td></tr>
<tr><td class="h"><a name="559"></a>559</td><td></td><td></td><td></td><td></td><td class="s">    my $netloc = lc(shift);</td></tr>
<tr><td class="h"><a name="560"></a>560</td><td></td><td></td><td></td><td></td><td class="s">    my $realm = shift || &quot;&quot;;</td></tr>
<tr><td class="h"><a name="561"></a>561</td><td></td><td></td><td></td><td></td><td class="s">    my $old = $self-&gt;{basic_authentication}{$netloc}{$realm};</td></tr>
<tr><td class="h"><a name="562"></a>562</td><td></td><td></td><td></td><td></td><td class="s">    if (@_) {</td></tr>
<tr><td class="h"><a name="563"></a>563</td><td></td><td></td><td></td><td></td><td class="s">        $self-&gt;{basic_authentication}{$netloc}{$realm} = [@_];</td></tr>
<tr><td class="h"><a name="564"></a>564</td><td></td><td></td><td></td><td></td><td class="s">    }</td></tr>
<tr><td class="h"><a name="565"></a>565</td><td></td><td></td><td></td><td></td><td class="s">    return unless $old;</td></tr>
<tr><td class="h"><a name="566"></a>566</td><td></td><td></td><td></td><td></td><td class="s">    return @$old if wantarray;</td></tr>
<tr><td class="h"><a name="567"></a>567</td><td></td><td></td><td></td><td></td><td class="s">    return join(&quot;:&quot;, @$old);</td></tr>
<tr><td class="h"><a name="568"></a>568</td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h"><a name="569"></a>569</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="570"></a>570</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="571"></a>571</td><td></td><td></td><td></td><td></td><td class="s">sub get_basic_credentials</td></tr>
<tr><td class="h"><a name="572"></a>572</td><td></td><td></td><td></td><td></td><td class="s">{</td></tr>
<tr><td class="h"><a name="573"></a>573</td><td></td><td></td><td></td><td></td><td class="s">    my($self, $realm, $uri, $proxy) = @_;</td></tr>
<tr><td class="h"><a name="574"></a>574</td><td></td><td></td><td></td><td></td><td class="s">    return if $proxy;</td></tr>
<tr><td class="h"><a name="575"></a>575</td><td></td><td></td><td></td><td></td><td class="s">    return $self-&gt;credentials($uri-&gt;host_port, $realm);</td></tr>
<tr><td class="h"><a name="576"></a>576</td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h"><a name="577"></a>577</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="578"></a>578</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="579"></a>579</td><td></td><td></td><td></td><td></td><td class="s">sub timeout      { shift-&gt;_elem('timeout',      @_); }</td></tr>
<tr><td class="h"><a name="580"></a>580</td><td></td><td></td><td></td><td></td><td class="s">sub local_address{ shift-&gt;_elem('local_address',@_); }</td></tr>
<tr><td class="h"><a name="581"></a>581</td><td></td><td></td><td></td><td></td><td class="s">sub max_size     { shift-&gt;_elem('max_size',     @_); }</td></tr>
<tr><td class="h"><a name="582"></a>582</td><td></td><td></td><td></td><td></td><td class="s">sub max_redirect { shift-&gt;_elem('max_redirect', @_); }</td></tr>
<tr><td class="h"><a name="583"></a>583</td><td></td><td></td><td></td><td></td><td class="s">sub show_progress{ shift-&gt;_elem('show_progress', @_); }</td></tr>
<tr><td class="h"><a name="584"></a>584</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="585"></a>585</td><td></td><td></td><td></td><td></td><td class="s"><div class="calls"><div class="calls_in"># spent 1.50ms (13&micro;s+1.49) within LWP::UserAgent::parse_head which was called
#    once (13&micro;s+1.49ms) by LWP::UserAgent::new at <a href="LWP-UserAgent-pm-block.html#101">line 101</a></div></div>sub parse_head {</td></tr>
<tr><td class="h"><a name="586"></a>586</td><td class="c3">2</td><td class="c3"><span title="Avg 750ns">2&micro;s</span></td><td></td><td></td><td class="s">    my $self = shift;</td></tr>
<tr><td class="h"><a name="587"></a>587</td><td class="c1">4</td><td class="c3"><span title="Avg 3&micro;s">12&micro;s</span></td><td></td><td></td><td class="s">    if (@_) {</td></tr>
<tr><td class="h"><a name="588"></a>588</td><td></td><td></td><td></td><td></td><td class="s">        my $flag = shift;</td></tr>
<tr><td class="h"><a name="589"></a>589</td><td></td><td></td><td></td><td></td><td class="s">        my $parser;</td></tr>
<tr><td class="h"><a name="590"></a>590</td><td></td><td></td><td></td><td></td><td class="s">        my $old = $self-&gt;set_my_handler(&quot;response_header&quot;, $flag ? sub {</td></tr>
<tr><td class="h"><a name="591"></a>591</td><td></td><td></td><td></td><td></td><td class="s">               my($response, $ua) = @_;</td></tr>
<tr><td class="h"><a name="592"></a>592</td><td></td><td></td><td></td><td></td><td class="s">               require HTML::HeadParser;</td></tr>
<tr><td class="h"><a name="593"></a>593</td><td></td><td></td><td></td><td></td><td class="s">               $parser = HTML::HeadParser-&gt;new;</td></tr>
<tr><td class="h"><a name="594"></a>594</td><td></td><td></td><td></td><td></td><td class="s">               $parser-&gt;xml_mode(1) if $response-&gt;content_is_xhtml;</td></tr>
<tr><td class="h"><a name="595"></a>595</td><td></td><td></td><td></td><td></td><td class="s">               $parser-&gt;utf8_mode(1) if $] &gt;= 5.008 &amp;&amp; $HTML::Parser::VERSION &gt;= 3.40;</td></tr>
<tr><td class="h"><a name="596"></a>596</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="597"></a>597</td><td></td><td></td><td></td><td></td><td class="s">               push(@{$response-&gt;{handlers}{response_data}}, {</td></tr>
<tr><td class="h"><a name="598"></a>598</td><td></td><td></td><td></td><td></td><td class="s">                   callback =&gt; sub {</td></tr>
<tr><td class="h"><a name="599"></a>599</td><td></td><td></td><td></td><td></td><td class="s">                       return unless $parser;</td></tr>
<tr><td class="h"><a name="600"></a>600</td><td></td><td></td><td></td><td></td><td class="s">                       unless ($parser-&gt;parse($_[3])) {</td></tr>
<tr><td class="h"><a name="601"></a>601</td><td></td><td></td><td></td><td></td><td class="s">                           my $h = $parser-&gt;header;</td></tr>
<tr><td class="h"><a name="602"></a>602</td><td></td><td></td><td></td><td></td><td class="s">                           my $r = $_[0];</td></tr>
<tr><td class="h"><a name="603"></a>603</td><td></td><td></td><td></td><td></td><td class="s">                           for my $f ($h-&gt;header_field_names) {</td></tr>
<tr><td class="h"><a name="604"></a>604</td><td></td><td></td><td></td><td></td><td class="s">                               $r-&gt;init_header($f, [$h-&gt;header($f)]);</td></tr>
<tr><td class="h"><a name="605"></a>605</td><td></td><td></td><td></td><td></td><td class="s">                           }</td></tr>
<tr><td class="h"><a name="606"></a>606</td><td></td><td></td><td></td><td></td><td class="s">                           undef($parser);</td></tr>
<tr><td class="h"><a name="607"></a>607</td><td></td><td></td><td></td><td></td><td class="s">                       }</td></tr>
<tr><td class="h"><a name="608"></a>608</td><td></td><td></td><td></td><td></td><td class="s">                   },</td></tr>
<tr><td class="h"><a name="609"></a>609</td><td></td><td></td><td></td><td></td><td class="s">               });</td></tr>
<tr><td class="h"><a name="610"></a>610</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="611"></a>611</td><td></td><td></td><td></td><td></td><td class="s">            } : undef,</td></tr>
<tr><td class="h"><a name="612"></a>612</td><td></td><td></td><td></td><td></td><td class="s">            m_media_type =&gt; &quot;html&quot;,<div class="calls"><div class="calls_out">            # spent  1.49ms making 1 call to <a href="LWP-UserAgent-pm-block.html#705">LWP::UserAgent::set_my_handler</a></div></div></td></tr>
<tr><td class="h"><a name="613"></a>613</td><td></td><td></td><td></td><td></td><td class="s">        );</td></tr>
<tr><td class="h"><a name="614"></a>614</td><td></td><td></td><td></td><td></td><td class="s">        return !!$old;</td></tr>
<tr><td class="h"><a name="615"></a>615</td><td></td><td></td><td></td><td></td><td class="s">    }</td></tr>
<tr><td class="h"><a name="616"></a>616</td><td></td><td></td><td></td><td></td><td class="s">    else {</td></tr>
<tr><td class="h"><a name="617"></a>617</td><td></td><td></td><td></td><td></td><td class="s">        return !!$self-&gt;get_my_handler(&quot;response_header&quot;);</td></tr>
<tr><td class="h"><a name="618"></a>618</td><td></td><td></td><td></td><td></td><td class="s">    }</td></tr>
<tr><td class="h"><a name="619"></a>619</td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h"><a name="620"></a>620</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="621"></a>621</td><td></td><td></td><td></td><td></td><td class="s">sub cookie_jar {</td></tr>
<tr><td class="h"><a name="622"></a>622</td><td></td><td></td><td></td><td></td><td class="s">    my $self = shift;</td></tr>
<tr><td class="h"><a name="623"></a>623</td><td></td><td></td><td></td><td></td><td class="s">    my $old = $self-&gt;{cookie_jar};</td></tr>
<tr><td class="h"><a name="624"></a>624</td><td></td><td></td><td></td><td></td><td class="s">    if (@_) {</td></tr>
<tr><td class="h"><a name="625"></a>625</td><td></td><td></td><td></td><td></td><td class="s">        my $jar = shift;</td></tr>
<tr><td class="h"><a name="626"></a>626</td><td></td><td></td><td></td><td></td><td class="s">        if (ref($jar) eq &quot;HASH&quot;) {</td></tr>
<tr><td class="h"><a name="627"></a>627</td><td></td><td></td><td></td><td></td><td class="s">            require HTTP::Cookies;</td></tr>
<tr><td class="h"><a name="628"></a>628</td><td></td><td></td><td></td><td></td><td class="s">            $jar = HTTP::Cookies-&gt;new(%$jar);</td></tr>
<tr><td class="h"><a name="629"></a>629</td><td></td><td></td><td></td><td></td><td class="s">        }</td></tr>
<tr><td class="h"><a name="630"></a>630</td><td></td><td></td><td></td><td></td><td class="s">        $self-&gt;{cookie_jar} = $jar;</td></tr>
<tr><td class="h"><a name="631"></a>631</td><td></td><td></td><td></td><td></td><td class="s">        $self-&gt;set_my_handler(&quot;request_prepare&quot;,</td></tr>
<tr><td class="h"><a name="632"></a>632</td><td></td><td></td><td></td><td></td><td class="s">            $jar ? sub { $jar-&gt;add_cookie_header($_[0]); } : undef,</td></tr>
<tr><td class="h"><a name="633"></a>633</td><td></td><td></td><td></td><td></td><td class="s">        );</td></tr>
<tr><td class="h"><a name="634"></a>634</td><td></td><td></td><td></td><td></td><td class="s">        $self-&gt;set_my_handler(&quot;response_done&quot;,</td></tr>
<tr><td class="h"><a name="635"></a>635</td><td></td><td></td><td></td><td></td><td class="s">            $jar ? sub { $jar-&gt;extract_cookies($_[0]); } : undef,</td></tr>
<tr><td class="h"><a name="636"></a>636</td><td></td><td></td><td></td><td></td><td class="s">        );</td></tr>
<tr><td class="h"><a name="637"></a>637</td><td></td><td></td><td></td><td></td><td class="s">    }</td></tr>
<tr><td class="h"><a name="638"></a>638</td><td></td><td></td><td></td><td></td><td class="s">    $old;</td></tr>
<tr><td class="h"><a name="639"></a>639</td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h"><a name="640"></a>640</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="641"></a>641</td><td></td><td></td><td></td><td></td><td class="s"><div class="calls"><div class="calls_in"># spent 22&micro;s (12+10) within LWP::UserAgent::default_headers which was called
#    once (12&micro;s+10&micro;s) by LWP::UserAgent::default_header at <a href="LWP-UserAgent-pm-block.html#654">line 654</a></div></div>sub default_headers {</td></tr>
<tr><td class="h"><a name="642"></a>642</td><td class="c1">4</td><td class="c3"><span title="Avg 3&micro;s">10&micro;s</span></td><td></td><td></td><td class="s">    my $self = shift;</td></tr>
<tr><td class="h"><a name="643"></a>643</td><td></td><td></td><td></td><td></td><td class="s">    my $old = $self-&gt;{def_headers} ||= HTTP::Headers-&gt;new;<div class="calls"><div class="calls_out">    # spent    10&micro;s making 1 call to <a href="HTTP-Headers-pm-block.html#67">HTTP::Headers::new</a></div></div></td></tr>
<tr><td class="h"><a name="644"></a>644</td><td></td><td></td><td></td><td></td><td class="s">    if (@_) {</td></tr>
<tr><td class="h"><a name="645"></a>645</td><td></td><td></td><td></td><td></td><td class="s">        Carp::croak(&quot;default_headers not set to HTTP::Headers compatible object&quot;)</td></tr>
<tr><td class="h"><a name="646"></a>646</td><td></td><td></td><td></td><td></td><td class="s">            unless @_ == 1 &amp;&amp; $_[0]-&gt;can(&quot;header_field_names&quot;);</td></tr>
<tr><td class="h"><a name="647"></a>647</td><td></td><td></td><td></td><td></td><td class="s">        $self-&gt;{def_headers} = shift;</td></tr>
<tr><td class="h"><a name="648"></a>648</td><td></td><td></td><td></td><td></td><td class="s">    }</td></tr>
<tr><td class="h"><a name="649"></a>649</td><td></td><td></td><td></td><td></td><td class="s">    return $old;</td></tr>
<tr><td class="h"><a name="650"></a>650</td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h"><a name="651"></a>651</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="652"></a>652</td><td></td><td></td><td></td><td></td><td class="s"><div class="calls"><div class="calls_in"># spent 72&micro;s (9+63) within LWP::UserAgent::default_header which was called
#    once (9&micro;s+63&micro;s) by LWP::UserAgent::agent at <a href="LWP-UserAgent-pm-block.html#669">line 669</a></div></div>sub default_header {</td></tr>
<tr><td class="h"><a name="653"></a>653</td><td class="c3">2</td><td class="c3"><span title="Avg 7&micro;s">14&micro;s</span></td><td></td><td></td><td class="s">    my $self = shift;</td></tr>
<tr><td class="h"><a name="654"></a>654</td><td></td><td></td><td></td><td></td><td class="s">    return $self-&gt;default_headers-&gt;header(@_);<div class="calls"><div class="calls_out">    # spent    42&micro;s making 1 call to <a href="HTTP-Headers-pm-block.html#76">HTTP::Headers::header</a>
    # spent    22&micro;s making 1 call to <a href="LWP-UserAgent-pm-block.html#641">LWP::UserAgent::default_headers</a></div></div></td></tr>
<tr><td class="h"><a name="655"></a>655</td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h"><a name="656"></a>656</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="657"></a>657</td><td class="c3">1</td><td class="c3"><span title="Avg 4&micro;s">4&micro;s</span></td><td></td><td></td><td class="s"><div class="calls"><div class="calls_in"># spent 3&micro;s within LWP::UserAgent::_agent which was called
#    once (3&micro;s+0s) by LWP::UserAgent::new at <a href="LWP-UserAgent-pm-block.html#97">line 97</a></div></div>sub _agent       { &quot;libwww-perl/$LWP::VERSION&quot; }</td></tr>
<tr><td class="h"><a name="658"></a>658</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="659"></a>659</td><td></td><td></td><td></td><td></td><td class="s"><div class="calls"><div class="calls_in"># spent 92&micro;s (19+73) within LWP::UserAgent::agent which was called
#    once (19&micro;s+73&micro;s) by LWP::UserAgent::new at <a href="LWP-UserAgent-pm-block.html#97">line 97</a></div></div>sub agent {</td></tr>
<tr><td class="h"><a name="660"></a>660</td><td class="c3">2</td><td class="c3"><span title="Avg 700ns">1&micro;s</span></td><td></td><td></td><td class="s">    my $self = shift;</td></tr>
<tr><td class="h"><a name="661"></a>661</td><td class="c3">3</td><td class="c3"><span title="Avg 2&micro;s">6&micro;s</span></td><td></td><td></td><td class="s">    if (@_) {</td></tr>
<tr><td class="h"><a name="662"></a>662</td><td></td><td></td><td></td><td></td><td class="s">        my $agent = shift;</td></tr>
<tr><td class="h"><a name="663"></a>663</td><td class="c3">1</td><td class="c3"><span title="Avg 6&micro;s">6&micro;s</span></td><td></td><td></td><td class="s">        if ($agent) {</td></tr>
<tr><td class="h"><a name="664"></a>664</td><td></td><td></td><td></td><td></td><td class="s">            $agent .= $self-&gt;_agent if $agent =~ /\s+$/;<div class="calls"><div class="calls_out">            # spent   900ns making 1 call to <a href="LWP-UserAgent-pm-block.html#LWP__UserAgent__CORE_match">LWP::UserAgent::CORE:match</a></div></div></td></tr>
<tr><td class="h"><a name="665"></a>665</td><td></td><td></td><td></td><td></td><td class="s">        }</td></tr>
<tr><td class="h"><a name="666"></a>666</td><td></td><td></td><td></td><td></td><td class="s">        else {</td></tr>
<tr><td class="h"><a name="667"></a>667</td><td></td><td></td><td></td><td></td><td class="s">            undef($agent)</td></tr>
<tr><td class="h"><a name="668"></a>668</td><td></td><td></td><td></td><td></td><td class="s">        }</td></tr>
<tr><td class="h"><a name="669"></a>669</td><td></td><td></td><td></td><td></td><td class="s">        return $self-&gt;default_header(&quot;User-Agent&quot;, $agent);<div class="calls"><div class="calls_out">        # spent    72&micro;s making 1 call to <a href="LWP-UserAgent-pm-block.html#652">LWP::UserAgent::default_header</a></div></div></td></tr>
<tr><td class="h"><a name="670"></a>670</td><td></td><td></td><td></td><td></td><td class="s">    }</td></tr>
<tr><td class="h"><a name="671"></a>671</td><td></td><td></td><td></td><td></td><td class="s">    return $self-&gt;default_header(&quot;User-Agent&quot;);</td></tr>
<tr><td class="h"><a name="672"></a>672</td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h"><a name="673"></a>673</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="674"></a>674</td><td></td><td></td><td></td><td></td><td class="s">sub from {  # legacy</td></tr>
<tr><td class="h"><a name="675"></a>675</td><td></td><td></td><td></td><td></td><td class="s">    my $self = shift;</td></tr>
<tr><td class="h"><a name="676"></a>676</td><td></td><td></td><td></td><td></td><td class="s">    return $self-&gt;default_header(&quot;From&quot;, @_);</td></tr>
<tr><td class="h"><a name="677"></a>677</td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h"><a name="678"></a>678</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="679"></a>679</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="680"></a>680</td><td></td><td></td><td></td><td></td><td class="s"><div class="calls"><div class="calls_in"># spent 7.32ms (7.10+222&micro;s) within LWP::UserAgent::conn_cache which was called
#    once (7.10ms+222&micro;s) by LWP::UserAgent::new at <a href="LWP-UserAgent-pm-block.html#110">line 110</a></div></div>sub conn_cache {</td></tr>
<tr><td class="h"><a name="681"></a>681</td><td class="c1">4</td><td class="c3"><span title="Avg 2&micro;s">7&micro;s</span></td><td></td><td></td><td class="s">    my $self = shift;</td></tr>
<tr><td class="h"><a name="682"></a>682</td><td></td><td></td><td></td><td></td><td class="s">    my $old = $self-&gt;{conn_cache};</td></tr>
<tr><td class="h"><a name="683"></a>683</td><td class="c3">3</td><td class="c3"><span title="Avg 933ns">3&micro;s</span></td><td></td><td></td><td class="s">    if (@_) {</td></tr>
<tr><td class="h"><a name="684"></a>684</td><td></td><td></td><td></td><td></td><td class="s">        my $cache = shift;</td></tr>
<tr><td class="h"><a name="685"></a>685</td><td class="c3">2</td><td class="c0"><span title="Avg 2.78ms">5.55ms</span></td><td></td><td></td><td class="s">        if (ref($cache) eq &quot;HASH&quot;) {</td></tr>
<tr><td class="h"><a name="686"></a>686</td><td></td><td></td><td></td><td></td><td class="s">            require LWP::ConnCache;</td></tr>
<tr><td class="h"><a name="687"></a>687</td><td></td><td></td><td></td><td></td><td class="s">            $cache = LWP::ConnCache-&gt;new(%$cache);<div class="calls"><div class="calls_out">            # spent    66&micro;s making 1 call to <a href="LWP-ConnCache-pm-block.html#9">LWP::ConnCache::new</a></div></div></td></tr>
<tr><td class="h"><a name="688"></a>688</td><td></td><td></td><td></td><td></td><td class="s">        }</td></tr>
<tr><td class="h"><a name="689"></a>689</td><td></td><td></td><td></td><td></td><td class="s">        $self-&gt;{conn_cache} = $cache;</td></tr>
<tr><td class="h"><a name="690"></a>690</td><td></td><td></td><td></td><td></td><td class="s">    }</td></tr>
<tr><td class="h"><a name="691"></a>691</td><td></td><td></td><td></td><td></td><td class="s">    $old;</td></tr>
<tr><td class="h"><a name="692"></a>692</td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h"><a name="693"></a>693</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="694"></a>694</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="695"></a>695</td><td></td><td></td><td></td><td></td><td class="s"><div class="calls"><div class="calls_in"># spent 1.46ms (1.38+76&micro;s) within LWP::UserAgent::add_handler which was called
#    once (1.38ms+76&micro;s) by LWP::UserAgent::set_my_handler at <a href="LWP-UserAgent-pm-block.html#710">line 710</a></div></div>sub add_handler {</td></tr>
<tr><td class="h"><a name="696"></a>696</td><td class="c1">4</td><td class="c3"><span title="Avg 3&micro;s">12&micro;s</span></td><td></td><td></td><td class="s">    my($self, $phase, $cb, %spec) = @_;</td></tr>
<tr><td class="h"><a name="697"></a>697</td><td></td><td></td><td></td><td></td><td class="s">    $spec{line} ||= join(&quot;:&quot;, (caller)[1,2]);</td></tr>
<tr><td class="h"><a name="698"></a>698</td><td class="c3">2</td><td class="c0"><span title="Avg 45&micro;s">89&micro;s</span></td><td></td><td></td><td class="s">    my $conf = $self-&gt;{handlers}{$phase} ||= do {</td></tr>
<tr><td class="h"><a name="699"></a>699</td><td></td><td></td><td></td><td></td><td class="s">        require HTTP::Config;</td></tr>
<tr><td class="h"><a name="700"></a>700</td><td></td><td></td><td></td><td></td><td class="s">        HTTP::Config-&gt;new;<div class="calls"><div class="calls_out">        # spent     9&micro;s making 1 call to <a href="HTTP-Config-pm-block.html#9">HTTP::Config::new</a></div></div></td></tr>
<tr><td class="h"><a name="701"></a>701</td><td></td><td></td><td></td><td></td><td class="s">    };</td></tr>
<tr><td class="h"><a name="702"></a>702</td><td></td><td></td><td></td><td></td><td class="s">    $conf-&gt;add(%spec, callback =&gt; $cb);<div class="calls"><div class="calls_out">    # spent     5&micro;s making 1 call to <a href="HTTP-Config-pm-block.html#24">HTTP::Config::add</a></div></div></td></tr>
<tr><td class="h"><a name="703"></a>703</td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h"><a name="704"></a>704</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="705"></a>705</td><td></td><td></td><td></td><td></td><td class="s"><div class="calls"><div class="calls_in"># spent 1.49ms (24&micro;s+1.47) within LWP::UserAgent::set_my_handler which was called
#    once (24&micro;s+1.47ms) by LWP::UserAgent::parse_head at <a href="LWP-UserAgent-pm-block.html#612">line 612</a></div></div>sub set_my_handler {</td></tr>
<tr><td class="h"><a name="706"></a>706</td><td class="c0">5</td><td class="c3"><span title="Avg 4&micro;s">22&micro;s</span></td><td></td><td></td><td class="s">    my($self, $phase, $cb, %spec) = @_;</td></tr>
<tr><td class="h"><a name="707"></a>707</td><td></td><td></td><td></td><td></td><td class="s">    $spec{owner} = (caller(1))[3] unless exists $spec{owner};</td></tr>
<tr><td class="h"><a name="708"></a>708</td><td></td><td></td><td></td><td></td><td class="s">    $self-&gt;remove_handler($phase, %spec);<div class="calls"><div class="calls_out">    # spent     7&micro;s making 1 call to <a href="LWP-UserAgent-pm-block.html#743">LWP::UserAgent::remove_handler</a></div></div></td></tr>
<tr><td class="h"><a name="709"></a>709</td><td></td><td></td><td></td><td></td><td class="s">    $spec{line} ||= join(&quot;:&quot;, (caller)[1,2]);</td></tr>
<tr><td class="h"><a name="710"></a>710</td><td></td><td></td><td></td><td></td><td class="s">    $self-&gt;add_handler($phase, $cb, %spec) if $cb;<div class="calls"><div class="calls_out">    # spent  1.46ms making 1 call to <a href="LWP-UserAgent-pm-block.html#695">LWP::UserAgent::add_handler</a></div></div></td></tr>
<tr><td class="h"><a name="711"></a>711</td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h"><a name="712"></a>712</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="713"></a>713</td><td></td><td></td><td></td><td></td><td class="s">sub get_my_handler {</td></tr>
<tr><td class="h"><a name="714"></a>714</td><td></td><td></td><td></td><td></td><td class="s">    my $self = shift;</td></tr>
<tr><td class="h"><a name="715"></a>715</td><td></td><td></td><td></td><td></td><td class="s">    my $phase = shift;</td></tr>
<tr><td class="h"><a name="716"></a>716</td><td></td><td></td><td></td><td></td><td class="s">    my $init = pop if @_ % 2;</td></tr>
<tr><td class="h"><a name="717"></a>717</td><td></td><td></td><td></td><td></td><td class="s">    my %spec = @_;</td></tr>
<tr><td class="h"><a name="718"></a>718</td><td></td><td></td><td></td><td></td><td class="s">    my $conf = $self-&gt;{handlers}{$phase};</td></tr>
<tr><td class="h"><a name="719"></a>719</td><td></td><td></td><td></td><td></td><td class="s">    unless ($conf) {</td></tr>
<tr><td class="h"><a name="720"></a>720</td><td></td><td></td><td></td><td></td><td class="s">        return unless $init;</td></tr>
<tr><td class="h"><a name="721"></a>721</td><td></td><td></td><td></td><td></td><td class="s">        require HTTP::Config;</td></tr>
<tr><td class="h"><a name="722"></a>722</td><td></td><td></td><td></td><td></td><td class="s">        $conf = $self-&gt;{handlers}{$phase} = HTTP::Config-&gt;new;</td></tr>
<tr><td class="h"><a name="723"></a>723</td><td></td><td></td><td></td><td></td><td class="s">    }</td></tr>
<tr><td class="h"><a name="724"></a>724</td><td></td><td></td><td></td><td></td><td class="s">    $spec{owner} = (caller(1))[3] unless exists $spec{owner};</td></tr>
<tr><td class="h"><a name="725"></a>725</td><td></td><td></td><td></td><td></td><td class="s">    my @h = $conf-&gt;find(%spec);</td></tr>
<tr><td class="h"><a name="726"></a>726</td><td></td><td></td><td></td><td></td><td class="s">    if (!@h &amp;&amp; $init) {</td></tr>
<tr><td class="h"><a name="727"></a>727</td><td></td><td></td><td></td><td></td><td class="s">        if (ref($init) eq &quot;CODE&quot;) {</td></tr>
<tr><td class="h"><a name="728"></a>728</td><td></td><td></td><td></td><td></td><td class="s">            $init-&gt;(\%spec);</td></tr>
<tr><td class="h"><a name="729"></a>729</td><td></td><td></td><td></td><td></td><td class="s">        }</td></tr>
<tr><td class="h"><a name="730"></a>730</td><td></td><td></td><td></td><td></td><td class="s">        elsif (ref($init) eq &quot;HASH&quot;) {</td></tr>
<tr><td class="h"><a name="731"></a>731</td><td></td><td></td><td></td><td></td><td class="s">            while (my($k, $v) = each %$init) {</td></tr>
<tr><td class="h"><a name="732"></a>732</td><td></td><td></td><td></td><td></td><td class="s">                $spec{$k} = $v;</td></tr>
<tr><td class="h"><a name="733"></a>733</td><td></td><td></td><td></td><td></td><td class="s">            }</td></tr>
<tr><td class="h"><a name="734"></a>734</td><td></td><td></td><td></td><td></td><td class="s">        }</td></tr>
<tr><td class="h"><a name="735"></a>735</td><td></td><td></td><td></td><td></td><td class="s">        $spec{callback} ||= sub {};</td></tr>
<tr><td class="h"><a name="736"></a>736</td><td></td><td></td><td></td><td></td><td class="s">        $spec{line} ||= join(&quot;:&quot;, (caller)[1,2]);</td></tr>
<tr><td class="h"><a name="737"></a>737</td><td></td><td></td><td></td><td></td><td class="s">        $conf-&gt;add(\%spec);</td></tr>
<tr><td class="h"><a name="738"></a>738</td><td></td><td></td><td></td><td></td><td class="s">        return \%spec;</td></tr>
<tr><td class="h"><a name="739"></a>739</td><td></td><td></td><td></td><td></td><td class="s">    }</td></tr>
<tr><td class="h"><a name="740"></a>740</td><td></td><td></td><td></td><td></td><td class="s">    return wantarray ? @h : $h[0];</td></tr>
<tr><td class="h"><a name="741"></a>741</td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h"><a name="742"></a>742</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="743"></a>743</td><td></td><td></td><td></td><td></td><td class="s"><div class="calls"><div class="calls_in"># spent 7&micro;s within LWP::UserAgent::remove_handler which was called
#    once (7&micro;s+0s) by LWP::UserAgent::set_my_handler at <a href="LWP-UserAgent-pm-block.html#708">line 708</a></div></div>sub remove_handler {</td></tr>
<tr><td class="h"><a name="744"></a>744</td><td class="c3">2</td><td class="c3"><span title="Avg 1&micro;s">2&micro;s</span></td><td></td><td></td><td class="s">    my($self, $phase, %spec) = @_;</td></tr>
<tr><td class="h"><a name="745"></a>745</td><td class="c3">1</td><td class="c3"><span title="Avg 5&micro;s">5&micro;s</span></td><td></td><td></td><td class="s">    if ($phase) {</td></tr>
<tr><td class="h"><a name="746"></a>746</td><td></td><td></td><td></td><td></td><td class="s">        my $conf = $self-&gt;{handlers}{$phase} || return;</td></tr>
<tr><td class="h"><a name="747"></a>747</td><td></td><td></td><td></td><td></td><td class="s">        my @h = $conf-&gt;remove(%spec);</td></tr>
<tr><td class="h"><a name="748"></a>748</td><td></td><td></td><td></td><td></td><td class="s">        delete $self-&gt;{handlers}{$phase} if $conf-&gt;empty;</td></tr>
<tr><td class="h"><a name="749"></a>749</td><td></td><td></td><td></td><td></td><td class="s">        return @h;</td></tr>
<tr><td class="h"><a name="750"></a>750</td><td></td><td></td><td></td><td></td><td class="s">    }</td></tr>
<tr><td class="h"><a name="751"></a>751</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="752"></a>752</td><td></td><td></td><td></td><td></td><td class="s">    return unless $self-&gt;{handlers};</td></tr>
<tr><td class="h"><a name="753"></a>753</td><td></td><td></td><td></td><td></td><td class="s">    return map $self-&gt;remove_handler($_), sort keys %{$self-&gt;{handlers}};</td></tr>
<tr><td class="h"><a name="754"></a>754</td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h"><a name="755"></a>755</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="756"></a>756</td><td></td><td></td><td></td><td></td><td class="s"><div class="calls"><div class="calls_in"># spent 1.55ms (126&micro;s+1.43) within LWP::UserAgent::handlers which was called 22 times, avg 71&micro;s/call:
# 12 times (81&micro;s+1.43ms) by LWP::UserAgent::run_handlers at <a href="LWP-UserAgent-pm-block.html#778">line 778</a>, avg 126&micro;s/call
#  6 times (18&micro;s+0s) by LWP::UserAgent::run_handlers at <a href="LWP-UserAgent-pm-block.html#771">line 771</a>, avg 3&micro;s/call
#  4 times (27&micro;s+0s) by LWP::Protocol::collect at <a href="LWP-Protocol-pm-block.html#149">line 149 of LWP/Protocol.pm</a>, avg 7&micro;s/call</div></div>sub handlers {</td></tr>
<tr><td class="h"><a name="757"></a>757</td><td class="c0">110</td><td class="c0"><span title="Avg 1&micro;s">137&micro;s</span></td><td></td><td></td><td class="s">    my($self, $phase, $o) = @_;</td></tr>
<tr><td class="h"><a name="758"></a>758</td><td></td><td></td><td></td><td></td><td class="s">    my @h;</td></tr>
<tr><td class="h"><a name="759"></a>759</td><td></td><td></td><td></td><td></td><td class="s">    if ($o-&gt;{handlers} &amp;&amp; $o-&gt;{handlers}{$phase}) {</td></tr>
<tr><td class="h"><a name="760"></a>760</td><td></td><td></td><td></td><td></td><td class="s">        push(@h, @{$o-&gt;{handlers}{$phase}});</td></tr>
<tr><td class="h"><a name="761"></a>761</td><td></td><td></td><td></td><td></td><td class="s">    }</td></tr>
<tr><td class="h"><a name="762"></a>762</td><td></td><td></td><td></td><td></td><td class="s">    if (my $conf = $self-&gt;{handlers}{$phase}) {<div class="calls"><div class="calls_out">    # spent  1.43ms making 3 calls to <a href="HTTP-Config-pm-block.html#170">HTTP::Config::matching</a>, avg 475&micro;s/call</div></div></td></tr>
<tr><td class="h"><a name="763"></a>763</td><td></td><td></td><td></td><td></td><td class="s">        push(@h, $conf-&gt;matching($o));</td></tr>
<tr><td class="h"><a name="764"></a>764</td><td></td><td></td><td></td><td></td><td class="s">    }</td></tr>
<tr><td class="h"><a name="765"></a>765</td><td></td><td></td><td></td><td></td><td class="s">    return @h;</td></tr>
<tr><td class="h"><a name="766"></a>766</td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h"><a name="767"></a>767</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="768"></a>768</td><td></td><td></td><td></td><td></td><td class="s"><div class="calls"><div class="calls_in"># spent 1.67ms (141&micro;s+1.52) within LWP::UserAgent::run_handlers which was called 18 times, avg 93&micro;s/call:
# 3 times (32&micro;s+1.47ms) by LWP::Protocol::collect at <a href="LWP-Protocol-pm-block.html#132">line 132 of LWP/Protocol.pm</a>, avg 501&micro;s/call
# 3 times (25&micro;s+13&micro;s) by LWP::UserAgent::prepare_request at <a href="LWP-UserAgent-pm-block.html#213">line 213</a>, avg 13&micro;s/call
# 3 times (23&micro;s+11&micro;s) by LWP::UserAgent::send_request at <a href="LWP-UserAgent-pm-block.html#198">line 198</a>, avg 11&micro;s/call
# 3 times (24&micro;s+10&micro;s) by LWP::UserAgent::request at <a href="LWP-UserAgent-pm-block.html#270">line 270</a>, avg 11&micro;s/call
# 3 times (19&micro;s+9&micro;s) by LWP::UserAgent::send_request at <a href="LWP-UserAgent-pm-block.html#126">line 126</a>, avg 9&micro;s/call
# 3 times (18&micro;s+10&micro;s) by LWP::UserAgent::prepare_request at <a href="LWP-UserAgent-pm-block.html#221">line 221</a>, avg 9&micro;s/call</div></div>sub run_handlers {</td></tr>
<tr><td class="h"><a name="769"></a>769</td><td class="c0">48</td><td class="c0"><span title="Avg 2&micro;s">101&micro;s</span></td><td></td><td></td><td class="s">    my($self, $phase, $o) = @_;</td></tr>
<tr><td class="h"><a name="770"></a>770</td><td class="c0">12</td><td class="c2"><span title="Avg 3&micro;s">34&micro;s</span></td><td></td><td></td><td class="s">    if (defined(wantarray)) {</td></tr>
<tr><td class="h"><a name="771"></a>771</td><td></td><td></td><td></td><td></td><td class="s">        for my $h ($self-&gt;handlers($phase, $o)) {<div class="calls"><div class="calls_out">        # spent    18&micro;s making 6 calls to <a href="LWP-UserAgent-pm-block.html#756">LWP::UserAgent::handlers</a>, avg 3&micro;s/call</div></div></td></tr>
<tr><td class="h"><a name="772"></a>772</td><td></td><td></td><td></td><td></td><td class="s">            my $ret = $h-&gt;{callback}-&gt;($o, $self, $h);</td></tr>
<tr><td class="h"><a name="773"></a>773</td><td></td><td></td><td></td><td></td><td class="s">            return $ret if $ret;</td></tr>
<tr><td class="h"><a name="774"></a>774</td><td></td><td></td><td></td><td></td><td class="s">        }</td></tr>
<tr><td class="h"><a name="775"></a>775</td><td></td><td></td><td></td><td></td><td class="s">        return undef;</td></tr>
<tr><td class="h"><a name="776"></a>776</td><td></td><td></td><td></td><td></td><td class="s">    }</td></tr>
<tr><td class="h"><a name="777"></a>777</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="778"></a>778</td><td></td><td></td><td></td><td></td><td class="s">    for my $h ($self-&gt;handlers($phase, $o)) {<div class="calls"><div class="calls_out">    # spent  1.51ms making 12 calls to <a href="LWP-UserAgent-pm-block.html#756">LWP::UserAgent::handlers</a>, avg 126&micro;s/call</div></div></td></tr>
<tr><td class="h"><a name="779"></a>779</td><td></td><td></td><td></td><td></td><td class="s">        $h-&gt;{callback}-&gt;($o, $self, $h);</td></tr>
<tr><td class="h"><a name="780"></a>780</td><td></td><td></td><td></td><td></td><td class="s">    }</td></tr>
<tr><td class="h"><a name="781"></a>781</td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h"><a name="782"></a>782</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="783"></a>783</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="784"></a>784</td><td></td><td></td><td></td><td></td><td class="s"># depreciated</td></tr>
<tr><td class="h"><a name="785"></a>785</td><td></td><td></td><td></td><td></td><td class="s">sub use_eval   { shift-&gt;_elem('use_eval',  @_); }</td></tr>
<tr><td class="h"><a name="786"></a>786</td><td></td><td></td><td></td><td></td><td class="s">sub use_alarm</td></tr>
<tr><td class="h"><a name="787"></a>787</td><td></td><td></td><td></td><td></td><td class="s">{</td></tr>
<tr><td class="h"><a name="788"></a>788</td><td></td><td></td><td></td><td></td><td class="s">    Carp::carp(&quot;LWP::UserAgent-&gt;use_alarm(BOOL) is a no-op&quot;)</td></tr>
<tr><td class="h"><a name="789"></a>789</td><td></td><td></td><td></td><td></td><td class="s">        if @_ &gt; 1 &amp;&amp; $^W;</td></tr>
<tr><td class="h"><a name="790"></a>790</td><td></td><td></td><td></td><td></td><td class="s">    &quot;&quot;;</td></tr>
<tr><td class="h"><a name="791"></a>791</td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h"><a name="792"></a>792</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="793"></a>793</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="794"></a>794</td><td></td><td></td><td></td><td></td><td class="s">sub clone</td></tr>
<tr><td class="h"><a name="795"></a>795</td><td></td><td></td><td></td><td></td><td class="s">{</td></tr>
<tr><td class="h"><a name="796"></a>796</td><td></td><td></td><td></td><td></td><td class="s">    my $self = shift;</td></tr>
<tr><td class="h"><a name="797"></a>797</td><td></td><td></td><td></td><td></td><td class="s">    my $copy = bless { %$self }, ref $self;  # copy most fields</td></tr>
<tr><td class="h"><a name="798"></a>798</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="799"></a>799</td><td></td><td></td><td></td><td></td><td class="s">    delete $copy-&gt;{handlers};</td></tr>
<tr><td class="h"><a name="800"></a>800</td><td></td><td></td><td></td><td></td><td class="s">    delete $copy-&gt;{conn_cache};</td></tr>
<tr><td class="h"><a name="801"></a>801</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="802"></a>802</td><td></td><td></td><td></td><td></td><td class="s">    # copy any plain arrays and hashes; known not to need recursive copy</td></tr>
<tr><td class="h"><a name="803"></a>803</td><td></td><td></td><td></td><td></td><td class="s">    for my $k (qw(proxy no_proxy requests_redirectable)) {</td></tr>
<tr><td class="h"><a name="804"></a>804</td><td></td><td></td><td></td><td></td><td class="s">        next unless $copy-&gt;{$k};</td></tr>
<tr><td class="h"><a name="805"></a>805</td><td></td><td></td><td></td><td></td><td class="s">        if (ref($copy-&gt;{$k}) eq &quot;ARRAY&quot;) {</td></tr>
<tr><td class="h"><a name="806"></a>806</td><td></td><td></td><td></td><td></td><td class="s">            $copy-&gt;{$k} = [ @{$copy-&gt;{$k}} ];</td></tr>
<tr><td class="h"><a name="807"></a>807</td><td></td><td></td><td></td><td></td><td class="s">        }</td></tr>
<tr><td class="h"><a name="808"></a>808</td><td></td><td></td><td></td><td></td><td class="s">        elsif (ref($copy-&gt;{$k}) eq &quot;HASH&quot;) {</td></tr>
<tr><td class="h"><a name="809"></a>809</td><td></td><td></td><td></td><td></td><td class="s">            $copy-&gt;{$k} = { %{$copy-&gt;{$k}} };</td></tr>
<tr><td class="h"><a name="810"></a>810</td><td></td><td></td><td></td><td></td><td class="s">        }</td></tr>
<tr><td class="h"><a name="811"></a>811</td><td></td><td></td><td></td><td></td><td class="s">    }</td></tr>
<tr><td class="h"><a name="812"></a>812</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="813"></a>813</td><td></td><td></td><td></td><td></td><td class="s">    if ($self-&gt;{def_headers}) {</td></tr>
<tr><td class="h"><a name="814"></a>814</td><td></td><td></td><td></td><td></td><td class="s">        $copy-&gt;{def_headers} = $self-&gt;{def_headers}-&gt;clone;</td></tr>
<tr><td class="h"><a name="815"></a>815</td><td></td><td></td><td></td><td></td><td class="s">    }</td></tr>
<tr><td class="h"><a name="816"></a>816</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="817"></a>817</td><td></td><td></td><td></td><td></td><td class="s">    # re-enable standard handlers</td></tr>
<tr><td class="h"><a name="818"></a>818</td><td></td><td></td><td></td><td></td><td class="s">    $copy-&gt;parse_head($self-&gt;parse_head);</td></tr>
<tr><td class="h"><a name="819"></a>819</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="820"></a>820</td><td></td><td></td><td></td><td></td><td class="s">    # no easy way to clone the cookie jar; so let's just remove it for now</td></tr>
<tr><td class="h"><a name="821"></a>821</td><td></td><td></td><td></td><td></td><td class="s">    $copy-&gt;cookie_jar(undef);</td></tr>
<tr><td class="h"><a name="822"></a>822</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="823"></a>823</td><td></td><td></td><td></td><td></td><td class="s">    $copy;</td></tr>
<tr><td class="h"><a name="824"></a>824</td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h"><a name="825"></a>825</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="826"></a>826</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="827"></a>827</td><td></td><td></td><td></td><td></td><td class="s">sub mirror</td></tr>
<tr><td class="h"><a name="828"></a>828</td><td></td><td></td><td></td><td></td><td class="s">{</td></tr>
<tr><td class="h"><a name="829"></a>829</td><td></td><td></td><td></td><td></td><td class="s">    my($self, $url, $file) = @_;</td></tr>
<tr><td class="h"><a name="830"></a>830</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="831"></a>831</td><td></td><td></td><td></td><td></td><td class="s">    my $request = HTTP::Request-&gt;new('GET', $url);</td></tr>
<tr><td class="h"><a name="832"></a>832</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="833"></a>833</td><td></td><td></td><td></td><td></td><td class="s">    # If the file exists, add a cache-related header</td></tr>
<tr><td class="h"><a name="834"></a>834</td><td></td><td></td><td></td><td></td><td class="s">    if ( -e $file ) {</td></tr>
<tr><td class="h"><a name="835"></a>835</td><td></td><td></td><td></td><td></td><td class="s">        my ($mtime) = ( stat($file) )[9];</td></tr>
<tr><td class="h"><a name="836"></a>836</td><td></td><td></td><td></td><td></td><td class="s">        if ($mtime) {</td></tr>
<tr><td class="h"><a name="837"></a>837</td><td></td><td></td><td></td><td></td><td class="s">            $request-&gt;header( 'If-Modified-Since' =&gt; HTTP::Date::time2str($mtime) );</td></tr>
<tr><td class="h"><a name="838"></a>838</td><td></td><td></td><td></td><td></td><td class="s">        }</td></tr>
<tr><td class="h"><a name="839"></a>839</td><td></td><td></td><td></td><td></td><td class="s">    }</td></tr>
<tr><td class="h"><a name="840"></a>840</td><td></td><td></td><td></td><td></td><td class="s">    my $tmpfile = &quot;$file-$$&quot;;</td></tr>
<tr><td class="h"><a name="841"></a>841</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="842"></a>842</td><td></td><td></td><td></td><td></td><td class="s">    my $response = $self-&gt;request($request, $tmpfile);</td></tr>
<tr><td class="h"><a name="843"></a>843</td><td></td><td></td><td></td><td></td><td class="s">    if ( $response-&gt;header('X-Died') ) {</td></tr>
<tr><td class="h"><a name="844"></a>844</td><td></td><td></td><td></td><td></td><td class="s">        die $response-&gt;header('X-Died');</td></tr>
<tr><td class="h"><a name="845"></a>845</td><td></td><td></td><td></td><td></td><td class="s">    }</td></tr>
<tr><td class="h"><a name="846"></a>846</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="847"></a>847</td><td></td><td></td><td></td><td></td><td class="s">    # Only fetching a fresh copy of the would be considered success.</td></tr>
<tr><td class="h"><a name="848"></a>848</td><td></td><td></td><td></td><td></td><td class="s">    # If the file was not modified, &quot;304&quot; would returned, which </td></tr>
<tr><td class="h"><a name="849"></a>849</td><td></td><td></td><td></td><td></td><td class="s">    # is considered by HTTP::Status to be a &quot;redirect&quot;, /not/ &quot;success&quot;</td></tr>
<tr><td class="h"><a name="850"></a>850</td><td></td><td></td><td></td><td></td><td class="s">    if ( $response-&gt;is_success ) {</td></tr>
<tr><td class="h"><a name="851"></a>851</td><td></td><td></td><td></td><td></td><td class="s">        my @stat        = stat($tmpfile) or die &quot;Could not stat tmpfile '$tmpfile': $!&quot;;</td></tr>
<tr><td class="h"><a name="852"></a>852</td><td></td><td></td><td></td><td></td><td class="s">        my $file_length = $stat[7];</td></tr>
<tr><td class="h"><a name="853"></a>853</td><td></td><td></td><td></td><td></td><td class="s">        my ($content_length) = $response-&gt;header('Content-length');</td></tr>
<tr><td class="h"><a name="854"></a>854</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="855"></a>855</td><td></td><td></td><td></td><td></td><td class="s">        if ( defined $content_length and $file_length &lt; $content_length ) {</td></tr>
<tr><td class="h"><a name="856"></a>856</td><td></td><td></td><td></td><td></td><td class="s">            unlink($tmpfile);</td></tr>
<tr><td class="h"><a name="857"></a>857</td><td></td><td></td><td></td><td></td><td class="s">            die &quot;Transfer truncated: &quot; . &quot;only $file_length out of $content_length bytes received\n&quot;;</td></tr>
<tr><td class="h"><a name="858"></a>858</td><td></td><td></td><td></td><td></td><td class="s">        }</td></tr>
<tr><td class="h"><a name="859"></a>859</td><td></td><td></td><td></td><td></td><td class="s">        elsif ( defined $content_length and $file_length &gt; $content_length ) {</td></tr>
<tr><td class="h"><a name="860"></a>860</td><td></td><td></td><td></td><td></td><td class="s">            unlink($tmpfile);</td></tr>
<tr><td class="h"><a name="861"></a>861</td><td></td><td></td><td></td><td></td><td class="s">            die &quot;Content-length mismatch: &quot; . &quot;expected $content_length bytes, got $file_length\n&quot;;</td></tr>
<tr><td class="h"><a name="862"></a>862</td><td></td><td></td><td></td><td></td><td class="s">        }</td></tr>
<tr><td class="h"><a name="863"></a>863</td><td></td><td></td><td></td><td></td><td class="s">        # The file was the expected length. </td></tr>
<tr><td class="h"><a name="864"></a>864</td><td></td><td></td><td></td><td></td><td class="s">        else {</td></tr>
<tr><td class="h"><a name="865"></a>865</td><td></td><td></td><td></td><td></td><td class="s">            # Replace the stale file with a fresh copy</td></tr>
<tr><td class="h"><a name="866"></a>866</td><td></td><td></td><td></td><td></td><td class="s">            if ( -e $file ) {</td></tr>
<tr><td class="h"><a name="867"></a>867</td><td></td><td></td><td></td><td></td><td class="s">                # Some dosish systems fail to rename if the target exists</td></tr>
<tr><td class="h"><a name="868"></a>868</td><td></td><td></td><td></td><td></td><td class="s">                chmod 0777, $file;</td></tr>
<tr><td class="h"><a name="869"></a>869</td><td></td><td></td><td></td><td></td><td class="s">                unlink $file;</td></tr>
<tr><td class="h"><a name="870"></a>870</td><td></td><td></td><td></td><td></td><td class="s">            }</td></tr>
<tr><td class="h"><a name="871"></a>871</td><td></td><td></td><td></td><td></td><td class="s">            rename( $tmpfile, $file )</td></tr>
<tr><td class="h"><a name="872"></a>872</td><td></td><td></td><td></td><td></td><td class="s">                or die &quot;Cannot rename '$tmpfile' to '$file': $!\n&quot;;</td></tr>
<tr><td class="h"><a name="873"></a>873</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="874"></a>874</td><td></td><td></td><td></td><td></td><td class="s">            # make sure the file has the same last modification time</td></tr>
<tr><td class="h"><a name="875"></a>875</td><td></td><td></td><td></td><td></td><td class="s">            if ( my $lm = $response-&gt;last_modified ) {</td></tr>
<tr><td class="h"><a name="876"></a>876</td><td></td><td></td><td></td><td></td><td class="s">                utime $lm, $lm, $file;</td></tr>
<tr><td class="h"><a name="877"></a>877</td><td></td><td></td><td></td><td></td><td class="s">            }</td></tr>
<tr><td class="h"><a name="878"></a>878</td><td></td><td></td><td></td><td></td><td class="s">        }</td></tr>
<tr><td class="h"><a name="879"></a>879</td><td></td><td></td><td></td><td></td><td class="s">    }</td></tr>
<tr><td class="h"><a name="880"></a>880</td><td></td><td></td><td></td><td></td><td class="s">    # The local copy is fresh enough, so just delete the temp file  </td></tr>
<tr><td class="h"><a name="881"></a>881</td><td></td><td></td><td></td><td></td><td class="s">    else {</td></tr>
<tr><td class="h"><a name="882"></a>882</td><td></td><td></td><td></td><td></td><td class="s">        unlink($tmpfile);</td></tr>
<tr><td class="h"><a name="883"></a>883</td><td></td><td></td><td></td><td></td><td class="s">    }</td></tr>
<tr><td class="h"><a name="884"></a>884</td><td></td><td></td><td></td><td></td><td class="s">    return $response;</td></tr>
<tr><td class="h"><a name="885"></a>885</td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h"><a name="886"></a>886</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="887"></a>887</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="888"></a>888</td><td></td><td></td><td></td><td></td><td class="s">sub _need_proxy {</td></tr>
<tr><td class="h"><a name="889"></a>889</td><td></td><td></td><td></td><td></td><td class="s">    my($req, $ua) = @_;</td></tr>
<tr><td class="h"><a name="890"></a>890</td><td></td><td></td><td></td><td></td><td class="s">    return if exists $req-&gt;{proxy};</td></tr>
<tr><td class="h"><a name="891"></a>891</td><td></td><td></td><td></td><td></td><td class="s">    my $proxy = $ua-&gt;{proxy}{$req-&gt;uri-&gt;scheme} || return;</td></tr>
<tr><td class="h"><a name="892"></a>892</td><td></td><td></td><td></td><td></td><td class="s">    if ($ua-&gt;{no_proxy}) {</td></tr>
<tr><td class="h"><a name="893"></a>893</td><td></td><td></td><td></td><td></td><td class="s">        if (my $host = eval { $req-&gt;uri-&gt;host }) {</td></tr>
<tr><td class="h"><a name="894"></a>894</td><td></td><td></td><td></td><td></td><td class="s">            for my $domain (@{$ua-&gt;{no_proxy}}) {</td></tr>
<tr><td class="h"><a name="895"></a>895</td><td></td><td></td><td></td><td></td><td class="s">                if ($host =~ /\Q$domain\E$/) {</td></tr>
<tr><td class="h"><a name="896"></a>896</td><td></td><td></td><td></td><td></td><td class="s">                    return;</td></tr>
<tr><td class="h"><a name="897"></a>897</td><td></td><td></td><td></td><td></td><td class="s">                }</td></tr>
<tr><td class="h"><a name="898"></a>898</td><td></td><td></td><td></td><td></td><td class="s">            }</td></tr>
<tr><td class="h"><a name="899"></a>899</td><td></td><td></td><td></td><td></td><td class="s">        }</td></tr>
<tr><td class="h"><a name="900"></a>900</td><td></td><td></td><td></td><td></td><td class="s">    }</td></tr>
<tr><td class="h"><a name="901"></a>901</td><td></td><td></td><td></td><td></td><td class="s">    $req-&gt;{proxy} = $HTTP::URI_CLASS-&gt;new($proxy);</td></tr>
<tr><td class="h"><a name="902"></a>902</td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h"><a name="903"></a>903</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="904"></a>904</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="905"></a>905</td><td></td><td></td><td></td><td></td><td class="s">sub proxy</td></tr>
<tr><td class="h"><a name="906"></a>906</td><td></td><td></td><td></td><td></td><td class="s">{</td></tr>
<tr><td class="h"><a name="907"></a>907</td><td></td><td></td><td></td><td></td><td class="s">    my $self = shift;</td></tr>
<tr><td class="h"><a name="908"></a>908</td><td></td><td></td><td></td><td></td><td class="s">    my $key  = shift;</td></tr>
<tr><td class="h"><a name="909"></a>909</td><td></td><td></td><td></td><td></td><td class="s">    return map $self-&gt;proxy($_, @_), @$key if ref $key;</td></tr>
<tr><td class="h"><a name="910"></a>910</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="911"></a>911</td><td></td><td></td><td></td><td></td><td class="s">    Carp::croak(&quot;'$key' is not a valid URI scheme&quot;) unless $key =~ /^$URI::scheme_re\z/;</td></tr>
<tr><td class="h"><a name="912"></a>912</td><td></td><td></td><td></td><td></td><td class="s">    my $old = $self-&gt;{'proxy'}{$key};</td></tr>
<tr><td class="h"><a name="913"></a>913</td><td></td><td></td><td></td><td></td><td class="s">    if (@_) {</td></tr>
<tr><td class="h"><a name="914"></a>914</td><td></td><td></td><td></td><td></td><td class="s">        my $url = shift;</td></tr>
<tr><td class="h"><a name="915"></a>915</td><td></td><td></td><td></td><td></td><td class="s">        if (defined($url) &amp;&amp; length($url)) {</td></tr>
<tr><td class="h"><a name="916"></a>916</td><td></td><td></td><td></td><td></td><td class="s">            Carp::croak(&quot;Proxy must be specified as absolute URI; '$url' is not&quot;) unless $url =~ /^$URI::scheme_re:/;</td></tr>
<tr><td class="h"><a name="917"></a>917</td><td></td><td></td><td></td><td></td><td class="s">            Carp::croak(&quot;Bad http proxy specification '$url'&quot;) if $url =~ /^https?:/ &amp;&amp; $url !~ m,^https?://\w,;</td></tr>
<tr><td class="h"><a name="918"></a>918</td><td></td><td></td><td></td><td></td><td class="s">        }</td></tr>
<tr><td class="h"><a name="919"></a>919</td><td></td><td></td><td></td><td></td><td class="s">        $self-&gt;{proxy}{$key} = $url;</td></tr>
<tr><td class="h"><a name="920"></a>920</td><td></td><td></td><td></td><td></td><td class="s">        $self-&gt;set_my_handler(&quot;request_preprepare&quot;, \&amp;_need_proxy)</td></tr>
<tr><td class="h"><a name="921"></a>921</td><td></td><td></td><td></td><td></td><td class="s">    }</td></tr>
<tr><td class="h"><a name="922"></a>922</td><td></td><td></td><td></td><td></td><td class="s">    return $old;</td></tr>
<tr><td class="h"><a name="923"></a>923</td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h"><a name="924"></a>924</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="925"></a>925</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="926"></a>926</td><td></td><td></td><td></td><td></td><td class="s">sub env_proxy {</td></tr>
<tr><td class="h"><a name="927"></a>927</td><td></td><td></td><td></td><td></td><td class="s">    my ($self) = @_;</td></tr>
<tr><td class="h"><a name="928"></a>928</td><td></td><td></td><td></td><td></td><td class="s">    my($k,$v);</td></tr>
<tr><td class="h"><a name="929"></a>929</td><td></td><td></td><td></td><td></td><td class="s">    while(($k, $v) = each %ENV) {</td></tr>
<tr><td class="h"><a name="930"></a>930</td><td></td><td></td><td></td><td></td><td class="s">        if ($ENV{REQUEST_METHOD}) {</td></tr>
<tr><td class="h"><a name="931"></a>931</td><td></td><td></td><td></td><td></td><td class="s">            # Need to be careful when called in the CGI environment, as</td></tr>
<tr><td class="h"><a name="932"></a>932</td><td></td><td></td><td></td><td></td><td class="s">            # the HTTP_PROXY variable is under control of that other guy.</td></tr>
<tr><td class="h"><a name="933"></a>933</td><td></td><td></td><td></td><td></td><td class="s">            next if $k =~ /^HTTP_/;</td></tr>
<tr><td class="h"><a name="934"></a>934</td><td></td><td></td><td></td><td></td><td class="s">            $k = &quot;HTTP_PROXY&quot; if $k eq &quot;CGI_HTTP_PROXY&quot;;</td></tr>
<tr><td class="h"><a name="935"></a>935</td><td></td><td></td><td></td><td></td><td class="s">        }</td></tr>
<tr><td class="h"><a name="936"></a>936</td><td></td><td></td><td></td><td></td><td class="s">        $k = lc($k);</td></tr>
<tr><td class="h"><a name="937"></a>937</td><td></td><td></td><td></td><td></td><td class="s">        next unless $k =~ /^(.*)_proxy$/;</td></tr>
<tr><td class="h"><a name="938"></a>938</td><td></td><td></td><td></td><td></td><td class="s">        $k = $1;</td></tr>
<tr><td class="h"><a name="939"></a>939</td><td></td><td></td><td></td><td></td><td class="s">        if ($k eq 'no') {</td></tr>
<tr><td class="h"><a name="940"></a>940</td><td></td><td></td><td></td><td></td><td class="s">            $self-&gt;no_proxy(split(/\s*,\s*/, $v));</td></tr>
<tr><td class="h"><a name="941"></a>941</td><td></td><td></td><td></td><td></td><td class="s">        }</td></tr>
<tr><td class="h"><a name="942"></a>942</td><td></td><td></td><td></td><td></td><td class="s">        else {</td></tr>
<tr><td class="h"><a name="943"></a>943</td><td></td><td></td><td></td><td></td><td class="s">            # Ignore random _proxy variables, allow only valid schemes</td></tr>
<tr><td class="h"><a name="944"></a>944</td><td></td><td></td><td></td><td></td><td class="s">            next unless $k =~ /^$URI::scheme_re\z/;</td></tr>
<tr><td class="h"><a name="945"></a>945</td><td></td><td></td><td></td><td></td><td class="s">            # Ignore xxx_proxy variables if xxx isn't a supported protocol</td></tr>
<tr><td class="h"><a name="946"></a>946</td><td></td><td></td><td></td><td></td><td class="s">            next unless LWP::Protocol::implementor($k);</td></tr>
<tr><td class="h"><a name="947"></a>947</td><td></td><td></td><td></td><td></td><td class="s">            $self-&gt;proxy($k, $v);</td></tr>
<tr><td class="h"><a name="948"></a>948</td><td></td><td></td><td></td><td></td><td class="s">        }</td></tr>
<tr><td class="h"><a name="949"></a>949</td><td></td><td></td><td></td><td></td><td class="s">    }</td></tr>
<tr><td class="h"><a name="950"></a>950</td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h"><a name="951"></a>951</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="952"></a>952</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="953"></a>953</td><td></td><td></td><td></td><td></td><td class="s">sub no_proxy {</td></tr>
<tr><td class="h"><a name="954"></a>954</td><td></td><td></td><td></td><td></td><td class="s">    my($self, @no) = @_;</td></tr>
<tr><td class="h"><a name="955"></a>955</td><td></td><td></td><td></td><td></td><td class="s">    if (@no) {</td></tr>
<tr><td class="h"><a name="956"></a>956</td><td></td><td></td><td></td><td></td><td class="s">        push(@{ $self-&gt;{'no_proxy'} }, @no);</td></tr>
<tr><td class="h"><a name="957"></a>957</td><td></td><td></td><td></td><td></td><td class="s">    }</td></tr>
<tr><td class="h"><a name="958"></a>958</td><td></td><td></td><td></td><td></td><td class="s">    else {</td></tr>
<tr><td class="h"><a name="959"></a>959</td><td></td><td></td><td></td><td></td><td class="s">        $self-&gt;{'no_proxy'} = [];</td></tr>
<tr><td class="h"><a name="960"></a>960</td><td></td><td></td><td></td><td></td><td class="s">    }</td></tr>
<tr><td class="h"><a name="961"></a>961</td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h"><a name="962"></a>962</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="963"></a>963</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="964"></a>964</td><td></td><td></td><td></td><td></td><td class="s">sub _new_response {</td></tr>
<tr><td class="h"><a name="965"></a>965</td><td></td><td></td><td></td><td></td><td class="s">    my($request, $code, $message) = @_;</td></tr>
<tr><td class="h"><a name="966"></a>966</td><td></td><td></td><td></td><td></td><td class="s">    my $response = HTTP::Response-&gt;new($code, $message);</td></tr>
<tr><td class="h"><a name="967"></a>967</td><td></td><td></td><td></td><td></td><td class="s">    $response-&gt;request($request);</td></tr>
<tr><td class="h"><a name="968"></a>968</td><td></td><td></td><td></td><td></td><td class="s">    $response-&gt;header(&quot;Client-Date&quot; =&gt; HTTP::Date::time2str(time));</td></tr>
<tr><td class="h"><a name="969"></a>969</td><td></td><td></td><td></td><td></td><td class="s">    $response-&gt;header(&quot;Client-Warning&quot; =&gt; &quot;Internal response&quot;);</td></tr>
<tr><td class="h"><a name="970"></a>970</td><td></td><td></td><td></td><td></td><td class="s">    $response-&gt;header(&quot;Content-Type&quot; =&gt; &quot;text/plain&quot;);</td></tr>
<tr><td class="h"><a name="971"></a>971</td><td></td><td></td><td></td><td></td><td class="s">    $response-&gt;content(&quot;$code $message\n&quot;);</td></tr>
<tr><td class="h"><a name="972"></a>972</td><td></td><td></td><td></td><td></td><td class="s">    return $response;</td></tr>
<tr><td class="h"><a name="973"></a>973</td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h"><a name="974"></a>974</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="975"></a>975</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="976"></a>976</td><td class="c3">1</td><td class="c2"><span title="Avg 33&micro;s">33&micro;s</span></td><td></td><td></td><td class="s">1;</td></tr>
<tr><td class="h"><a name="977"></a>977</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="978"></a>978</td><td></td><td></td><td></td><td></td><td class="s">__END__</td></tr>
<tr><td class="h"><a name="979"></a>979</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="980"></a>980</td><td></td><td></td><td></td><td></td><td class="s">=head1 NAME</td></tr>
<tr><td class="h"><a name="981"></a>981</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="982"></a>982</td><td></td><td></td><td></td><td></td><td class="s">LWP::UserAgent - Web user agent class</td></tr>
<tr><td class="h"><a name="983"></a>983</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="984"></a>984</td><td></td><td></td><td></td><td></td><td class="s">=head1 SYNOPSIS</td></tr>
<tr><td class="h"><a name="985"></a>985</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="986"></a>986</td><td></td><td></td><td></td><td></td><td class="s"> require LWP::UserAgent;</td></tr>
<tr><td class="h"><a name="987"></a>987</td><td></td><td></td><td></td><td></td><td class="s"> </td></tr>
<tr><td class="h"><a name="988"></a>988</td><td></td><td></td><td></td><td></td><td class="s"> my $ua = LWP::UserAgent-&gt;new;</td></tr>
<tr><td class="h"><a name="989"></a>989</td><td></td><td></td><td></td><td></td><td class="s"> $ua-&gt;timeout(10);</td></tr>
<tr><td class="h"><a name="990"></a>990</td><td></td><td></td><td></td><td></td><td class="s"> $ua-&gt;env_proxy;</td></tr>
<tr><td class="h"><a name="991"></a>991</td><td></td><td></td><td></td><td></td><td class="s"> </td></tr>
<tr><td class="h"><a name="992"></a>992</td><td></td><td></td><td></td><td></td><td class="s"> my $response = $ua-&gt;get('http://search.cpan.org/');</td></tr>
<tr><td class="h"><a name="993"></a>993</td><td></td><td></td><td></td><td></td><td class="s"> </td></tr>
<tr><td class="h"><a name="994"></a>994</td><td></td><td></td><td></td><td></td><td class="s"> if ($response-&gt;is_success) {</td></tr>
<tr><td class="h"><a name="995"></a>995</td><td></td><td></td><td></td><td></td><td class="s">     print $response-&gt;decoded_content;  # or whatever</td></tr>
<tr><td class="h"><a name="996"></a>996</td><td></td><td></td><td></td><td></td><td class="s"> }</td></tr>
<tr><td class="h"><a name="997"></a>997</td><td></td><td></td><td></td><td></td><td class="s"> else {</td></tr>
<tr><td class="h"><a name="998"></a>998</td><td></td><td></td><td></td><td></td><td class="s">     die $response-&gt;status_line;</td></tr>
<tr><td class="h"><a name="999"></a>999</td><td></td><td></td><td></td><td></td><td class="s"> }</td></tr>
<tr><td class="h"><a name="1000"></a>1000</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1001"></a>1001</td><td></td><td></td><td></td><td></td><td class="s">=head1 DESCRIPTION</td></tr>
<tr><td class="h"><a name="1002"></a>1002</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1003"></a>1003</td><td></td><td></td><td></td><td></td><td class="s">The C&lt;LWP::UserAgent&gt; is a class implementing a web user agent.</td></tr>
<tr><td class="h"><a name="1004"></a>1004</td><td></td><td></td><td></td><td></td><td class="s">C&lt;LWP::UserAgent&gt; objects can be used to dispatch web requests.</td></tr>
<tr><td class="h"><a name="1005"></a>1005</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1006"></a>1006</td><td></td><td></td><td></td><td></td><td class="s">In normal use the application creates an C&lt;LWP::UserAgent&gt; object, and</td></tr>
<tr><td class="h"><a name="1007"></a>1007</td><td></td><td></td><td></td><td></td><td class="s">then configures it with values for timeouts, proxies, name, etc. It</td></tr>
<tr><td class="h"><a name="1008"></a>1008</td><td></td><td></td><td></td><td></td><td class="s">then creates an instance of C&lt;HTTP::Request&gt; for the request that</td></tr>
<tr><td class="h"><a name="1009"></a>1009</td><td></td><td></td><td></td><td></td><td class="s">needs to be performed. This request is then passed to one of the</td></tr>
<tr><td class="h"><a name="1010"></a>1010</td><td></td><td></td><td></td><td></td><td class="s">request method the UserAgent, which dispatches it using the relevant</td></tr>
<tr><td class="h"><a name="1011"></a>1011</td><td></td><td></td><td></td><td></td><td class="s">protocol, and returns a C&lt;HTTP::Response&gt; object.  There are</td></tr>
<tr><td class="h"><a name="1012"></a>1012</td><td></td><td></td><td></td><td></td><td class="s">convenience methods for sending the most common request types: get(),</td></tr>
<tr><td class="h"><a name="1013"></a>1013</td><td></td><td></td><td></td><td></td><td class="s">head() and post().  When using these methods then the creation of the</td></tr>
<tr><td class="h"><a name="1014"></a>1014</td><td></td><td></td><td></td><td></td><td class="s">request object is hidden as shown in the synopsis above.</td></tr>
<tr><td class="h"><a name="1015"></a>1015</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1016"></a>1016</td><td></td><td></td><td></td><td></td><td class="s">The basic approach of the library is to use HTTP style communication</td></tr>
<tr><td class="h"><a name="1017"></a>1017</td><td></td><td></td><td></td><td></td><td class="s">for all protocol schemes.  This means that you will construct</td></tr>
<tr><td class="h"><a name="1018"></a>1018</td><td></td><td></td><td></td><td></td><td class="s">C&lt;HTTP::Request&gt; objects and receive C&lt;HTTP::Response&gt; objects even</td></tr>
<tr><td class="h"><a name="1019"></a>1019</td><td></td><td></td><td></td><td></td><td class="s">for non-HTTP resources like I&lt;gopher&gt; and I&lt;ftp&gt;.  In order to achieve</td></tr>
<tr><td class="h"><a name="1020"></a>1020</td><td></td><td></td><td></td><td></td><td class="s">even more similarity to HTTP style communications, gopher menus and</td></tr>
<tr><td class="h"><a name="1021"></a>1021</td><td></td><td></td><td></td><td></td><td class="s">file directories are converted to HTML documents.</td></tr>
<tr><td class="h"><a name="1022"></a>1022</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1023"></a>1023</td><td></td><td></td><td></td><td></td><td class="s">=head1 CONSTRUCTOR METHODS</td></tr>
<tr><td class="h"><a name="1024"></a>1024</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1025"></a>1025</td><td></td><td></td><td></td><td></td><td class="s">The following constructor methods are available:</td></tr>
<tr><td class="h"><a name="1026"></a>1026</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1027"></a>1027</td><td></td><td></td><td></td><td></td><td class="s">=over 4</td></tr>
<tr><td class="h"><a name="1028"></a>1028</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1029"></a>1029</td><td></td><td></td><td></td><td></td><td class="s">=item $ua = LWP::UserAgent-&gt;new( %options )</td></tr>
<tr><td class="h"><a name="1030"></a>1030</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1031"></a>1031</td><td></td><td></td><td></td><td></td><td class="s">This method constructs a new C&lt;LWP::UserAgent&gt; object and returns it.</td></tr>
<tr><td class="h"><a name="1032"></a>1032</td><td></td><td></td><td></td><td></td><td class="s">Key/value pair arguments may be provided to set up the initial state.</td></tr>
<tr><td class="h"><a name="1033"></a>1033</td><td></td><td></td><td></td><td></td><td class="s">The following options correspond to attribute methods described below:</td></tr>
<tr><td class="h"><a name="1034"></a>1034</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1035"></a>1035</td><td></td><td></td><td></td><td></td><td class="s">   KEY                     DEFAULT</td></tr>
<tr><td class="h"><a name="1036"></a>1036</td><td></td><td></td><td></td><td></td><td class="s">   -----------             --------------------</td></tr>
<tr><td class="h"><a name="1037"></a>1037</td><td></td><td></td><td></td><td></td><td class="s">   agent                   &quot;libwww-perl/#.###&quot;</td></tr>
<tr><td class="h"><a name="1038"></a>1038</td><td></td><td></td><td></td><td></td><td class="s">   from                    undef</td></tr>
<tr><td class="h"><a name="1039"></a>1039</td><td></td><td></td><td></td><td></td><td class="s">   conn_cache              undef</td></tr>
<tr><td class="h"><a name="1040"></a>1040</td><td></td><td></td><td></td><td></td><td class="s">   cookie_jar              undef</td></tr>
<tr><td class="h"><a name="1041"></a>1041</td><td></td><td></td><td></td><td></td><td class="s">   default_headers         HTTP::Headers-&gt;new</td></tr>
<tr><td class="h"><a name="1042"></a>1042</td><td></td><td></td><td></td><td></td><td class="s">   local_address           undef</td></tr>
<tr><td class="h"><a name="1043"></a>1043</td><td></td><td></td><td></td><td></td><td class="s">   max_size                undef</td></tr>
<tr><td class="h"><a name="1044"></a>1044</td><td></td><td></td><td></td><td></td><td class="s">   max_redirect            7</td></tr>
<tr><td class="h"><a name="1045"></a>1045</td><td></td><td></td><td></td><td></td><td class="s">   parse_head              1</td></tr>
<tr><td class="h"><a name="1046"></a>1046</td><td></td><td></td><td></td><td></td><td class="s">   protocols_allowed       undef</td></tr>
<tr><td class="h"><a name="1047"></a>1047</td><td></td><td></td><td></td><td></td><td class="s">   protocols_forbidden     undef</td></tr>
<tr><td class="h"><a name="1048"></a>1048</td><td></td><td></td><td></td><td></td><td class="s">   requests_redirectable   ['GET', 'HEAD']</td></tr>
<tr><td class="h"><a name="1049"></a>1049</td><td></td><td></td><td></td><td></td><td class="s">   timeout                 180</td></tr>
<tr><td class="h"><a name="1050"></a>1050</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1051"></a>1051</td><td></td><td></td><td></td><td></td><td class="s">The following additional options are also accepted: If the</td></tr>
<tr><td class="h"><a name="1052"></a>1052</td><td></td><td></td><td></td><td></td><td class="s">C&lt;env_proxy&gt; option is passed in with a TRUE value, then proxy</td></tr>
<tr><td class="h"><a name="1053"></a>1053</td><td></td><td></td><td></td><td></td><td class="s">settings are read from environment variables (see env_proxy() method</td></tr>
<tr><td class="h"><a name="1054"></a>1054</td><td></td><td></td><td></td><td></td><td class="s">below).  If the C&lt;keep_alive&gt; option is passed in, then a</td></tr>
<tr><td class="h"><a name="1055"></a>1055</td><td></td><td></td><td></td><td></td><td class="s">C&lt;LWP::ConnCache&gt; is set up (see conn_cache() method below).  The</td></tr>
<tr><td class="h"><a name="1056"></a>1056</td><td></td><td></td><td></td><td></td><td class="s">C&lt;keep_alive&gt; value is passed on as the C&lt;total_capacity&gt; for the</td></tr>
<tr><td class="h"><a name="1057"></a>1057</td><td></td><td></td><td></td><td></td><td class="s">connection cache.</td></tr>
<tr><td class="h"><a name="1058"></a>1058</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1059"></a>1059</td><td></td><td></td><td></td><td></td><td class="s">=item $ua-&gt;clone</td></tr>
<tr><td class="h"><a name="1060"></a>1060</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1061"></a>1061</td><td></td><td></td><td></td><td></td><td class="s">Returns a copy of the LWP::UserAgent object.</td></tr>
<tr><td class="h"><a name="1062"></a>1062</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1063"></a>1063</td><td></td><td></td><td></td><td></td><td class="s">=back</td></tr>
<tr><td class="h"><a name="1064"></a>1064</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1065"></a>1065</td><td></td><td></td><td></td><td></td><td class="s">=head1 ATTRIBUTES</td></tr>
<tr><td class="h"><a name="1066"></a>1066</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1067"></a>1067</td><td></td><td></td><td></td><td></td><td class="s">The settings of the configuration attributes modify the behaviour of the</td></tr>
<tr><td class="h"><a name="1068"></a>1068</td><td></td><td></td><td></td><td></td><td class="s">C&lt;LWP::UserAgent&gt; when it dispatches requests.  Most of these can also</td></tr>
<tr><td class="h"><a name="1069"></a>1069</td><td></td><td></td><td></td><td></td><td class="s">be initialized by options passed to the constructor method.</td></tr>
<tr><td class="h"><a name="1070"></a>1070</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1071"></a>1071</td><td></td><td></td><td></td><td></td><td class="s">The following attribute methods are provided.  The attribute value is</td></tr>
<tr><td class="h"><a name="1072"></a>1072</td><td></td><td></td><td></td><td></td><td class="s">left unchanged if no argument is given.  The return value from each</td></tr>
<tr><td class="h"><a name="1073"></a>1073</td><td></td><td></td><td></td><td></td><td class="s">method is the old attribute value.</td></tr>
<tr><td class="h"><a name="1074"></a>1074</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1075"></a>1075</td><td></td><td></td><td></td><td></td><td class="s">=over</td></tr>
<tr><td class="h"><a name="1076"></a>1076</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1077"></a>1077</td><td></td><td></td><td></td><td></td><td class="s">=item $ua-&gt;agent</td></tr>
<tr><td class="h"><a name="1078"></a>1078</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1079"></a>1079</td><td></td><td></td><td></td><td></td><td class="s">=item $ua-&gt;agent( $product_id )</td></tr>
<tr><td class="h"><a name="1080"></a>1080</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1081"></a>1081</td><td></td><td></td><td></td><td></td><td class="s">Get/set the product token that is used to identify the user agent on</td></tr>
<tr><td class="h"><a name="1082"></a>1082</td><td></td><td></td><td></td><td></td><td class="s">the network.  The agent value is sent as the &quot;User-Agent&quot; header in</td></tr>
<tr><td class="h"><a name="1083"></a>1083</td><td></td><td></td><td></td><td></td><td class="s">the requests.  The default is the string returned by the _agent()</td></tr>
<tr><td class="h"><a name="1084"></a>1084</td><td></td><td></td><td></td><td></td><td class="s">method (see below).</td></tr>
<tr><td class="h"><a name="1085"></a>1085</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1086"></a>1086</td><td></td><td></td><td></td><td></td><td class="s">If the $product_id ends with space then the _agent() string is</td></tr>
<tr><td class="h"><a name="1087"></a>1087</td><td></td><td></td><td></td><td></td><td class="s">appended to it.</td></tr>
<tr><td class="h"><a name="1088"></a>1088</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1089"></a>1089</td><td></td><td></td><td></td><td></td><td class="s">The user agent string should be one or more simple product identifiers</td></tr>
<tr><td class="h"><a name="1090"></a>1090</td><td></td><td></td><td></td><td></td><td class="s">with an optional version number separated by the &quot;/&quot; character.</td></tr>
<tr><td class="h"><a name="1091"></a>1091</td><td></td><td></td><td></td><td></td><td class="s">Examples are:</td></tr>
<tr><td class="h"><a name="1092"></a>1092</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1093"></a>1093</td><td></td><td></td><td></td><td></td><td class="s">  $ua-&gt;agent('Checkbot/0.4 ' . $ua-&gt;_agent);</td></tr>
<tr><td class="h"><a name="1094"></a>1094</td><td></td><td></td><td></td><td></td><td class="s">  $ua-&gt;agent('Checkbot/0.4 ');    # same as above</td></tr>
<tr><td class="h"><a name="1095"></a>1095</td><td></td><td></td><td></td><td></td><td class="s">  $ua-&gt;agent('Mozilla/5.0');</td></tr>
<tr><td class="h"><a name="1096"></a>1096</td><td></td><td></td><td></td><td></td><td class="s">  $ua-&gt;agent(&quot;&quot;);                 # don't identify</td></tr>
<tr><td class="h"><a name="1097"></a>1097</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1098"></a>1098</td><td></td><td></td><td></td><td></td><td class="s">=item $ua-&gt;_agent</td></tr>
<tr><td class="h"><a name="1099"></a>1099</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1100"></a>1100</td><td></td><td></td><td></td><td></td><td class="s">Returns the default agent identifier.  This is a string of the form</td></tr>
<tr><td class="h"><a name="1101"></a>1101</td><td></td><td></td><td></td><td></td><td class="s">&quot;libwww-perl/#.###&quot;, where &quot;#.###&quot; is substituted with the version number</td></tr>
<tr><td class="h"><a name="1102"></a>1102</td><td></td><td></td><td></td><td></td><td class="s">of this library.</td></tr>
<tr><td class="h"><a name="1103"></a>1103</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1104"></a>1104</td><td></td><td></td><td></td><td></td><td class="s">=item $ua-&gt;from</td></tr>
<tr><td class="h"><a name="1105"></a>1105</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1106"></a>1106</td><td></td><td></td><td></td><td></td><td class="s">=item $ua-&gt;from( $email_address )</td></tr>
<tr><td class="h"><a name="1107"></a>1107</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1108"></a>1108</td><td></td><td></td><td></td><td></td><td class="s">Get/set the e-mail address for the human user who controls</td></tr>
<tr><td class="h"><a name="1109"></a>1109</td><td></td><td></td><td></td><td></td><td class="s">the requesting user agent.  The address should be machine-usable, as</td></tr>
<tr><td class="h"><a name="1110"></a>1110</td><td></td><td></td><td></td><td></td><td class="s">defined in RFC 822.  The C&lt;from&gt; value is send as the &quot;From&quot; header in</td></tr>
<tr><td class="h"><a name="1111"></a>1111</td><td></td><td></td><td></td><td></td><td class="s">the requests.  Example:</td></tr>
<tr><td class="h"><a name="1112"></a>1112</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1113"></a>1113</td><td></td><td></td><td></td><td></td><td class="s">  $ua-&gt;from('gaas@cpan.org');</td></tr>
<tr><td class="h"><a name="1114"></a>1114</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1115"></a>1115</td><td></td><td></td><td></td><td></td><td class="s">The default is to not send a &quot;From&quot; header.  See the default_headers()</td></tr>
<tr><td class="h"><a name="1116"></a>1116</td><td></td><td></td><td></td><td></td><td class="s">method for the more general interface that allow any header to be defaulted.</td></tr>
<tr><td class="h"><a name="1117"></a>1117</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1118"></a>1118</td><td></td><td></td><td></td><td></td><td class="s">=item $ua-&gt;cookie_jar</td></tr>
<tr><td class="h"><a name="1119"></a>1119</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1120"></a>1120</td><td></td><td></td><td></td><td></td><td class="s">=item $ua-&gt;cookie_jar( $cookie_jar_obj )</td></tr>
<tr><td class="h"><a name="1121"></a>1121</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1122"></a>1122</td><td></td><td></td><td></td><td></td><td class="s">Get/set the cookie jar object to use.  The only requirement is that</td></tr>
<tr><td class="h"><a name="1123"></a>1123</td><td></td><td></td><td></td><td></td><td class="s">the cookie jar object must implement the extract_cookies($request) and</td></tr>
<tr><td class="h"><a name="1124"></a>1124</td><td></td><td></td><td></td><td></td><td class="s">add_cookie_header($response) methods.  These methods will then be</td></tr>
<tr><td class="h"><a name="1125"></a>1125</td><td></td><td></td><td></td><td></td><td class="s">invoked by the user agent as requests are sent and responses are</td></tr>
<tr><td class="h"><a name="1126"></a>1126</td><td></td><td></td><td></td><td></td><td class="s">received.  Normally this will be a C&lt;HTTP::Cookies&gt; object or some</td></tr>
<tr><td class="h"><a name="1127"></a>1127</td><td></td><td></td><td></td><td></td><td class="s">subclass.</td></tr>
<tr><td class="h"><a name="1128"></a>1128</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1129"></a>1129</td><td></td><td></td><td></td><td></td><td class="s">The default is to have no cookie_jar, i.e. never automatically add</td></tr>
<tr><td class="h"><a name="1130"></a>1130</td><td></td><td></td><td></td><td></td><td class="s">&quot;Cookie&quot; headers to the requests.</td></tr>
<tr><td class="h"><a name="1131"></a>1131</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1132"></a>1132</td><td></td><td></td><td></td><td></td><td class="s">Shortcut: If a reference to a plain hash is passed in as the</td></tr>
<tr><td class="h"><a name="1133"></a>1133</td><td></td><td></td><td></td><td></td><td class="s">$cookie_jar_object, then it is replaced with an instance of</td></tr>
<tr><td class="h"><a name="1134"></a>1134</td><td></td><td></td><td></td><td></td><td class="s">C&lt;HTTP::Cookies&gt; that is initialized based on the hash.  This form also</td></tr>
<tr><td class="h"><a name="1135"></a>1135</td><td></td><td></td><td></td><td></td><td class="s">automatically loads the C&lt;HTTP::Cookies&gt; module.  It means that:</td></tr>
<tr><td class="h"><a name="1136"></a>1136</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1137"></a>1137</td><td></td><td></td><td></td><td></td><td class="s">  $ua-&gt;cookie_jar({ file =&gt; &quot;$ENV{HOME}/.cookies.txt&quot; });</td></tr>
<tr><td class="h"><a name="1138"></a>1138</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1139"></a>1139</td><td></td><td></td><td></td><td></td><td class="s">is really just a shortcut for:</td></tr>
<tr><td class="h"><a name="1140"></a>1140</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1141"></a>1141</td><td></td><td></td><td></td><td></td><td class="s">  require HTTP::Cookies;</td></tr>
<tr><td class="h"><a name="1142"></a>1142</td><td></td><td></td><td></td><td></td><td class="s">  $ua-&gt;cookie_jar(HTTP::Cookies-&gt;new(file =&gt; &quot;$ENV{HOME}/.cookies.txt&quot;));</td></tr>
<tr><td class="h"><a name="1143"></a>1143</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1144"></a>1144</td><td></td><td></td><td></td><td></td><td class="s">=item $ua-&gt;default_headers</td></tr>
<tr><td class="h"><a name="1145"></a>1145</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1146"></a>1146</td><td></td><td></td><td></td><td></td><td class="s">=item $ua-&gt;default_headers( $headers_obj )</td></tr>
<tr><td class="h"><a name="1147"></a>1147</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1148"></a>1148</td><td></td><td></td><td></td><td></td><td class="s">Get/set the headers object that will provide default header values for</td></tr>
<tr><td class="h"><a name="1149"></a>1149</td><td></td><td></td><td></td><td></td><td class="s">any requests sent.  By default this will be an empty C&lt;HTTP::Headers&gt;</td></tr>
<tr><td class="h"><a name="1150"></a>1150</td><td></td><td></td><td></td><td></td><td class="s">object.</td></tr>
<tr><td class="h"><a name="1151"></a>1151</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1152"></a>1152</td><td></td><td></td><td></td><td></td><td class="s">=item $ua-&gt;default_header( $field )</td></tr>
<tr><td class="h"><a name="1153"></a>1153</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1154"></a>1154</td><td></td><td></td><td></td><td></td><td class="s">=item $ua-&gt;default_header( $field =&gt; $value )</td></tr>
<tr><td class="h"><a name="1155"></a>1155</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1156"></a>1156</td><td></td><td></td><td></td><td></td><td class="s">This is just a short-cut for $ua-&gt;default_headers-&gt;header( $field =&gt;</td></tr>
<tr><td class="h"><a name="1157"></a>1157</td><td></td><td></td><td></td><td></td><td class="s">$value ). Example:</td></tr>
<tr><td class="h"><a name="1158"></a>1158</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1159"></a>1159</td><td></td><td></td><td></td><td></td><td class="s">  $ua-&gt;default_header('Accept-Encoding' =&gt; scalar HTTP::Message::decodable());</td></tr>
<tr><td class="h"><a name="1160"></a>1160</td><td></td><td></td><td></td><td></td><td class="s">  $ua-&gt;default_header('Accept-Language' =&gt; &quot;no, en&quot;);</td></tr>
<tr><td class="h"><a name="1161"></a>1161</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1162"></a>1162</td><td></td><td></td><td></td><td></td><td class="s">=item $ua-&gt;conn_cache</td></tr>
<tr><td class="h"><a name="1163"></a>1163</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1164"></a>1164</td><td></td><td></td><td></td><td></td><td class="s">=item $ua-&gt;conn_cache( $cache_obj )</td></tr>
<tr><td class="h"><a name="1165"></a>1165</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1166"></a>1166</td><td></td><td></td><td></td><td></td><td class="s">Get/set the C&lt;LWP::ConnCache&gt; object to use.  See L&lt;LWP::ConnCache&gt;</td></tr>
<tr><td class="h"><a name="1167"></a>1167</td><td></td><td></td><td></td><td></td><td class="s">for details.</td></tr>
<tr><td class="h"><a name="1168"></a>1168</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1169"></a>1169</td><td></td><td></td><td></td><td></td><td class="s">=item $ua-&gt;credentials( $netloc, $realm )</td></tr>
<tr><td class="h"><a name="1170"></a>1170</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1171"></a>1171</td><td></td><td></td><td></td><td></td><td class="s">=item $ua-&gt;credentials( $netloc, $realm, $uname, $pass )</td></tr>
<tr><td class="h"><a name="1172"></a>1172</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1173"></a>1173</td><td></td><td></td><td></td><td></td><td class="s">Get/set the user name and password to be used for a realm.</td></tr>
<tr><td class="h"><a name="1174"></a>1174</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1175"></a>1175</td><td></td><td></td><td></td><td></td><td class="s">The $netloc is a string of the form &quot;&lt;host&gt;:&lt;port&gt;&quot;.  The username and</td></tr>
<tr><td class="h"><a name="1176"></a>1176</td><td></td><td></td><td></td><td></td><td class="s">password will only be passed to this server.  Example:</td></tr>
<tr><td class="h"><a name="1177"></a>1177</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1178"></a>1178</td><td></td><td></td><td></td><td></td><td class="s">  $ua-&gt;credentials(&quot;www.example.com:80&quot;, &quot;Some Realm&quot;, &quot;foo&quot;, &quot;secret&quot;);</td></tr>
<tr><td class="h"><a name="1179"></a>1179</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1180"></a>1180</td><td></td><td></td><td></td><td></td><td class="s">=item $ua-&gt;local_address</td></tr>
<tr><td class="h"><a name="1181"></a>1181</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1182"></a>1182</td><td></td><td></td><td></td><td></td><td class="s">=item $ua-&gt;local_address( $address )</td></tr>
<tr><td class="h"><a name="1183"></a>1183</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1184"></a>1184</td><td></td><td></td><td></td><td></td><td class="s">Get/set the local interface to bind to for network connections.  The interface</td></tr>
<tr><td class="h"><a name="1185"></a>1185</td><td></td><td></td><td></td><td></td><td class="s">can be specified as a hostname or an IP address.  This value is passed as the</td></tr>
<tr><td class="h"><a name="1186"></a>1186</td><td></td><td></td><td></td><td></td><td class="s">C&lt;LocalAddr&gt; argument to L&lt;IO::Socket::INET&gt;.</td></tr>
<tr><td class="h"><a name="1187"></a>1187</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1188"></a>1188</td><td></td><td></td><td></td><td></td><td class="s">=item $ua-&gt;max_size</td></tr>
<tr><td class="h"><a name="1189"></a>1189</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1190"></a>1190</td><td></td><td></td><td></td><td></td><td class="s">=item $ua-&gt;max_size( $bytes )</td></tr>
<tr><td class="h"><a name="1191"></a>1191</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1192"></a>1192</td><td></td><td></td><td></td><td></td><td class="s">Get/set the size limit for response content.  The default is C&lt;undef&gt;,</td></tr>
<tr><td class="h"><a name="1193"></a>1193</td><td></td><td></td><td></td><td></td><td class="s">which means that there is no limit.  If the returned response content</td></tr>
<tr><td class="h"><a name="1194"></a>1194</td><td></td><td></td><td></td><td></td><td class="s">is only partial, because the size limit was exceeded, then a</td></tr>
<tr><td class="h"><a name="1195"></a>1195</td><td></td><td></td><td></td><td></td><td class="s">&quot;Client-Aborted&quot; header will be added to the response.  The content</td></tr>
<tr><td class="h"><a name="1196"></a>1196</td><td></td><td></td><td></td><td></td><td class="s">might end up longer than C&lt;max_size&gt; as we abort once appending a</td></tr>
<tr><td class="h"><a name="1197"></a>1197</td><td></td><td></td><td></td><td></td><td class="s">chunk of data makes the length exceed the limit.  The &quot;Content-Length&quot;</td></tr>
<tr><td class="h"><a name="1198"></a>1198</td><td></td><td></td><td></td><td></td><td class="s">header, if present, will indicate the length of the full content and</td></tr>
<tr><td class="h"><a name="1199"></a>1199</td><td></td><td></td><td></td><td></td><td class="s">will normally not be the same as C&lt;&lt; length($res-&gt;content) &gt;&gt;.</td></tr>
<tr><td class="h"><a name="1200"></a>1200</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1201"></a>1201</td><td></td><td></td><td></td><td></td><td class="s">=item $ua-&gt;max_redirect</td></tr>
<tr><td class="h"><a name="1202"></a>1202</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1203"></a>1203</td><td></td><td></td><td></td><td></td><td class="s">=item $ua-&gt;max_redirect( $n )</td></tr>
<tr><td class="h"><a name="1204"></a>1204</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1205"></a>1205</td><td></td><td></td><td></td><td></td><td class="s">This reads or sets the object's limit of how many times it will obey</td></tr>
<tr><td class="h"><a name="1206"></a>1206</td><td></td><td></td><td></td><td></td><td class="s">redirection responses in a given request cycle.</td></tr>
<tr><td class="h"><a name="1207"></a>1207</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1208"></a>1208</td><td></td><td></td><td></td><td></td><td class="s">By default, the value is 7. This means that if you call request()</td></tr>
<tr><td class="h"><a name="1209"></a>1209</td><td></td><td></td><td></td><td></td><td class="s">method and the response is a redirect elsewhere which is in turn a</td></tr>
<tr><td class="h"><a name="1210"></a>1210</td><td></td><td></td><td></td><td></td><td class="s">redirect, and so on seven times, then LWP gives up after that seventh</td></tr>
<tr><td class="h"><a name="1211"></a>1211</td><td></td><td></td><td></td><td></td><td class="s">request.</td></tr>
<tr><td class="h"><a name="1212"></a>1212</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1213"></a>1213</td><td></td><td></td><td></td><td></td><td class="s">=item $ua-&gt;parse_head</td></tr>
<tr><td class="h"><a name="1214"></a>1214</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1215"></a>1215</td><td></td><td></td><td></td><td></td><td class="s">=item $ua-&gt;parse_head( $boolean )</td></tr>
<tr><td class="h"><a name="1216"></a>1216</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1217"></a>1217</td><td></td><td></td><td></td><td></td><td class="s">Get/set a value indicating whether we should initialize response</td></tr>
<tr><td class="h"><a name="1218"></a>1218</td><td></td><td></td><td></td><td></td><td class="s">headers from the E&lt;lt&gt;head&gt; section of HTML documents. The default is</td></tr>
<tr><td class="h"><a name="1219"></a>1219</td><td></td><td></td><td></td><td></td><td class="s">TRUE.  Do not turn this off, unless you know what you are doing.</td></tr>
<tr><td class="h"><a name="1220"></a>1220</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1221"></a>1221</td><td></td><td></td><td></td><td></td><td class="s">=item $ua-&gt;protocols_allowed</td></tr>
<tr><td class="h"><a name="1222"></a>1222</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1223"></a>1223</td><td></td><td></td><td></td><td></td><td class="s">=item $ua-&gt;protocols_allowed( \@protocols )</td></tr>
<tr><td class="h"><a name="1224"></a>1224</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1225"></a>1225</td><td></td><td></td><td></td><td></td><td class="s">This reads (or sets) this user agent's list of protocols that the</td></tr>
<tr><td class="h"><a name="1226"></a>1226</td><td></td><td></td><td></td><td></td><td class="s">request methods will exclusively allow.  The protocol names are case</td></tr>
<tr><td class="h"><a name="1227"></a>1227</td><td></td><td></td><td></td><td></td><td class="s">insensitive.</td></tr>
<tr><td class="h"><a name="1228"></a>1228</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1229"></a>1229</td><td></td><td></td><td></td><td></td><td class="s">For example: C&lt;$ua-E&lt;gt&gt;protocols_allowed( [ 'http', 'https'] );&gt;</td></tr>
<tr><td class="h"><a name="1230"></a>1230</td><td></td><td></td><td></td><td></td><td class="s">means that this user agent will I&lt;allow only&gt; those protocols,</td></tr>
<tr><td class="h"><a name="1231"></a>1231</td><td></td><td></td><td></td><td></td><td class="s">and attempts to use this user agent to access URLs with any other</td></tr>
<tr><td class="h"><a name="1232"></a>1232</td><td></td><td></td><td></td><td></td><td class="s">schemes (like &quot;ftp://...&quot;) will result in a 500 error.</td></tr>
<tr><td class="h"><a name="1233"></a>1233</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1234"></a>1234</td><td></td><td></td><td></td><td></td><td class="s">To delete the list, call: C&lt;$ua-E&lt;gt&gt;protocols_allowed(undef)&gt;</td></tr>
<tr><td class="h"><a name="1235"></a>1235</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1236"></a>1236</td><td></td><td></td><td></td><td></td><td class="s">By default, an object has neither a C&lt;protocols_allowed&gt; list, nor a</td></tr>
<tr><td class="h"><a name="1237"></a>1237</td><td></td><td></td><td></td><td></td><td class="s">C&lt;protocols_forbidden&gt; list.</td></tr>
<tr><td class="h"><a name="1238"></a>1238</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1239"></a>1239</td><td></td><td></td><td></td><td></td><td class="s">Note that having a C&lt;protocols_allowed&gt; list causes any</td></tr>
<tr><td class="h"><a name="1240"></a>1240</td><td></td><td></td><td></td><td></td><td class="s">C&lt;protocols_forbidden&gt; list to be ignored.</td></tr>
<tr><td class="h"><a name="1241"></a>1241</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1242"></a>1242</td><td></td><td></td><td></td><td></td><td class="s">=item $ua-&gt;protocols_forbidden</td></tr>
<tr><td class="h"><a name="1243"></a>1243</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1244"></a>1244</td><td></td><td></td><td></td><td></td><td class="s">=item $ua-&gt;protocols_forbidden( \@protocols )</td></tr>
<tr><td class="h"><a name="1245"></a>1245</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1246"></a>1246</td><td></td><td></td><td></td><td></td><td class="s">This reads (or sets) this user agent's list of protocols that the</td></tr>
<tr><td class="h"><a name="1247"></a>1247</td><td></td><td></td><td></td><td></td><td class="s">request method will I&lt;not&gt; allow. The protocol names are case</td></tr>
<tr><td class="h"><a name="1248"></a>1248</td><td></td><td></td><td></td><td></td><td class="s">insensitive.</td></tr>
<tr><td class="h"><a name="1249"></a>1249</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1250"></a>1250</td><td></td><td></td><td></td><td></td><td class="s">For example: C&lt;$ua-E&lt;gt&gt;protocols_forbidden( [ 'file', 'mailto'] );&gt;</td></tr>
<tr><td class="h"><a name="1251"></a>1251</td><td></td><td></td><td></td><td></td><td class="s">means that this user agent will I&lt;not&gt; allow those protocols, and</td></tr>
<tr><td class="h"><a name="1252"></a>1252</td><td></td><td></td><td></td><td></td><td class="s">attempts to use this user agent to access URLs with those schemes</td></tr>
<tr><td class="h"><a name="1253"></a>1253</td><td></td><td></td><td></td><td></td><td class="s">will result in a 500 error.</td></tr>
<tr><td class="h"><a name="1254"></a>1254</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1255"></a>1255</td><td></td><td></td><td></td><td></td><td class="s">To delete the list, call: C&lt;$ua-E&lt;gt&gt;protocols_forbidden(undef)&gt;</td></tr>
<tr><td class="h"><a name="1256"></a>1256</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1257"></a>1257</td><td></td><td></td><td></td><td></td><td class="s">=item $ua-&gt;requests_redirectable</td></tr>
<tr><td class="h"><a name="1258"></a>1258</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1259"></a>1259</td><td></td><td></td><td></td><td></td><td class="s">=item $ua-&gt;requests_redirectable( \@requests )</td></tr>
<tr><td class="h"><a name="1260"></a>1260</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1261"></a>1261</td><td></td><td></td><td></td><td></td><td class="s">This reads or sets the object's list of request names that</td></tr>
<tr><td class="h"><a name="1262"></a>1262</td><td></td><td></td><td></td><td></td><td class="s">C&lt;$ua-E&lt;gt&gt;redirect_ok(...)&gt; will allow redirection for.  By</td></tr>
<tr><td class="h"><a name="1263"></a>1263</td><td></td><td></td><td></td><td></td><td class="s">default, this is C&lt;['GET', 'HEAD']&gt;, as per RFC 2616.  To</td></tr>
<tr><td class="h"><a name="1264"></a>1264</td><td></td><td></td><td></td><td></td><td class="s">change to include 'POST', consider:</td></tr>
<tr><td class="h"><a name="1265"></a>1265</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1266"></a>1266</td><td></td><td></td><td></td><td></td><td class="s">   push @{ $ua-&gt;requests_redirectable }, 'POST';</td></tr>
<tr><td class="h"><a name="1267"></a>1267</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1268"></a>1268</td><td></td><td></td><td></td><td></td><td class="s">=item $ua-&gt;show_progress</td></tr>
<tr><td class="h"><a name="1269"></a>1269</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1270"></a>1270</td><td></td><td></td><td></td><td></td><td class="s">=item $ua-&gt;show_progress( $boolean )</td></tr>
<tr><td class="h"><a name="1271"></a>1271</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1272"></a>1272</td><td></td><td></td><td></td><td></td><td class="s">Get/set a value indicating whether a progress bar should be displayed</td></tr>
<tr><td class="h"><a name="1273"></a>1273</td><td></td><td></td><td></td><td></td><td class="s">on on the terminal as requests are processed. The default is FALSE.</td></tr>
<tr><td class="h"><a name="1274"></a>1274</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1275"></a>1275</td><td></td><td></td><td></td><td></td><td class="s">=item $ua-&gt;timeout</td></tr>
<tr><td class="h"><a name="1276"></a>1276</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1277"></a>1277</td><td></td><td></td><td></td><td></td><td class="s">=item $ua-&gt;timeout( $secs )</td></tr>
<tr><td class="h"><a name="1278"></a>1278</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1279"></a>1279</td><td></td><td></td><td></td><td></td><td class="s">Get/set the timeout value in seconds. The default timeout() value is</td></tr>
<tr><td class="h"><a name="1280"></a>1280</td><td></td><td></td><td></td><td></td><td class="s">180 seconds, i.e. 3 minutes.</td></tr>
<tr><td class="h"><a name="1281"></a>1281</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1282"></a>1282</td><td></td><td></td><td></td><td></td><td class="s">The requests is aborted if no activity on the connection to the server</td></tr>
<tr><td class="h"><a name="1283"></a>1283</td><td></td><td></td><td></td><td></td><td class="s">is observed for C&lt;timeout&gt; seconds.  This means that the time it takes</td></tr>
<tr><td class="h"><a name="1284"></a>1284</td><td></td><td></td><td></td><td></td><td class="s">for the complete transaction and the request() method to actually</td></tr>
<tr><td class="h"><a name="1285"></a>1285</td><td></td><td></td><td></td><td></td><td class="s">return might be longer.</td></tr>
<tr><td class="h"><a name="1286"></a>1286</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1287"></a>1287</td><td></td><td></td><td></td><td></td><td class="s">=back</td></tr>
<tr><td class="h"><a name="1288"></a>1288</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1289"></a>1289</td><td></td><td></td><td></td><td></td><td class="s">=head2 Proxy attributes</td></tr>
<tr><td class="h"><a name="1290"></a>1290</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1291"></a>1291</td><td></td><td></td><td></td><td></td><td class="s">The following methods set up when requests should be passed via a</td></tr>
<tr><td class="h"><a name="1292"></a>1292</td><td></td><td></td><td></td><td></td><td class="s">proxy server.</td></tr>
<tr><td class="h"><a name="1293"></a>1293</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1294"></a>1294</td><td></td><td></td><td></td><td></td><td class="s">=over</td></tr>
<tr><td class="h"><a name="1295"></a>1295</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1296"></a>1296</td><td></td><td></td><td></td><td></td><td class="s">=item $ua-&gt;proxy(\@schemes, $proxy_url)</td></tr>
<tr><td class="h"><a name="1297"></a>1297</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1298"></a>1298</td><td></td><td></td><td></td><td></td><td class="s">=item $ua-&gt;proxy($scheme, $proxy_url)</td></tr>
<tr><td class="h"><a name="1299"></a>1299</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1300"></a>1300</td><td></td><td></td><td></td><td></td><td class="s">Set/retrieve proxy URL for a scheme:</td></tr>
<tr><td class="h"><a name="1301"></a>1301</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1302"></a>1302</td><td></td><td></td><td></td><td></td><td class="s"> $ua-&gt;proxy(['http', 'ftp'], 'http://proxy.sn.no:8001/');</td></tr>
<tr><td class="h"><a name="1303"></a>1303</td><td></td><td></td><td></td><td></td><td class="s"> $ua-&gt;proxy('gopher', 'http://proxy.sn.no:8001/');</td></tr>
<tr><td class="h"><a name="1304"></a>1304</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1305"></a>1305</td><td></td><td></td><td></td><td></td><td class="s">The first form specifies that the URL is to be used for proxying of</td></tr>
<tr><td class="h"><a name="1306"></a>1306</td><td></td><td></td><td></td><td></td><td class="s">access methods listed in the list in the first method argument,</td></tr>
<tr><td class="h"><a name="1307"></a>1307</td><td></td><td></td><td></td><td></td><td class="s">i.e. 'http' and 'ftp'.</td></tr>
<tr><td class="h"><a name="1308"></a>1308</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1309"></a>1309</td><td></td><td></td><td></td><td></td><td class="s">The second form shows a shorthand form for specifying</td></tr>
<tr><td class="h"><a name="1310"></a>1310</td><td></td><td></td><td></td><td></td><td class="s">proxy URL for a single access scheme.</td></tr>
<tr><td class="h"><a name="1311"></a>1311</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1312"></a>1312</td><td></td><td></td><td></td><td></td><td class="s">=item $ua-&gt;no_proxy( $domain, ... )</td></tr>
<tr><td class="h"><a name="1313"></a>1313</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1314"></a>1314</td><td></td><td></td><td></td><td></td><td class="s">Do not proxy requests to the given domains.  Calling no_proxy without</td></tr>
<tr><td class="h"><a name="1315"></a>1315</td><td></td><td></td><td></td><td></td><td class="s">any domains clears the list of domains. Eg:</td></tr>
<tr><td class="h"><a name="1316"></a>1316</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1317"></a>1317</td><td></td><td></td><td></td><td></td><td class="s"> $ua-&gt;no_proxy('localhost', 'example.com');</td></tr>
<tr><td class="h"><a name="1318"></a>1318</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1319"></a>1319</td><td></td><td></td><td></td><td></td><td class="s">=item $ua-&gt;env_proxy</td></tr>
<tr><td class="h"><a name="1320"></a>1320</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1321"></a>1321</td><td></td><td></td><td></td><td></td><td class="s">Load proxy settings from *_proxy environment variables.  You might</td></tr>
<tr><td class="h"><a name="1322"></a>1322</td><td></td><td></td><td></td><td></td><td class="s">specify proxies like this (sh-syntax):</td></tr>
<tr><td class="h"><a name="1323"></a>1323</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1324"></a>1324</td><td></td><td></td><td></td><td></td><td class="s">  gopher_proxy=http://proxy.my.place/</td></tr>
<tr><td class="h"><a name="1325"></a>1325</td><td></td><td></td><td></td><td></td><td class="s">  wais_proxy=http://proxy.my.place/</td></tr>
<tr><td class="h"><a name="1326"></a>1326</td><td></td><td></td><td></td><td></td><td class="s">  no_proxy=&quot;localhost,example.com&quot;</td></tr>
<tr><td class="h"><a name="1327"></a>1327</td><td></td><td></td><td></td><td></td><td class="s">  export gopher_proxy wais_proxy no_proxy</td></tr>
<tr><td class="h"><a name="1328"></a>1328</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1329"></a>1329</td><td></td><td></td><td></td><td></td><td class="s">csh or tcsh users should use the C&lt;setenv&gt; command to define these</td></tr>
<tr><td class="h"><a name="1330"></a>1330</td><td></td><td></td><td></td><td></td><td class="s">environment variables.</td></tr>
<tr><td class="h"><a name="1331"></a>1331</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1332"></a>1332</td><td></td><td></td><td></td><td></td><td class="s">On systems with case insensitive environment variables there exists a</td></tr>
<tr><td class="h"><a name="1333"></a>1333</td><td></td><td></td><td></td><td></td><td class="s">name clash between the CGI environment variables and the C&lt;HTTP_PROXY&gt;</td></tr>
<tr><td class="h"><a name="1334"></a>1334</td><td></td><td></td><td></td><td></td><td class="s">environment variable normally picked up by env_proxy().  Because of</td></tr>
<tr><td class="h"><a name="1335"></a>1335</td><td></td><td></td><td></td><td></td><td class="s">this C&lt;HTTP_PROXY&gt; is not honored for CGI scripts.  The</td></tr>
<tr><td class="h"><a name="1336"></a>1336</td><td></td><td></td><td></td><td></td><td class="s">C&lt;CGI_HTTP_PROXY&gt; environment variable can be used instead.</td></tr>
<tr><td class="h"><a name="1337"></a>1337</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1338"></a>1338</td><td></td><td></td><td></td><td></td><td class="s">=back</td></tr>
<tr><td class="h"><a name="1339"></a>1339</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1340"></a>1340</td><td></td><td></td><td></td><td></td><td class="s">=head2 Handlers</td></tr>
<tr><td class="h"><a name="1341"></a>1341</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1342"></a>1342</td><td></td><td></td><td></td><td></td><td class="s">Handlers are code that injected at various phases during the</td></tr>
<tr><td class="h"><a name="1343"></a>1343</td><td></td><td></td><td></td><td></td><td class="s">processing of requests.  The following methods are provided to manage</td></tr>
<tr><td class="h"><a name="1344"></a>1344</td><td></td><td></td><td></td><td></td><td class="s">the active handlers:</td></tr>
<tr><td class="h"><a name="1345"></a>1345</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1346"></a>1346</td><td></td><td></td><td></td><td></td><td class="s">=over</td></tr>
<tr><td class="h"><a name="1347"></a>1347</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1348"></a>1348</td><td></td><td></td><td></td><td></td><td class="s">=item $ua-&gt;add_handler( $phase =&gt; \&amp;cb, %matchspec )</td></tr>
<tr><td class="h"><a name="1349"></a>1349</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1350"></a>1350</td><td></td><td></td><td></td><td></td><td class="s">Add handler to be invoked in the given processing phase.  For how to</td></tr>
<tr><td class="h"><a name="1351"></a>1351</td><td></td><td></td><td></td><td></td><td class="s">specify %matchspec see L&lt;HTTP::Config/&quot;Matching&quot;&gt;.</td></tr>
<tr><td class="h"><a name="1352"></a>1352</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1353"></a>1353</td><td></td><td></td><td></td><td></td><td class="s">The possible values $phase and the corresponding callback signatures are:</td></tr>
<tr><td class="h"><a name="1354"></a>1354</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1355"></a>1355</td><td></td><td></td><td></td><td></td><td class="s">=over</td></tr>
<tr><td class="h"><a name="1356"></a>1356</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1357"></a>1357</td><td></td><td></td><td></td><td></td><td class="s">=item request_preprepare =&gt; sub { my($request, $ua, $h) = @_; ... }</td></tr>
<tr><td class="h"><a name="1358"></a>1358</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1359"></a>1359</td><td></td><td></td><td></td><td></td><td class="s">The handler is called before the C&lt;request_prepare&gt; and other standard</td></tr>
<tr><td class="h"><a name="1360"></a>1360</td><td></td><td></td><td></td><td></td><td class="s">initialization of of the request.  This can be used to set up headers</td></tr>
<tr><td class="h"><a name="1361"></a>1361</td><td></td><td></td><td></td><td></td><td class="s">and attributes that the C&lt;request_prepare&gt; handler depends on.  Proxy</td></tr>
<tr><td class="h"><a name="1362"></a>1362</td><td></td><td></td><td></td><td></td><td class="s">initialization should take place here; but in general don't register</td></tr>
<tr><td class="h"><a name="1363"></a>1363</td><td></td><td></td><td></td><td></td><td class="s">handlers for this phase.</td></tr>
<tr><td class="h"><a name="1364"></a>1364</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1365"></a>1365</td><td></td><td></td><td></td><td></td><td class="s">=item request_prepare =&gt; sub { my($request, $ua, $h) = @_; ... }</td></tr>
<tr><td class="h"><a name="1366"></a>1366</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1367"></a>1367</td><td></td><td></td><td></td><td></td><td class="s">The handler is called before the request is sent and can modify the</td></tr>
<tr><td class="h"><a name="1368"></a>1368</td><td></td><td></td><td></td><td></td><td class="s">request any way it see fit.  This can for instance be used to add</td></tr>
<tr><td class="h"><a name="1369"></a>1369</td><td></td><td></td><td></td><td></td><td class="s">certain headers to specific requests.</td></tr>
<tr><td class="h"><a name="1370"></a>1370</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1371"></a>1371</td><td></td><td></td><td></td><td></td><td class="s">The method can assign a new request object to $_[0] to replace the</td></tr>
<tr><td class="h"><a name="1372"></a>1372</td><td></td><td></td><td></td><td></td><td class="s">request that is sent fully.</td></tr>
<tr><td class="h"><a name="1373"></a>1373</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1374"></a>1374</td><td></td><td></td><td></td><td></td><td class="s">The return value from the callback is ignored.  If an exceptions is</td></tr>
<tr><td class="h"><a name="1375"></a>1375</td><td></td><td></td><td></td><td></td><td class="s">raised it will abort the request and make the request method return a</td></tr>
<tr><td class="h"><a name="1376"></a>1376</td><td></td><td></td><td></td><td></td><td class="s">&quot;400 Bad request&quot; response.</td></tr>
<tr><td class="h"><a name="1377"></a>1377</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1378"></a>1378</td><td></td><td></td><td></td><td></td><td class="s">=item request_send =&gt; sub { my($request, $ua, $h) = @_; ... }</td></tr>
<tr><td class="h"><a name="1379"></a>1379</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1380"></a>1380</td><td></td><td></td><td></td><td></td><td class="s">This handler get a chance of handling requests before it's sent to the</td></tr>
<tr><td class="h"><a name="1381"></a>1381</td><td></td><td></td><td></td><td></td><td class="s">protocol handlers.  It should return an HTTP::Response object if it</td></tr>
<tr><td class="h"><a name="1382"></a>1382</td><td></td><td></td><td></td><td></td><td class="s">wishes to terminate the processing; otherwise it should return nothing.</td></tr>
<tr><td class="h"><a name="1383"></a>1383</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1384"></a>1384</td><td></td><td></td><td></td><td></td><td class="s">The C&lt;response_header&gt; and C&lt;response_data&gt; handlers will not be</td></tr>
<tr><td class="h"><a name="1385"></a>1385</td><td></td><td></td><td></td><td></td><td class="s">invoked for this response, but the C&lt;response_done&gt; will be.</td></tr>
<tr><td class="h"><a name="1386"></a>1386</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1387"></a>1387</td><td></td><td></td><td></td><td></td><td class="s">=item response_header =&gt; sub { my($response, $ua, $h) = @_; ... }</td></tr>
<tr><td class="h"><a name="1388"></a>1388</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1389"></a>1389</td><td></td><td></td><td></td><td></td><td class="s">This handler is called right after the response headers have been</td></tr>
<tr><td class="h"><a name="1390"></a>1390</td><td></td><td></td><td></td><td></td><td class="s">received, but before any content data.  The handler might set up</td></tr>
<tr><td class="h"><a name="1391"></a>1391</td><td></td><td></td><td></td><td></td><td class="s">handlers for data and might croak to abort the request.</td></tr>
<tr><td class="h"><a name="1392"></a>1392</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1393"></a>1393</td><td></td><td></td><td></td><td></td><td class="s">The handler might set the $response-&gt;{default_add_content} value to</td></tr>
<tr><td class="h"><a name="1394"></a>1394</td><td></td><td></td><td></td><td></td><td class="s">control if any received data should be added to the response object</td></tr>
<tr><td class="h"><a name="1395"></a>1395</td><td></td><td></td><td></td><td></td><td class="s">directly.  This will initially be false if the $ua-&gt;request() method</td></tr>
<tr><td class="h"><a name="1396"></a>1396</td><td></td><td></td><td></td><td></td><td class="s">was called with a ':content_filename' or ':content_callbak' argument;</td></tr>
<tr><td class="h"><a name="1397"></a>1397</td><td></td><td></td><td></td><td></td><td class="s">otherwise true.</td></tr>
<tr><td class="h"><a name="1398"></a>1398</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1399"></a>1399</td><td></td><td></td><td></td><td></td><td class="s">=item response_data =&gt; sub { my($response, $ua, $h, $data) = @_; ... }</td></tr>
<tr><td class="h"><a name="1400"></a>1400</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1401"></a>1401</td><td></td><td></td><td></td><td></td><td class="s">This handlers is called for each chunk of data received for the</td></tr>
<tr><td class="h"><a name="1402"></a>1402</td><td></td><td></td><td></td><td></td><td class="s">response.  The handler might croak to abort the request.</td></tr>
<tr><td class="h"><a name="1403"></a>1403</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1404"></a>1404</td><td></td><td></td><td></td><td></td><td class="s">This handler need to return a TRUE value to be called again for</td></tr>
<tr><td class="h"><a name="1405"></a>1405</td><td></td><td></td><td></td><td></td><td class="s">subsequent chunks for the same request.</td></tr>
<tr><td class="h"><a name="1406"></a>1406</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1407"></a>1407</td><td></td><td></td><td></td><td></td><td class="s">=item response_done =&gt; sub { my($response, $ua, $h) = @_; ... }</td></tr>
<tr><td class="h"><a name="1408"></a>1408</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1409"></a>1409</td><td></td><td></td><td></td><td></td><td class="s">The handler is called after the response has been fully received, but</td></tr>
<tr><td class="h"><a name="1410"></a>1410</td><td></td><td></td><td></td><td></td><td class="s">before any redirect handling is attempted.  The handler can be used to</td></tr>
<tr><td class="h"><a name="1411"></a>1411</td><td></td><td></td><td></td><td></td><td class="s">extract information or modify the response.</td></tr>
<tr><td class="h"><a name="1412"></a>1412</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1413"></a>1413</td><td></td><td></td><td></td><td></td><td class="s">=item response_redirect =&gt; sub { my($response, $ua, $h) = @_; ... }</td></tr>
<tr><td class="h"><a name="1414"></a>1414</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1415"></a>1415</td><td></td><td></td><td></td><td></td><td class="s">The handler is called in $ua-&gt;request after C&lt;response_done&gt;.  If the</td></tr>
<tr><td class="h"><a name="1416"></a>1416</td><td></td><td></td><td></td><td></td><td class="s">handler return an HTTP::Request object we'll start over with processing</td></tr>
<tr><td class="h"><a name="1417"></a>1417</td><td></td><td></td><td></td><td></td><td class="s">this request instead.</td></tr>
<tr><td class="h"><a name="1418"></a>1418</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1419"></a>1419</td><td></td><td></td><td></td><td></td><td class="s">=back</td></tr>
<tr><td class="h"><a name="1420"></a>1420</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1421"></a>1421</td><td></td><td></td><td></td><td></td><td class="s">=item $ua-&gt;remove_handler( undef, %matchspec )</td></tr>
<tr><td class="h"><a name="1422"></a>1422</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1423"></a>1423</td><td></td><td></td><td></td><td></td><td class="s">=item $ua-&gt;remove_handler( $phase, %matchspec )</td></tr>
<tr><td class="h"><a name="1424"></a>1424</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1425"></a>1425</td><td></td><td></td><td></td><td></td><td class="s">Remove handlers that match the given %matchspec.  If $phase is not</td></tr>
<tr><td class="h"><a name="1426"></a>1426</td><td></td><td></td><td></td><td></td><td class="s">provided remove handlers from all phases.</td></tr>
<tr><td class="h"><a name="1427"></a>1427</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1428"></a>1428</td><td></td><td></td><td></td><td></td><td class="s">Be careful as calling this function with %matchspec that is not not</td></tr>
<tr><td class="h"><a name="1429"></a>1429</td><td></td><td></td><td></td><td></td><td class="s">specific enough can remove handlers not owned by you.  It's probably</td></tr>
<tr><td class="h"><a name="1430"></a>1430</td><td></td><td></td><td></td><td></td><td class="s">better to use the set_my_handler() method instead.</td></tr>
<tr><td class="h"><a name="1431"></a>1431</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1432"></a>1432</td><td></td><td></td><td></td><td></td><td class="s">The removed handlers are returned.</td></tr>
<tr><td class="h"><a name="1433"></a>1433</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1434"></a>1434</td><td></td><td></td><td></td><td></td><td class="s">=item $ua-&gt;set_my_handler( $phase, $cb, %matchspec )</td></tr>
<tr><td class="h"><a name="1435"></a>1435</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1436"></a>1436</td><td></td><td></td><td></td><td></td><td class="s">Set handlers private to the executing subroutine.  Works by defaulting</td></tr>
<tr><td class="h"><a name="1437"></a>1437</td><td></td><td></td><td></td><td></td><td class="s">an C&lt;owner&gt; field to the %matchhspec that holds the name of the called</td></tr>
<tr><td class="h"><a name="1438"></a>1438</td><td></td><td></td><td></td><td></td><td class="s">subroutine.  You might pass an explicit C&lt;owner&gt; to override this.</td></tr>
<tr><td class="h"><a name="1439"></a>1439</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1440"></a>1440</td><td></td><td></td><td></td><td></td><td class="s">If $cb is passed as C&lt;undef&gt;, remove the handler.</td></tr>
<tr><td class="h"><a name="1441"></a>1441</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1442"></a>1442</td><td></td><td></td><td></td><td></td><td class="s">=item $ua-&gt;get_my_handler( $phase, %matchspec )</td></tr>
<tr><td class="h"><a name="1443"></a>1443</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1444"></a>1444</td><td></td><td></td><td></td><td></td><td class="s">=item $ua-&gt;get_my_handler( $phase, %matchspec, $init )</td></tr>
<tr><td class="h"><a name="1445"></a>1445</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1446"></a>1446</td><td></td><td></td><td></td><td></td><td class="s">Will retrieve the matching handler as hash ref.</td></tr>
<tr><td class="h"><a name="1447"></a>1447</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1448"></a>1448</td><td></td><td></td><td></td><td></td><td class="s">If C&lt;$init&gt; is passed passed as a TRUE value, create and add the</td></tr>
<tr><td class="h"><a name="1449"></a>1449</td><td></td><td></td><td></td><td></td><td class="s">handler if it's not found.  If $init is a subroutine reference, then</td></tr>
<tr><td class="h"><a name="1450"></a>1450</td><td></td><td></td><td></td><td></td><td class="s">it's called with the created handler hash as argument.  This sub might</td></tr>
<tr><td class="h"><a name="1451"></a>1451</td><td></td><td></td><td></td><td></td><td class="s">populate the hash with extra fields; especially the callback.  If</td></tr>
<tr><td class="h"><a name="1452"></a>1452</td><td></td><td></td><td></td><td></td><td class="s">$init is a hash reference, merge the hashes.</td></tr>
<tr><td class="h"><a name="1453"></a>1453</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1454"></a>1454</td><td></td><td></td><td></td><td></td><td class="s">=item $ua-&gt;handlers( $phase, $request )</td></tr>
<tr><td class="h"><a name="1455"></a>1455</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1456"></a>1456</td><td></td><td></td><td></td><td></td><td class="s">=item $ua-&gt;handlers( $phase, $response )</td></tr>
<tr><td class="h"><a name="1457"></a>1457</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1458"></a>1458</td><td></td><td></td><td></td><td></td><td class="s">Returns the handlers that apply to the given request or response at</td></tr>
<tr><td class="h"><a name="1459"></a>1459</td><td></td><td></td><td></td><td></td><td class="s">the given processing phase.</td></tr>
<tr><td class="h"><a name="1460"></a>1460</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1461"></a>1461</td><td></td><td></td><td></td><td></td><td class="s">=back</td></tr>
<tr><td class="h"><a name="1462"></a>1462</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1463"></a>1463</td><td></td><td></td><td></td><td></td><td class="s">=head1 REQUEST METHODS</td></tr>
<tr><td class="h"><a name="1464"></a>1464</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1465"></a>1465</td><td></td><td></td><td></td><td></td><td class="s">The methods described in this section are used to dispatch requests</td></tr>
<tr><td class="h"><a name="1466"></a>1466</td><td></td><td></td><td></td><td></td><td class="s">via the user agent.  The following request methods are provided:</td></tr>
<tr><td class="h"><a name="1467"></a>1467</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1468"></a>1468</td><td></td><td></td><td></td><td></td><td class="s">=over</td></tr>
<tr><td class="h"><a name="1469"></a>1469</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1470"></a>1470</td><td></td><td></td><td></td><td></td><td class="s">=item $ua-&gt;get( $url )</td></tr>
<tr><td class="h"><a name="1471"></a>1471</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1472"></a>1472</td><td></td><td></td><td></td><td></td><td class="s">=item $ua-&gt;get( $url , $field_name =&gt; $value, ... )</td></tr>
<tr><td class="h"><a name="1473"></a>1473</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1474"></a>1474</td><td></td><td></td><td></td><td></td><td class="s">This method will dispatch a C&lt;GET&gt; request on the given $url.  Further</td></tr>
<tr><td class="h"><a name="1475"></a>1475</td><td></td><td></td><td></td><td></td><td class="s">arguments can be given to initialize the headers of the request. These</td></tr>
<tr><td class="h"><a name="1476"></a>1476</td><td></td><td></td><td></td><td></td><td class="s">are given as separate name/value pairs.  The return value is a</td></tr>
<tr><td class="h"><a name="1477"></a>1477</td><td></td><td></td><td></td><td></td><td class="s">response object.  See L&lt;HTTP::Response&gt; for a description of the</td></tr>
<tr><td class="h"><a name="1478"></a>1478</td><td></td><td></td><td></td><td></td><td class="s">interface it provides.</td></tr>
<tr><td class="h"><a name="1479"></a>1479</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1480"></a>1480</td><td></td><td></td><td></td><td></td><td class="s">There will still be a response object returned when LWP can't connect to the</td></tr>
<tr><td class="h"><a name="1481"></a>1481</td><td></td><td></td><td></td><td></td><td class="s">server specified in the URL or when other failures in protocol handlers occur.</td></tr>
<tr><td class="h"><a name="1482"></a>1482</td><td></td><td></td><td></td><td></td><td class="s">These internal responses use the standard HTTP status codes, so the responses</td></tr>
<tr><td class="h"><a name="1483"></a>1483</td><td></td><td></td><td></td><td></td><td class="s">can't be differentiated by testing the response status code alone.  Error</td></tr>
<tr><td class="h"><a name="1484"></a>1484</td><td></td><td></td><td></td><td></td><td class="s">responses that LWP generates internally will have the &quot;Client-Warning&quot; header</td></tr>
<tr><td class="h"><a name="1485"></a>1485</td><td></td><td></td><td></td><td></td><td class="s">set to the value &quot;Internal response&quot;.  If you need to differentiate these</td></tr>
<tr><td class="h"><a name="1486"></a>1486</td><td></td><td></td><td></td><td></td><td class="s">internal responses from responses that a remote server actually generates, you</td></tr>
<tr><td class="h"><a name="1487"></a>1487</td><td></td><td></td><td></td><td></td><td class="s">need to test this header value.</td></tr>
<tr><td class="h"><a name="1488"></a>1488</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1489"></a>1489</td><td></td><td></td><td></td><td></td><td class="s">Fields names that start with &quot;:&quot; are special.  These will not</td></tr>
<tr><td class="h"><a name="1490"></a>1490</td><td></td><td></td><td></td><td></td><td class="s">initialize headers of the request but will determine how the response</td></tr>
<tr><td class="h"><a name="1491"></a>1491</td><td></td><td></td><td></td><td></td><td class="s">content is treated.  The following special field names are recognized:</td></tr>
<tr><td class="h"><a name="1492"></a>1492</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1493"></a>1493</td><td></td><td></td><td></td><td></td><td class="s">    :content_file   =&gt; $filename</td></tr>
<tr><td class="h"><a name="1494"></a>1494</td><td></td><td></td><td></td><td></td><td class="s">    :content_cb     =&gt; \&amp;callback</td></tr>
<tr><td class="h"><a name="1495"></a>1495</td><td></td><td></td><td></td><td></td><td class="s">    :read_size_hint =&gt; $bytes</td></tr>
<tr><td class="h"><a name="1496"></a>1496</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1497"></a>1497</td><td></td><td></td><td></td><td></td><td class="s">If a $filename is provided with the C&lt;:content_file&gt; option, then the</td></tr>
<tr><td class="h"><a name="1498"></a>1498</td><td></td><td></td><td></td><td></td><td class="s">response content will be saved here instead of in the response</td></tr>
<tr><td class="h"><a name="1499"></a>1499</td><td></td><td></td><td></td><td></td><td class="s">object.  If a callback is provided with the C&lt;:content_cb&gt; option then</td></tr>
<tr><td class="h"><a name="1500"></a>1500</td><td></td><td></td><td></td><td></td><td class="s">this function will be called for each chunk of the response content as</td></tr>
<tr><td class="h"><a name="1501"></a>1501</td><td></td><td></td><td></td><td></td><td class="s">it is received from the server.  If neither of these options are</td></tr>
<tr><td class="h"><a name="1502"></a>1502</td><td></td><td></td><td></td><td></td><td class="s">given, then the response content will accumulate in the response</td></tr>
<tr><td class="h"><a name="1503"></a>1503</td><td></td><td></td><td></td><td></td><td class="s">object itself.  This might not be suitable for very large response</td></tr>
<tr><td class="h"><a name="1504"></a>1504</td><td></td><td></td><td></td><td></td><td class="s">bodies.  Only one of C&lt;:content_file&gt; or C&lt;:content_cb&gt; can be</td></tr>
<tr><td class="h"><a name="1505"></a>1505</td><td></td><td></td><td></td><td></td><td class="s">specified.  The content of unsuccessful responses will always</td></tr>
<tr><td class="h"><a name="1506"></a>1506</td><td></td><td></td><td></td><td></td><td class="s">accumulate in the response object itself, regardless of the</td></tr>
<tr><td class="h"><a name="1507"></a>1507</td><td></td><td></td><td></td><td></td><td class="s">C&lt;:content_file&gt; or C&lt;:content_cb&gt; options passed in.</td></tr>
<tr><td class="h"><a name="1508"></a>1508</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1509"></a>1509</td><td></td><td></td><td></td><td></td><td class="s">The C&lt;:read_size_hint&gt; option is passed to the protocol module which</td></tr>
<tr><td class="h"><a name="1510"></a>1510</td><td></td><td></td><td></td><td></td><td class="s">will try to read data from the server in chunks of this size.  A</td></tr>
<tr><td class="h"><a name="1511"></a>1511</td><td></td><td></td><td></td><td></td><td class="s">smaller value for the C&lt;:read_size_hint&gt; will result in a higher</td></tr>
<tr><td class="h"><a name="1512"></a>1512</td><td></td><td></td><td></td><td></td><td class="s">number of callback invocations.</td></tr>
<tr><td class="h"><a name="1513"></a>1513</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1514"></a>1514</td><td></td><td></td><td></td><td></td><td class="s">The callback function is called with 3 arguments: a chunk of data, a</td></tr>
<tr><td class="h"><a name="1515"></a>1515</td><td></td><td></td><td></td><td></td><td class="s">reference to the response object, and a reference to the protocol</td></tr>
<tr><td class="h"><a name="1516"></a>1516</td><td></td><td></td><td></td><td></td><td class="s">object.  The callback can abort the request by invoking die().  The</td></tr>
<tr><td class="h"><a name="1517"></a>1517</td><td></td><td></td><td></td><td></td><td class="s">exception message will show up as the &quot;X-Died&quot; header field in the</td></tr>
<tr><td class="h"><a name="1518"></a>1518</td><td></td><td></td><td></td><td></td><td class="s">response returned by the get() function.</td></tr>
<tr><td class="h"><a name="1519"></a>1519</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1520"></a>1520</td><td></td><td></td><td></td><td></td><td class="s">=item $ua-&gt;head( $url )</td></tr>
<tr><td class="h"><a name="1521"></a>1521</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1522"></a>1522</td><td></td><td></td><td></td><td></td><td class="s">=item $ua-&gt;head( $url , $field_name =&gt; $value, ... )</td></tr>
<tr><td class="h"><a name="1523"></a>1523</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1524"></a>1524</td><td></td><td></td><td></td><td></td><td class="s">This method will dispatch a C&lt;HEAD&gt; request on the given $url.</td></tr>
<tr><td class="h"><a name="1525"></a>1525</td><td></td><td></td><td></td><td></td><td class="s">Otherwise it works like the get() method described above.</td></tr>
<tr><td class="h"><a name="1526"></a>1526</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1527"></a>1527</td><td></td><td></td><td></td><td></td><td class="s">=item $ua-&gt;post( $url, \%form )</td></tr>
<tr><td class="h"><a name="1528"></a>1528</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1529"></a>1529</td><td></td><td></td><td></td><td></td><td class="s">=item $ua-&gt;post( $url, \@form )</td></tr>
<tr><td class="h"><a name="1530"></a>1530</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1531"></a>1531</td><td></td><td></td><td></td><td></td><td class="s">=item $ua-&gt;post( $url, \%form, $field_name =&gt; $value, ... )</td></tr>
<tr><td class="h"><a name="1532"></a>1532</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1533"></a>1533</td><td></td><td></td><td></td><td></td><td class="s">=item $ua-&gt;post( $url, $field_name =&gt; $value,... Content =&gt; \%form )</td></tr>
<tr><td class="h"><a name="1534"></a>1534</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1535"></a>1535</td><td></td><td></td><td></td><td></td><td class="s">=item $ua-&gt;post( $url, $field_name =&gt; $value,... Content =&gt; \@form )</td></tr>
<tr><td class="h"><a name="1536"></a>1536</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1537"></a>1537</td><td></td><td></td><td></td><td></td><td class="s">=item $ua-&gt;post( $url, $field_name =&gt; $value,... Content =&gt; $content )</td></tr>
<tr><td class="h"><a name="1538"></a>1538</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1539"></a>1539</td><td></td><td></td><td></td><td></td><td class="s">This method will dispatch a C&lt;POST&gt; request on the given $url, with</td></tr>
<tr><td class="h"><a name="1540"></a>1540</td><td></td><td></td><td></td><td></td><td class="s">%form or @form providing the key/value pairs for the fill-in form</td></tr>
<tr><td class="h"><a name="1541"></a>1541</td><td></td><td></td><td></td><td></td><td class="s">content. Additional headers and content options are the same as for</td></tr>
<tr><td class="h"><a name="1542"></a>1542</td><td></td><td></td><td></td><td></td><td class="s">the get() method.</td></tr>
<tr><td class="h"><a name="1543"></a>1543</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1544"></a>1544</td><td></td><td></td><td></td><td></td><td class="s">This method will use the POST() function from C&lt;HTTP::Request::Common&gt;</td></tr>
<tr><td class="h"><a name="1545"></a>1545</td><td></td><td></td><td></td><td></td><td class="s">to build the request.  See L&lt;HTTP::Request::Common&gt; for a details on</td></tr>
<tr><td class="h"><a name="1546"></a>1546</td><td></td><td></td><td></td><td></td><td class="s">how to pass form content and other advanced features.</td></tr>
<tr><td class="h"><a name="1547"></a>1547</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1548"></a>1548</td><td></td><td></td><td></td><td></td><td class="s">=item $ua-&gt;mirror( $url, $filename )</td></tr>
<tr><td class="h"><a name="1549"></a>1549</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1550"></a>1550</td><td></td><td></td><td></td><td></td><td class="s">This method will get the document identified by $url and store it in</td></tr>
<tr><td class="h"><a name="1551"></a>1551</td><td></td><td></td><td></td><td></td><td class="s">file called $filename.  If the file already exists, then the request</td></tr>
<tr><td class="h"><a name="1552"></a>1552</td><td></td><td></td><td></td><td></td><td class="s">will contain an &quot;If-Modified-Since&quot; header matching the modification</td></tr>
<tr><td class="h"><a name="1553"></a>1553</td><td></td><td></td><td></td><td></td><td class="s">time of the file.  If the document on the server has not changed since</td></tr>
<tr><td class="h"><a name="1554"></a>1554</td><td></td><td></td><td></td><td></td><td class="s">this time, then nothing happens.  If the document has been updated, it</td></tr>
<tr><td class="h"><a name="1555"></a>1555</td><td></td><td></td><td></td><td></td><td class="s">will be downloaded again.  The modification time of the file will be</td></tr>
<tr><td class="h"><a name="1556"></a>1556</td><td></td><td></td><td></td><td></td><td class="s">forced to match that of the server.</td></tr>
<tr><td class="h"><a name="1557"></a>1557</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1558"></a>1558</td><td></td><td></td><td></td><td></td><td class="s">The return value is the the response object.</td></tr>
<tr><td class="h"><a name="1559"></a>1559</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1560"></a>1560</td><td></td><td></td><td></td><td></td><td class="s">=item $ua-&gt;request( $request )</td></tr>
<tr><td class="h"><a name="1561"></a>1561</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1562"></a>1562</td><td></td><td></td><td></td><td></td><td class="s">=item $ua-&gt;request( $request, $content_file )</td></tr>
<tr><td class="h"><a name="1563"></a>1563</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1564"></a>1564</td><td></td><td></td><td></td><td></td><td class="s">=item $ua-&gt;request( $request, $content_cb )</td></tr>
<tr><td class="h"><a name="1565"></a>1565</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1566"></a>1566</td><td></td><td></td><td></td><td></td><td class="s">=item $ua-&gt;request( $request, $content_cb, $read_size_hint )</td></tr>
<tr><td class="h"><a name="1567"></a>1567</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1568"></a>1568</td><td></td><td></td><td></td><td></td><td class="s">This method will dispatch the given $request object.  Normally this</td></tr>
<tr><td class="h"><a name="1569"></a>1569</td><td></td><td></td><td></td><td></td><td class="s">will be an instance of the C&lt;HTTP::Request&gt; class, but any object with</td></tr>
<tr><td class="h"><a name="1570"></a>1570</td><td></td><td></td><td></td><td></td><td class="s">a similar interface will do.  The return value is a response object.</td></tr>
<tr><td class="h"><a name="1571"></a>1571</td><td></td><td></td><td></td><td></td><td class="s">See L&lt;HTTP::Request&gt; and L&lt;HTTP::Response&gt; for a description of the</td></tr>
<tr><td class="h"><a name="1572"></a>1572</td><td></td><td></td><td></td><td></td><td class="s">interface provided by these classes.</td></tr>
<tr><td class="h"><a name="1573"></a>1573</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1574"></a>1574</td><td></td><td></td><td></td><td></td><td class="s">The request() method will process redirects and authentication</td></tr>
<tr><td class="h"><a name="1575"></a>1575</td><td></td><td></td><td></td><td></td><td class="s">responses transparently.  This means that it may actually send several</td></tr>
<tr><td class="h"><a name="1576"></a>1576</td><td></td><td></td><td></td><td></td><td class="s">simple requests via the simple_request() method described below.</td></tr>
<tr><td class="h"><a name="1577"></a>1577</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1578"></a>1578</td><td></td><td></td><td></td><td></td><td class="s">The request methods described above; get(), head(), post() and</td></tr>
<tr><td class="h"><a name="1579"></a>1579</td><td></td><td></td><td></td><td></td><td class="s">mirror(), will all dispatch the request they build via this method.</td></tr>
<tr><td class="h"><a name="1580"></a>1580</td><td></td><td></td><td></td><td></td><td class="s">They are convenience methods that simply hides the creation of the</td></tr>
<tr><td class="h"><a name="1581"></a>1581</td><td></td><td></td><td></td><td></td><td class="s">request object for you.</td></tr>
<tr><td class="h"><a name="1582"></a>1582</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1583"></a>1583</td><td></td><td></td><td></td><td></td><td class="s">The $content_file, $content_cb and $read_size_hint all correspond to</td></tr>
<tr><td class="h"><a name="1584"></a>1584</td><td></td><td></td><td></td><td></td><td class="s">options described with the get() method above.</td></tr>
<tr><td class="h"><a name="1585"></a>1585</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1586"></a>1586</td><td></td><td></td><td></td><td></td><td class="s">You are allowed to use a CODE reference as C&lt;content&gt; in the request</td></tr>
<tr><td class="h"><a name="1587"></a>1587</td><td></td><td></td><td></td><td></td><td class="s">object passed in.  The C&lt;content&gt; function should return the content</td></tr>
<tr><td class="h"><a name="1588"></a>1588</td><td></td><td></td><td></td><td></td><td class="s">when called.  The content can be returned in chunks.  The content</td></tr>
<tr><td class="h"><a name="1589"></a>1589</td><td></td><td></td><td></td><td></td><td class="s">function will be invoked repeatedly until it return an empty string to</td></tr>
<tr><td class="h"><a name="1590"></a>1590</td><td></td><td></td><td></td><td></td><td class="s">signal that there is no more content.</td></tr>
<tr><td class="h"><a name="1591"></a>1591</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1592"></a>1592</td><td></td><td></td><td></td><td></td><td class="s">=item $ua-&gt;simple_request( $request )</td></tr>
<tr><td class="h"><a name="1593"></a>1593</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1594"></a>1594</td><td></td><td></td><td></td><td></td><td class="s">=item $ua-&gt;simple_request( $request, $content_file )</td></tr>
<tr><td class="h"><a name="1595"></a>1595</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1596"></a>1596</td><td></td><td></td><td></td><td></td><td class="s">=item $ua-&gt;simple_request( $request, $content_cb )</td></tr>
<tr><td class="h"><a name="1597"></a>1597</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1598"></a>1598</td><td></td><td></td><td></td><td></td><td class="s">=item $ua-&gt;simple_request( $request, $content_cb, $read_size_hint )</td></tr>
<tr><td class="h"><a name="1599"></a>1599</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1600"></a>1600</td><td></td><td></td><td></td><td></td><td class="s">This method dispatches a single request and returns the response</td></tr>
<tr><td class="h"><a name="1601"></a>1601</td><td></td><td></td><td></td><td></td><td class="s">received.  Arguments are the same as for request() described above.</td></tr>
<tr><td class="h"><a name="1602"></a>1602</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1603"></a>1603</td><td></td><td></td><td></td><td></td><td class="s">The difference from request() is that simple_request() will not try to</td></tr>
<tr><td class="h"><a name="1604"></a>1604</td><td></td><td></td><td></td><td></td><td class="s">handle redirects or authentication responses.  The request() method</td></tr>
<tr><td class="h"><a name="1605"></a>1605</td><td></td><td></td><td></td><td></td><td class="s">will in fact invoke this method for each simple request it sends.</td></tr>
<tr><td class="h"><a name="1606"></a>1606</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1607"></a>1607</td><td></td><td></td><td></td><td></td><td class="s">=item $ua-&gt;is_protocol_supported( $scheme )</td></tr>
<tr><td class="h"><a name="1608"></a>1608</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1609"></a>1609</td><td></td><td></td><td></td><td></td><td class="s">You can use this method to test whether this user agent object supports the</td></tr>
<tr><td class="h"><a name="1610"></a>1610</td><td></td><td></td><td></td><td></td><td class="s">specified C&lt;scheme&gt;.  (The C&lt;scheme&gt; might be a string (like 'http' or</td></tr>
<tr><td class="h"><a name="1611"></a>1611</td><td></td><td></td><td></td><td></td><td class="s">'ftp') or it might be an URI object reference.)</td></tr>
<tr><td class="h"><a name="1612"></a>1612</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1613"></a>1613</td><td></td><td></td><td></td><td></td><td class="s">Whether a scheme is supported, is determined by the user agent's</td></tr>
<tr><td class="h"><a name="1614"></a>1614</td><td></td><td></td><td></td><td></td><td class="s">C&lt;protocols_allowed&gt; or C&lt;protocols_forbidden&gt; lists (if any), and by</td></tr>
<tr><td class="h"><a name="1615"></a>1615</td><td></td><td></td><td></td><td></td><td class="s">the capabilities of LWP.  I.e., this will return TRUE only if LWP</td></tr>
<tr><td class="h"><a name="1616"></a>1616</td><td></td><td></td><td></td><td></td><td class="s">supports this protocol I&lt;and&gt; it's permitted for this particular</td></tr>
<tr><td class="h"><a name="1617"></a>1617</td><td></td><td></td><td></td><td></td><td class="s">object.</td></tr>
<tr><td class="h"><a name="1618"></a>1618</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1619"></a>1619</td><td></td><td></td><td></td><td></td><td class="s">=back</td></tr>
<tr><td class="h"><a name="1620"></a>1620</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1621"></a>1621</td><td></td><td></td><td></td><td></td><td class="s">=head2 Callback methods</td></tr>
<tr><td class="h"><a name="1622"></a>1622</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1623"></a>1623</td><td></td><td></td><td></td><td></td><td class="s">The following methods will be invoked as requests are processed. These</td></tr>
<tr><td class="h"><a name="1624"></a>1624</td><td></td><td></td><td></td><td></td><td class="s">methods are documented here because subclasses of C&lt;LWP::UserAgent&gt;</td></tr>
<tr><td class="h"><a name="1625"></a>1625</td><td></td><td></td><td></td><td></td><td class="s">might want to override their behaviour.</td></tr>
<tr><td class="h"><a name="1626"></a>1626</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1627"></a>1627</td><td></td><td></td><td></td><td></td><td class="s">=over</td></tr>
<tr><td class="h"><a name="1628"></a>1628</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1629"></a>1629</td><td></td><td></td><td></td><td></td><td class="s">=item $ua-&gt;prepare_request( $request )</td></tr>
<tr><td class="h"><a name="1630"></a>1630</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1631"></a>1631</td><td></td><td></td><td></td><td></td><td class="s">This method is invoked by simple_request().  Its task is to modify the</td></tr>
<tr><td class="h"><a name="1632"></a>1632</td><td></td><td></td><td></td><td></td><td class="s">given $request object by setting up various headers based on the</td></tr>
<tr><td class="h"><a name="1633"></a>1633</td><td></td><td></td><td></td><td></td><td class="s">attributes of the user agent. The return value should normally be the</td></tr>
<tr><td class="h"><a name="1634"></a>1634</td><td></td><td></td><td></td><td></td><td class="s">$request object passed in.  If a different request object is returned</td></tr>
<tr><td class="h"><a name="1635"></a>1635</td><td></td><td></td><td></td><td></td><td class="s">it will be the one actually processed.</td></tr>
<tr><td class="h"><a name="1636"></a>1636</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1637"></a>1637</td><td></td><td></td><td></td><td></td><td class="s">The headers affected by the base implementation are; &quot;User-Agent&quot;,</td></tr>
<tr><td class="h"><a name="1638"></a>1638</td><td></td><td></td><td></td><td></td><td class="s">&quot;From&quot;, &quot;Range&quot; and &quot;Cookie&quot;.</td></tr>
<tr><td class="h"><a name="1639"></a>1639</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1640"></a>1640</td><td></td><td></td><td></td><td></td><td class="s">=item $ua-&gt;redirect_ok( $prospective_request, $response )</td></tr>
<tr><td class="h"><a name="1641"></a>1641</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1642"></a>1642</td><td></td><td></td><td></td><td></td><td class="s">This method is called by request() before it tries to follow a</td></tr>
<tr><td class="h"><a name="1643"></a>1643</td><td></td><td></td><td></td><td></td><td class="s">redirection to the request in $response.  This should return a TRUE</td></tr>
<tr><td class="h"><a name="1644"></a>1644</td><td></td><td></td><td></td><td></td><td class="s">value if this redirection is permissible.  The $prospective_request</td></tr>
<tr><td class="h"><a name="1645"></a>1645</td><td></td><td></td><td></td><td></td><td class="s">will be the request to be sent if this method returns TRUE.</td></tr>
<tr><td class="h"><a name="1646"></a>1646</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1647"></a>1647</td><td></td><td></td><td></td><td></td><td class="s">The base implementation will return FALSE unless the method</td></tr>
<tr><td class="h"><a name="1648"></a>1648</td><td></td><td></td><td></td><td></td><td class="s">is in the object's C&lt;requests_redirectable&gt; list,</td></tr>
<tr><td class="h"><a name="1649"></a>1649</td><td></td><td></td><td></td><td></td><td class="s">FALSE if the proposed redirection is to a &quot;file://...&quot;</td></tr>
<tr><td class="h"><a name="1650"></a>1650</td><td></td><td></td><td></td><td></td><td class="s">URL, and TRUE otherwise.</td></tr>
<tr><td class="h"><a name="1651"></a>1651</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1652"></a>1652</td><td></td><td></td><td></td><td></td><td class="s">=item $ua-&gt;get_basic_credentials( $realm, $uri, $isproxy )</td></tr>
<tr><td class="h"><a name="1653"></a>1653</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1654"></a>1654</td><td></td><td></td><td></td><td></td><td class="s">This is called by request() to retrieve credentials for documents</td></tr>
<tr><td class="h"><a name="1655"></a>1655</td><td></td><td></td><td></td><td></td><td class="s">protected by Basic or Digest Authentication.  The arguments passed in</td></tr>
<tr><td class="h"><a name="1656"></a>1656</td><td></td><td></td><td></td><td></td><td class="s">is the $realm provided by the server, the $uri requested and a boolean</td></tr>
<tr><td class="h"><a name="1657"></a>1657</td><td></td><td></td><td></td><td></td><td class="s">flag to indicate if this is authentication against a proxy server.</td></tr>
<tr><td class="h"><a name="1658"></a>1658</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1659"></a>1659</td><td></td><td></td><td></td><td></td><td class="s">The method should return a username and password.  It should return an</td></tr>
<tr><td class="h"><a name="1660"></a>1660</td><td></td><td></td><td></td><td></td><td class="s">empty list to abort the authentication resolution attempt.  Subclasses</td></tr>
<tr><td class="h"><a name="1661"></a>1661</td><td></td><td></td><td></td><td></td><td class="s">can override this method to prompt the user for the information. An</td></tr>
<tr><td class="h"><a name="1662"></a>1662</td><td></td><td></td><td></td><td></td><td class="s">example of this can be found in C&lt;lwp-request&gt; program distributed</td></tr>
<tr><td class="h"><a name="1663"></a>1663</td><td></td><td></td><td></td><td></td><td class="s">with this library.</td></tr>
<tr><td class="h"><a name="1664"></a>1664</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1665"></a>1665</td><td></td><td></td><td></td><td></td><td class="s">The base implementation simply checks a set of pre-stored member</td></tr>
<tr><td class="h"><a name="1666"></a>1666</td><td></td><td></td><td></td><td></td><td class="s">variables, set up with the credentials() method.</td></tr>
<tr><td class="h"><a name="1667"></a>1667</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1668"></a>1668</td><td></td><td></td><td></td><td></td><td class="s">=item $ua-&gt;progress( $status, $request_or_response )</td></tr>
<tr><td class="h"><a name="1669"></a>1669</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1670"></a>1670</td><td></td><td></td><td></td><td></td><td class="s">This is called frequently as the response is received regardless of</td></tr>
<tr><td class="h"><a name="1671"></a>1671</td><td></td><td></td><td></td><td></td><td class="s">how the content is processed.  The method is called with $status</td></tr>
<tr><td class="h"><a name="1672"></a>1672</td><td></td><td></td><td></td><td></td><td class="s">&quot;begin&quot; at the start of processing the request and with $state &quot;end&quot;</td></tr>
<tr><td class="h"><a name="1673"></a>1673</td><td></td><td></td><td></td><td></td><td class="s">before the request method returns.  In between these $status will be</td></tr>
<tr><td class="h"><a name="1674"></a>1674</td><td></td><td></td><td></td><td></td><td class="s">the fraction of the response currently received or the string &quot;tick&quot;</td></tr>
<tr><td class="h"><a name="1675"></a>1675</td><td></td><td></td><td></td><td></td><td class="s">if the fraction can't be calculated.</td></tr>
<tr><td class="h"><a name="1676"></a>1676</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1677"></a>1677</td><td></td><td></td><td></td><td></td><td class="s">When $status is &quot;begin&quot; the second argument is the request object,</td></tr>
<tr><td class="h"><a name="1678"></a>1678</td><td></td><td></td><td></td><td></td><td class="s">otherwise it is the response object.</td></tr>
<tr><td class="h"><a name="1679"></a>1679</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1680"></a>1680</td><td></td><td></td><td></td><td></td><td class="s">=back</td></tr>
<tr><td class="h"><a name="1681"></a>1681</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1682"></a>1682</td><td></td><td></td><td></td><td></td><td class="s">=head1 SEE ALSO</td></tr>
<tr><td class="h"><a name="1683"></a>1683</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1684"></a>1684</td><td></td><td></td><td></td><td></td><td class="s">See L&lt;LWP&gt; for a complete overview of libwww-perl5.  See L&lt;lwpcook&gt;</td></tr>
<tr><td class="h"><a name="1685"></a>1685</td><td></td><td></td><td></td><td></td><td class="s">and the scripts F&lt;lwp-request&gt; and F&lt;lwp-download&gt; for examples of</td></tr>
<tr><td class="h"><a name="1686"></a>1686</td><td></td><td></td><td></td><td></td><td class="s">usage.</td></tr>
<tr><td class="h"><a name="1687"></a>1687</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1688"></a>1688</td><td></td><td></td><td></td><td></td><td class="s">See L&lt;HTTP::Request&gt; and L&lt;HTTP::Response&gt; for a description of the</td></tr>
<tr><td class="h"><a name="1689"></a>1689</td><td></td><td></td><td></td><td></td><td class="s">message objects dispatched and received.  See L&lt;HTTP::Request::Common&gt;</td></tr>
<tr><td class="h"><a name="1690"></a>1690</td><td></td><td></td><td></td><td></td><td class="s">and L&lt;HTML::Form&gt; for other ways to build request objects.</td></tr>
<tr><td class="h"><a name="1691"></a>1691</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1692"></a>1692</td><td></td><td></td><td></td><td></td><td class="s">See L&lt;WWW::Mechanize&gt; and L&lt;WWW::Search&gt; for examples of more</td></tr>
<tr><td class="h"><a name="1693"></a>1693</td><td></td><td></td><td></td><td></td><td class="s">specialized user agents based on C&lt;LWP::UserAgent&gt;.</td></tr>
<tr><td class="h"><a name="1694"></a>1694</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1695"></a>1695</td><td></td><td></td><td></td><td></td><td class="s">=head1 COPYRIGHT</td></tr>
<tr><td class="h"><a name="1696"></a>1696</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1697"></a>1697</td><td></td><td></td><td></td><td></td><td class="s">Copyright 1995-2009 Gisle Aas.</td></tr>
<tr><td class="h"><a name="1698"></a>1698</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1699"></a>1699</td><td></td><td></td><td></td><td></td><td class="s">This library is free software; you can redistribute it and/or</td></tr>
<tr><td class="h"><a name="1700"></a>1700</td><td></td><td></td><td></td><td></td><td class="s">modify it under the same terms as Perl itself.</td></tr>
<tr><td class="h"><a name="LWP__UserAgent__CORE_match"></a></td><td></td><td></td><td></td><td></td><td class="s"><div class="calls"><div class="calls_in"># spent 900ns within LWP::UserAgent::CORE:match which was called
#    once (900ns+0s) by LWP::UserAgent::agent at <a href="LWP-UserAgent-pm-block.html#664">line 664 of LWP/UserAgent.pm</a></div></div>sub LWP::UserAgent::CORE:match; # xsub<br />        </td></tr>
</tbody></table></div>
        
            <script type="text/javascript"> $(document).ready(function() { 

        $("#subs_table").tablesorter({
            sortList: [[3,1]],
            headers: {
                3: { sorter: 'fmt_time' },
                4: { sorter: 'fmt_time' }
            }
        });
    
 } ); </script>
        
        <div class="footer">Report produced by the
        <a href="http://search.cpan.org/dist/Devel-NYTProf/">NYTProf 3.11</a>
        Perl profiler, developed by
        <a href="http://www.linkedin.com/in/timbunce">Tim Bunce</a> and
        <a href="http://code.nytimes.com">Adam Kaplan</a>.
        </div>
        <br /><br /><br /><br /><br /><br /><br /><br /><br /><br />
    </body></html>